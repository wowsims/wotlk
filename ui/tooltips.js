if(window.WH=new function(){this.REMOTE=!("."+location.hostname).endsWith(".wowhead.com")&&"wh-site"!==location.hostname||"/widgets/power/demo.html"===location.pathname,this.STATIC_URL="https://wow.zamimg.com",this.staticUrl=this.STATIC_URL,this.PageMeta={};const e={resizeEventObserver:void 0};this.defineEnum=function(e,t){let a={},n=[];return Object.keys(e).forEach((i=>{a[i]=t?new t(a):{},a[i].name=i,a[i].value=e[i],Object.freeze(a[i]),n.push(a[i])})),a.cases=()=>n.slice(),a.tryFrom=e=>n.find((t=>t.value===e)),a.from=e=>{let t=a.tryFrom(e);if(!t)throw new Error(`Value ${e} is not a valid backing value for this enum.`);return t},a.values=()=>n.map((e=>e.value)),Object.freeze(a)},this.extendStatic=function(e,t){return new(WH.setPrototype(e,t))},this.findKey=function(e,t,a){let n=Object.keys(e).find((a=>e[a]===t));return a&&null!=n&&(n=parseInt(n)),n},this.onLoad=function(e){"loading"===document.readyState?document.addEventListener("DOMContentLoaded",e):requestAnimationFrame(e)},this.setPrototype=function(e,t){return t.prototype=e,t},this.triggerResizeEvents=function(t){t instanceof Element&&window.ResizeObserver&&(e.resizeEventObserver=e.resizeEventObserver||new ResizeObserver((e=>e.forEach((e=>requestAnimationFrame((()=>e.target.dispatchEvent(new CustomEvent("resize",{detail:e})))))))),e.resizeEventObserver.observe(t))}},WH.dataEnv={MAIN:1,PTR:2,BETA:3,CLASSIC:4,TBC:5,D2:6,DI:7,WRATH:8,D4:9,PTR2:10,CATA:11,D4PTR:12},WH.dataEnvKey={1:"live",2:"ptr",3:"beta",4:"classic",5:"tbc",6:"d2",7:"di",8:"wrath",9:"d4",10:"ptr2",11:"cata",12:"d4ptr"},WH.dataEnvTerm={1:"live",2:"ptr",3:"beta",4:"classic",5:"burningCrusade",6:"diablo2",7:"diabloImmortal",8:"wrathofthelichking",9:"diablo4",10:"ptr2",11:"cataclysm",12:"diablo4ptr"},WH.dataTree={RETAIL:1,CLASSIC:4,TBC:5,D2:6,DI:7,WRATH:8,D4:9,CATA:11},WH.dataTreeShortTerm={[WH.dataTree.RETAIL]:"retail",[WH.dataTree.CLASSIC]:"classic",[WH.dataTree.TBC]:"theburningcrusade_short",[WH.dataTree.D2]:"diablo2",[WH.dataTree.DI]:"diabloImmortal_short",[WH.dataTree.WRATH]:"wrathofthelichking_short",[WH.dataTree.D4]:"diablo4",[WH.dataTree.CATA]:"cataclysm_short"},WH.dataTreeTerm={1:"retail",4:"classic",5:"burningCrusade",6:"diablo2",7:"diabloImmortal",8:"wrathofthelichking",9:"diablo4",11:"cataclysm"},WH.dataEnvToTree={},WH.dataEnvToTree[WH.dataEnv.MAIN]=WH.dataTree.RETAIL,WH.dataEnvToTree[WH.dataEnv.PTR]=WH.dataTree.RETAIL,WH.dataEnvToTree[WH.dataEnv.PTR2]=WH.dataTree.RETAIL,WH.dataEnvToTree[WH.dataEnv.BETA]=WH.dataTree.RETAIL,WH.dataEnvToTree[WH.dataEnv.CLASSIC]=WH.dataTree.CLASSIC,WH.dataEnvToTree[WH.dataEnv.TBC]=WH.dataTree.TBC,WH.dataEnvToTree[WH.dataEnv.D2]=WH.dataTree.D2,WH.dataEnvToTree[WH.dataEnv.DI]=WH.dataTree.DI,WH.dataEnvToTree[WH.dataEnv.WRATH]=WH.dataTree.WRATH,WH.dataEnvToTree[WH.dataEnv.D4]=WH.dataTree.D4,WH.dataEnvToTree[WH.dataEnv.CATA]=WH.dataTree.CATA,WH.dataEnvToTree[WH.dataEnv.D4PTR]=WH.dataTree.D4,WH.dataTreeToRoot={},WH.dataTreeToRoot[WH.dataTree.RETAIL]=WH.dataEnv.MAIN,WH.dataTreeToRoot[WH.dataTree.CLASSIC]=WH.dataEnv.CLASSIC,WH.dataTreeToRoot[WH.dataTree.TBC]=WH.dataEnv.TBC,WH.dataTreeToRoot[WH.dataTree.D2]=WH.dataEnv.D2,WH.dataTreeToRoot[WH.dataTree.DI]=WH.dataEnv.DI,WH.dataTreeToRoot[WH.dataTree.WRATH]=WH.dataEnv.WRATH,WH.dataTreeToRoot[WH.dataTree.D4]=WH.dataEnv.D4,WH.dataTreeToRoot[WH.dataTree.CATA]=WH.dataEnv.CATA,WH.EFFECT_SCALING_CLASS_1=-1,WH.EFFECT_SCALING_CLASS_2=-2,WH.EFFECT_SCALING_CLASS_3=-3,WH.EFFECT_SCALING_CLASS_4=-4,WH.EFFECT_SCALING_CLASS_5=-5,WH.EFFECT_SCALING_CLASS_6=-6,WH.EFFECT_SCALING_CLASS_7=-7,WH.EFFECT_SCALING_CLASS_8=-8,WH.EFFECT_SCALING_CLASS_9=-9,WH.EFFECT_SCALING_CLASS_ITEM=15,WH.EFFECT_SCALING_CLASS_CATA_ITEM=12,WH.EFFECT_SCALING_CLASS_DAMAGEREPLACESTAT=21,WH.EFFECT_AURA_DUMMY=4,WH.EFFECT_AURA_PROC_TRIGGER_SPELL=42,WH.Timewalking=new function(){const e=this;this.MODE_TBC=1,this.MODE_WOTLK=2,this.MODE_CATA=3,this.MODE_MISTS=4,this.MODE_WOD=5,this.MODE_LEGION=6;const t=[{id:e.MODE_TBC,charLevel:30,gearIlvl:75,stringId:"twtbc"},{id:e.MODE_WOTLK,charLevel:30,gearIlvl:75,stringId:"twwotlk"},{id:e.MODE_CATA,charLevel:35,gearIlvl:90,stringId:"twcata"},{id:e.MODE_MISTS,charLevel:35,gearIlvl:90,stringId:"twmists"},{id:e.MODE_WOD,charLevel:40,gearIlvl:105,stringId:"twwod"},{id:e.MODE_LEGION,charLevel:45,gearIlvl:120,stringId:"twlegion"}];this.getConfigs=function(){return t},this.getCharLevelFromIlvl=function(t){for(let a of e.getConfigs())if(a.gearIlvl===t)return a.charLevel;return null},this.getGearIlvlByStringId=function(t){for(let a of e.getConfigs())if(a.stringId===t)return a.gearIlvl;return null}},WH.Types=new function(){const e=this;this.NPC=1,this.OBJECT=2,this.ITEM=3,this.ITEM_SET=4,this.QUEST=5,this.SPELL=6,this.ZONE=7,this.FACTION=8,this.HUNTER_PET=9,this.ACHIEVEMENT=10,this.TITLE=11,this.EVENT=12,this.PLAYER_CLASS=13,this.RACE=14,this.SKILL=15,this.CURRENCY=17,this.PROJECT=18,this.SOUND=19,this.BUILDING=20,this.FOLLOWER=21,this.MISSION_ABILITY=22,this.MISSION=23,this.SHIP=25,this.THREAT=26,this.RESOURCE=27,this.CHAMPION=28,this.ICON=29,this.ORDER_ADVANCEMENT=30,this.FOLLOWER_ALLIANCE=31,this.FOLLOWER_HORDE=32,this.SHIP_ALLIANCE=33,this.SHIP_HORDE=34,this.CHAMPION_ALLIANCE=35,this.CHAMPION_HORDE=36,this.TRANSMOG_ITEM=37,this.BFA_CHAMPION=38,this.BFA_CHAMPION_ALLIANCE=39,this.AFFIX=40,this.BFA_CHAMPION_HORDE=41,this.AZERITE_ESSENCE_POWER=42,this.AZERITE_ESSENCE=43,this.STORYLINE=44,this.ADVENTURE_COMBATANT_ABILITY=46,this.ENCOUNTER=47,this.COVENANT=48,this.SOULBIND=49,this.DI_EQUIP_ITEM=50,this.DI_SKILL=54,this.DI_PARAGON_SKILL=55,this.DI_SET=56,this.DI_NPC=57,this.DI_MISC_ITEM=58,this.DI_ZONE=59,this.DI_QUEST=60,this.DI_OBJECT=61,this.PROFESSION_TRAIT=65,this.TRADING_POST_ACTIVITY=67,this.D4_PLAYER_CLASS=63,this.D4_SKILL=64,this.D4_ITEM=66,this.D4_AFFIX=68,this.D4_PARAGON_NODE=69,this.D4_ASPECT=70,this.D4_PARAGON_GLYPH=71,this.D4_VAMPIRIC_POWER=74,this.D4_SENESCHAL_STONE=78,this.GATHERER_SCREENSHOT=91,this.GATHERER_GUIDE_IMAGE=98,this.GUIDE=100,this.TRANSMOG_SET=101,this.OUTFIT=110,this.GEAR_SET=111,this.D4_BUILD=112,this.GATHERER_LISTVIEW=158,this.GATHERER_SURVEY_COVENANTS=161,this.NEWS_POST=162,this.GATHERER_HERO_TALENTS=165,this.COUNTDOWN_TIMER=166,this.BATTLE_PET_ABILITY=200;const t={[this.BATTLE_PET_ABILITY]:["pet-ability","petability"],[this.BFA_CHAMPION_ALLIANCE]:["bfa-champion"],[this.BFA_CHAMPION_HORDE]:["bfa-champion"],[this.CHAMPION_ALLIANCE]:["champion"],[this.CHAMPION_HORDE]:["champion"],[this.D4_AFFIX]:["affix"],[this.D4_ASPECT]:["aspect"],[this.D4_BUILD]:["build"],[this.D4_ITEM]:["item"],[this.D4_PARAGON_GLYPH]:["paragon-glyph"],[this.D4_PARAGON_NODE]:["paragon-node"],[this.D4_SENESCHAL_STONE]:["seneschal-stone"],[this.D4_SKILL]:["skill"],[this.D4_VAMPIRIC_POWER]:["vampiric-power"],[this.DI_EQUIP_ITEM]:["equip-item"],[this.DI_MISC_ITEM]:["misc-item"],[this.DI_NPC]:["npc"],[this.DI_OBJECT]:["object"],[this.DI_PARAGON_SKILL]:["paragon-skill"],[this.DI_QUEST]:["quest"],[this.DI_SET]:["set"],[this.DI_SKILL]:["skill"],[this.DI_ZONE]:["zone"],[this.FOLLOWER_ALLIANCE]:["follower"],[this.FOLLOWER_HORDE]:["follower"],[this.ITEM_SET]:["item-set","itemset"],[this.MISSION_ABILITY]:["mission-ability","missionability","garrisonability"],[this.SHIP_ALLIANCE]:["ship"],[this.SHIP_HORDE]:["ship"]},a=[this.NPC,this.OBJECT,this.ITEM,this.ITEM_SET,this.QUEST,this.SPELL,this.ZONE,this.FACTION,this.HUNTER_PET,this.ACHIEVEMENT,this.TITLE,this.EVENT,this.PLAYER_CLASS,this.RACE,this.SKILL,this.CURRENCY,this.SOUND,this.BUILDING,this.FOLLOWER,this.MISSION_ABILITY,this.MISSION,this.SHIP,this.THREAT,this.RESOURCE,this.CHAMPION,this.ICON,this.ORDER_ADVANCEMENT,this.BFA_CHAMPION,this.AFFIX,this.AZERITE_ESSENCE_POWER,this.AZERITE_ESSENCE,this.STORYLINE,this.ADVENTURE_COMBATANT_ABILITY,this.PROFESSION_TRAIT,this.BATTLE_PET_ABILITY,this.TRADING_POST_ACTIVITY],n={[this.ACHIEVEMENT]:"achievement",[this.ADVENTURE_COMBATANT_ABILITY]:"adventure-combatant-ability",[this.AFFIX]:"affix",[this.AZERITE_ESSENCE]:"azerite-essence",[this.AZERITE_ESSENCE_POWER]:"azerite-essence-power",[this.BATTLE_PET_ABILITY]:"pet-ability",[this.BFA_CHAMPION]:"bfa-champion",[this.BFA_CHAMPION_ALLIANCE]:"bfa-champion_a",[this.BFA_CHAMPION_HORDE]:"bfa-champion_h",[this.BUILDING]:"building",[this.CHAMPION]:"champion",[this.CHAMPION_ALLIANCE]:"champion_a",[this.CHAMPION_HORDE]:"champion_h",[this.COUNTDOWN_TIMER]:"countdown-timer",[this.COVENANT]:"covenant",[this.CURRENCY]:"currency",[this.D4_AFFIX]:"d4-affix",[this.D4_ASPECT]:"d4-aspect",[this.D4_BUILD]:"d4-build",[this.D4_ITEM]:"d4-item",[this.D4_PARAGON_GLYPH]:"d4-paragon-glyph",[this.D4_PARAGON_NODE]:"d4-paragon-node",[this.D4_SENESCHAL_STONE]:"d4-seneschal-stone",[this.D4_SKILL]:"d4-skill",[this.D4_VAMPIRIC_POWER]:"d4-vampiric-power",[this.DI_EQUIP_ITEM]:"di-equip-item",[this.DI_MISC_ITEM]:"di-misc-item",[this.DI_NPC]:"di-npc",[this.DI_OBJECT]:"di-object",[this.DI_PARAGON_SKILL]:"di-paragon-skill",[this.DI_QUEST]:"di-quest",[this.DI_SET]:"di-set",[this.DI_SKILL]:"di-skill",[this.DI_ZONE]:"di-zone",[this.ENCOUNTER]:"encounter",[this.EVENT]:"event",[this.FACTION]:"faction",[this.FOLLOWER]:"follower",[this.FOLLOWER_ALLIANCE]:"follower_a",[this.FOLLOWER_HORDE]:"follower_h",[this.GEAR_SET]:"gear-set",[this.GUIDE]:"guide",[this.HUNTER_PET]:"pet",[this.ICON]:"icon",[this.ITEM]:"item",[this.ITEM_SET]:"item-set",[this.MISSION]:"mission",[this.MISSION_ABILITY]:"mission-ability",[this.NEWS_POST]:"news",[this.NPC]:"npc",[this.OBJECT]:"object",[this.ORDER_ADVANCEMENT]:"order-advancement",[this.OUTFIT]:"outfit",[this.PLAYER_CLASS]:"class",[this.PROFESSION_TRAIT]:"profession-trait",[this.QUEST]:"quest",[this.RACE]:"race",[this.RESOURCE]:"resource",[this.SHIP]:"ship",[this.SHIP_ALLIANCE]:"ship_a",[this.SHIP_HORDE]:"ship_h",[this.SKILL]:"skill",[this.SOULBIND]:"soulbind",[this.SOUND]:"sound",[this.SPELL]:"spell",[this.STORYLINE]:"storyline",[this.THREAT]:"threat",[this.TITLE]:"title",[this.TRANSMOG_SET]:"transmog-set",[this.TRADING_POST_ACTIVITY]:"trading-post-activity",[this.ZONE]:"zone"},i={[WH.dataTree.RETAIL]:[this.ACHIEVEMENT,this.ADVENTURE_COMBATANT_ABILITY,this.AFFIX,this.AZERITE_ESSENCE,this.AZERITE_ESSENCE_POWER,this.BATTLE_PET_ABILITY,this.BFA_CHAMPION,this.BUILDING,this.CHAMPION,this.CURRENCY,this.EVENT,this.FACTION,this.FOLLOWER,this.GATHERER_GUIDE_IMAGE,this.GATHERER_LISTVIEW,this.GATHERER_SCREENSHOT,this.GUIDE,this.HUNTER_PET,this.ICON,this.ITEM,this.ITEM_SET,this.MISSION,this.MISSION_ABILITY,this.NPC,this.OBJECT,this.ORDER_ADVANCEMENT,this.OUTFIT,this.PLAYER_CLASS,this.PROFESSION_TRAIT,this.QUEST,this.RACE,this.RESOURCE,this.SHIP,this.SKILL,this.SOUND,this.SPELL,this.STORYLINE,this.THREAT,this.TITLE,this.TRADING_POST_ACTIVITY,this.TRANSMOG_SET,this.ZONE],[WH.dataTree.CLASSIC]:[this.FACTION,this.GATHERER_GUIDE_IMAGE,this.GATHERER_LISTVIEW,this.GATHERER_SCREENSHOT,this.GEAR_SET,this.GUIDE,this.HUNTER_PET,this.ICON,this.ITEM,this.ITEM_SET,this.NPC,this.OBJECT,this.OUTFIT,this.PLAYER_CLASS,this.QUEST,this.RACE,this.RESOURCE,this.SKILL,this.SOUND,this.SPELL,this.ZONE],[WH.dataTree.TBC]:[this.FACTION,this.GATHERER_GUIDE_IMAGE,this.GATHERER_LISTVIEW,this.GATHERER_SCREENSHOT,this.GEAR_SET,this.GUIDE,this.HUNTER_PET,this.ICON,this.ITEM,this.ITEM_SET,this.NPC,this.OBJECT,this.OUTFIT,this.PLAYER_CLASS,this.QUEST,this.RACE,this.RESOURCE,this.SKILL,this.SOUND,this.SPELL,this.ZONE],[WH.dataTree.WRATH]:[this.ACHIEVEMENT,this.CURRENCY,this.EVENT,this.FACTION,this.GATHERER_GUIDE_IMAGE,this.GATHERER_LISTVIEW,this.GATHERER_SCREENSHOT,this.GEAR_SET,this.GUIDE,this.HUNTER_PET,this.ICON,this.ITEM,this.ITEM_SET,this.NPC,this.OBJECT,this.OUTFIT,this.PLAYER_CLASS,this.QUEST,this.RACE,this.RESOURCE,this.SKILL,this.SOUND,this.SPELL,this.ZONE],[WH.dataTree.CATA]:[this.ACHIEVEMENT,this.CURRENCY,this.EVENT,this.FACTION,this.GATHERER_GUIDE_IMAGE,this.GATHERER_LISTVIEW,this.GATHERER_SCREENSHOT,this.GEAR_SET,this.GUIDE,this.HUNTER_PET,this.ICON,this.ITEM,this.ITEM_SET,this.NPC,this.OBJECT,this.OUTFIT,this.PLAYER_CLASS,this.QUEST,this.RACE,this.RESOURCE,this.SKILL,this.SOUND,this.SPELL,this.ZONE],[WH.dataTree.D2]:[],[WH.dataTree.D4]:[this.D4_AFFIX,this.D4_ASPECT,this.D4_BUILD,this.D4_ITEM,this.D4_PARAGON_GLYPH,this.D4_PARAGON_NODE,this.D4_PLAYER_CLASS,this.D4_SENESCHAL_STONE,this.D4_SKILL,this.D4_VAMPIRIC_POWER],[WH.dataTree.DI]:[this.DI_EQUIP_ITEM,this.DI_MISC_ITEM,this.DI_NPC,this.DI_OBJECT,this.DI_PARAGON_SKILL,this.DI_QUEST,this.DI_SET,this.DI_SKILL,this.DI_ZONE]},s={typeNames:void 0};function o(e){return void 0===s.typeNames&&(s.typeNames=WH.getPageData("types.names")||{}),s.typeNames[e]||Array(4).fill(WH.term("unknownType_format",e),0,4)}this.existsInDataEnv=function(e,t){return i[WH.getDataTree(t)].includes(e)},this.getIdByString=function(e){return WH.findKey(n,e,!0)},this.getDetailPageName=e=>(t[e]||[])[0]||n[e],this.getHistoricalDetailPageNames=e=>{let a=t[e]||n[e]&&[n[e]];if(!a)throw new Error(`The given type has no detail pages or string IDs. [${e}]`);return a},this.getGame=t=>{let a=(e.getRequiredTrees(t)||[])[0];return a?WH.Game.getByTree(a):void 0},this.getGameWowTypes=function(){return a.slice()},this.getPreferredDataEnv=function(e){let t=WH.Types.getRequiredTrees(e);if(t)return t.includes(WH.getDataTree())?WH.getDataEnv():WH.getRootByTree(t[0])},this.getReferenceName=function(e){return n[e]},this.getRequiredTrees=function(e){let t=[],a=!1;for(let n in i)i.hasOwnProperty(n)&&(i[n].includes(e)?t.push(parseInt(n)):a=!0);return a?t:null},this.getStringId=function(e){return n[e]},this.hasName=function(e){return s.typeNames.hasOwnProperty(e)},this.getLowerPlural=function(e){return o(e)[3]},this.getLowerSingular=function(e){return o(e)[1]},this.getUpperPlural=function(e){return o(e)[2]},this.getUpperSingular=function(e){return o(e)[0]}},WH.error=function(e){console.error.apply(console.error,Array.prototype.slice.call(arguments)),e?WH.Track&&WH.Track.nonInteractiveEvent({category:"Error",action:arguments[0],label:arguments[1],value:arguments[2]}):console.error("The error message was empty, and thus will not be logged.")},WH.info=function(e){console.info.apply(console.info,Array.prototype.slice.call(arguments))},WH.log=function(e){console.log.apply(console.log,Array.prototype.slice.call(arguments))},WH.warn=function(e){console.warn.apply(console.warn,Array.prototype.slice.call(arguments))},function(){const e={};WH.getPageData=function(t){if(e.hasOwnProperty(t))return e[t];if(WH.REMOTE)return;let a=document.querySelector(("script#data."+t).replace(/\./g,"\\."));return a?JSON.parse(a.innerHTML):void 0},WH.setPageData=function(t,a){e.hasOwnProperty(t)&&WH.warn("Duplicate data key",t),e[t]=a}}(),Object.assign(WH.PageMeta,WH.getPageData("pageMeta")||{}),WH.PageMeta.serverTime=WH.PageMeta.serverTime?new Date(WH.PageMeta.serverTime):new Date,void 0!==WH.PageMeta.staticUrl&&(WH.STATIC_URL=WH.PageMeta.staticUrl,WH.staticUrl=WH.PageMeta.staticUrl),WH.stringCompare=function(e,t){if(e==t)return 0;if(null==e)return-1;if(null==t)return 1;var a=parseFloat(e),n=parseFloat(t);return isNaN(a)||isNaN(n)||a==n?"string"==typeof e&&"string"==typeof t?e.localeCompare(t,void 0,{numeric:!0}):e<t?-1:1:a<n?-1:1},WH.trim=function(e){return e.replace(/(^\s*|\s*$)/g,"")},WH.rtrim=function(e,t){let a=e.length;for(;--a>0&&e.charAt(a)===t;);return(e=e.substring(0,a+1))===t&&(e=""),e},WH.sprintf=function(e){if("string"!=typeof e)return WH.error("No format passed to WH.sprintf.",e),"";for(var t=1,a=arguments.length;t<a;++t)e=e.replace("$"+t,arguments[t]);return e},WH.sprintfGlobal=function(e){for(var t=1,a=arguments.length;t<a;++t)e=e.replace(new RegExp("\\$"+t,"g"),arguments[t]);return e},WH.stringReplace=function(e,t,a){for(;-1!=e.indexOf(t);)e=e.replace(t,a);return e},WH.term=function(e){if(!WH.TERMS)return e;let t=[WH.TERMS[e]].concat(Array.prototype.slice.call(arguments,1));return WH.Strings.sprintf.apply(null,t)},WH.wowTerm=function(e){if(!WH.GlobalStrings)return e;let t=[WH.GlobalStrings[e]].concat(Array.prototype.slice.call(arguments,1));return WH.Strings.sprintf.apply(null,t)},WH.htmlEntities=function(e){return e.replace(/[\u00A0-\u9999<>\&]/gim,(function(e){return"&#"+e.charCodeAt(0)+";"}))},WH.stub=function(e){let t=e.split("."),a=WH;for(let e,n=0;e=t[n];n++)a[e]||(a[e]={}),a=a[e]},WH.urlEncode=function(e){return e=encodeURIComponent(e),e=WH.stringReplace(e,"+","%2B")},WH.urlEncodeHref=function(e){return e=encodeURIComponent(e),e=WH.stringReplace(e,"%20","+"),e=WH.stringReplace(e,"%3D","=")},WH.numberFormat=function(e){var t=(""+parseFloat(e)).split(".");e=t[0];var a=t.length>1?"."+t[1]:"";return e.length<=3?e+a:WH.numberFormat(e.substr(0,e.length-3))+","+e.substr(e.length-3)+a},WH.numberLocaleFormat=function(e,t){var a="";4==(a="number"==typeof t?Locale.locales[t].name:"string"==typeof t?t:Locale.getName()).length&&(a=a.substr(0,2).toLowerCase()+"-"+a.substr(2).toUpperCase());var n=""+e;try{n=e.toLocaleString(a)}catch(t){n=e.toLocaleString()}return n},WH.inArray=function(e,t,a,n){if(null==e)return-1;if(!Array.isArray(e))return WH.error("Tried looking for a value in a haystack which is not an array.",arguments),-1;var i;if(a){i=e.length;for(var s=n||0;s<i;++s)if(a(e[s])==t)return s;return-1}if((i=e.indexOf(t,n))>=0)return i;i=e.length;for(var o=n||0;o<i;++o)if(e[o]==t)return o;return-1},WH.isSet=function(e){return void 0!==window[e]},!WH.isSet("console"))var console={log:function(){}};for(var i in WH.arrayWalk=function(e,t,a){for(var n=0,i=e.length;n<i;++n){var s=t(e[n],a,e,n);null!=s&&(e[n]=s)}},WH.arrayApply=function(e,t,a){for(var n=0,i=e.length;n<i;++n)t(e[n],a,e,n)},WH.arrayFilter=function(e,t){for(var a=[],n=0,i=e.length;n<i;++n)t(e[n])&&a.push(e[n]);return a},WH.arrayUnique=function(e){for(var t={},a=e.length-1;a>=0;--a)t[e[a]]=1;var n=[];for(var i in t)n.push(i);return n},WH.closest=function(e,t){for(;e&&e.nodeType===Node.ELEMENT_NODE;){if(e.matches(t))return e;e=e.parentNode}},WH.ge=function(e){return"string"!=typeof e?e:document.getElementById(e)},WH.gE=function(e,t){return e.getElementsByTagName(t)},WH.qs=function(e,t){return(t||document).querySelector(e)},WH.qsa=function(e,t){return(t||document).querySelectorAll(e)},WH.ce=function(e,t,a){},WH.ce=function(e){return function(t,a,n){var i=e(t);return a&&WH.cOr(i,a),n&&WH.ae(i,n),"INPUT"===i.tagName&&"range"===i.type&&!WH.isRemote()&&WH.DOM&&WH.DOM.styleRangeElement(i),i}}(document.createElement.bind(document)),WH.de=function(e,t){"string"==typeof e&&(e=(t||document).querySelector(e)),e&&e.parentNode&&e.parentNode.removeChild(e)},WH.ae=function(e,t){return Array.isArray(t)?(WH.arrayApply(t,e.appendChild.bind(e)),t):e.appendChild(t)},WH.aea=(e,t)=>e.parentNode.insertBefore(t,e.nextSibling),WH.aeb=function(e,t){return e.parentNode.insertBefore(t,e)},WH.aef=function(e,t){return e.insertBefore(t,e.firstChild)},WH.ee=function(e,t){for(t||(t=0);e.childNodes[t];)e.removeChild(e.childNodes[t])},WH.ct=function(e){return document.createTextNode(e)},WH.st=function(e,t){e.firstChild&&3==e.firstChild.nodeType?e.firstChild.nodeValue=t:WH.aef(e,WH.ct(t))},WH.noWrap=function(e){e.style.whiteSpace="nowrap"},WH.rf=function(){return!1},WH.rfWithoutControlKey=function(e){if(!(e.ctrlKey||e.shiftKey||e.altKey||e.metaKey))return!1},WH.aE=function(e,t,a,n){if(e){"string"==typeof e?e=document.querySelectorAll(e):e instanceof EventTarget?e=[e]:Array.isArray(e)||e instanceof NodeList||(e=[e]),t="string"==typeof t?[t]:t;for(let i=0;i<e.length;i++)for(let s of t)"resize"===s&&WH.triggerResizeEvents(e[i]),e[i].addEventListener(s,a,n||!1)}},WH.dE=function(e,t,a,n){if(e){"string"==typeof e?e=document.querySelectorAll(e):e instanceof EventTarget?e=[e]:Array.isArray(e)||e instanceof NodeList||(e=[e]);for(let i=0;i<e.length;i++)e[i].removeEventListener(t,a,n||!1)}},WH.preventSelectStart=function(e){e.dataset.preventSelectStart="true"},WH.sp=function(e){e||(e=window.event),e.stopPropagation()},WH.setCookie=function(e,t,a,n,i,s){var o=new Date,r=e+"="+encodeURI(a)+"; ";o.setDate(o.getDate()+t),r+="expires="+o.toUTCString()+"; ",n&&(r+="path="+n+"; "),i&&(r+="domain="+i+"; "),!0===s&&(r+="secure;"),document.cookie=r,WH.getCookies(e),WH.getCookies.C[e]=a},WH.deleteCookie=function(e,t,a,n){WH.setCookie(e,-1,"",t,a,n),WH.getCookies.C[e]=null},WH.getCookies=function(e){if(null==WH.getCookies.I){var t=decodeURI(document.cookie).split("; ");WH.getCookies.C={};for(var a=0,n=t.length;a<n;++a){var i,s,o=t[a].indexOf("=");-1!=o?(i=t[a].substr(0,o),s=t[a].substr(o+1)):(i=t[a],s=""),WH.getCookies.C[i]=s}WH.getCookies.I=1}return e?WH.getCookies.C[e]:WH.getCookies.C},WH.dO=function(e){return WH.cO({},e)},WH.cO=function(e,t){for(var a in t)null!==t[a]&&"object"==typeof t[a]&&t[a].length?e[a]=t[a].slice(0):e[a]=t[a];return e},WH.cOr=function(e,t,a){for(var n in t)a&&n.substr(0,a.length)==a||(null!==t[n]&&"object"==typeof t[n]?Array.isArray(t[n])?e[n]=t[n].slice(0):(e[n]||(e[n]={}),WH.cOr(e[n],t[n],a)):e[n]=t[n]);return e},WH.fround=function(e){if(Math.fround)return Math.fround(e);if("undefined"!=typeof Float32Array&&Float32Array){var t=new Float32Array(1);return t[0]=+e,t[0]}return e},WH.displayBlock=function(e,t){("string"!=typeof e||(e=(t||document).querySelector(e)))&&(e.style.display="block")},WH.displayDefault=function(e,t){("string"!=typeof e||(e=(t||document).querySelector(e)))&&e.style.removeProperty("display")},WH.displayInline=function(e,t){("string"!=typeof e||(e=(t||document).querySelector(e)))&&(e.style.display="inline")},WH.displayNone=function(e,t){("string"!=typeof e||(e=(t||document).querySelector(e)))&&(e.style.display="none")},WH.setData=function(e,t,a,n){let i;if("string"==typeof e)i=(n||document).querySelectorAll(e);else{if(!e)return void WH.error("No element passed to WH.setData().",t,a,e,n);if(e.dataset)i=[e];else{if(!e.length)return void WH.error("Element not supported by WH.setData().",t,a,e,n);i=e}}if(null==a)for(let e,a=0;e=i[a];a++)delete e.dataset[t];else for(let e,n=0;e=i[n];n++)e.dataset[t]=a},WH.getWindowSize=function(){return{w:window.innerWidth,h:window.innerHeight}},WH.getScroll=function(){return{x:window.scrollX,y:window.scrollY}},WH.getCursorPos=function(e){return{x:e.pageX,y:e.pageY}},WH.ac=function(e,t){let a=0,n=0;for(;e;){let t;e.style.transform&&(t=e.style.transform.match(/scale\(([\d.]+)\)/i))&&(a*=parseFloat(t[1]),n*=parseFloat(t[1])),a+=e.offsetLeft,n+=e.offsetTop;let i=e.parentNode;for(;i&&i!==e.offsetParent&&i.offsetParent;){if(i.scrollLeft||i.scrollTop){a-=0|i.scrollLeft,n-=0|i.scrollTop;break}i=i.parentNode}e=e.offsetParent}if(window.Lightbox&&Lightbox.isVisible()&&(t=!0),t){let e=WH.getScroll();a+=e.x,n+=e.y}let i=[a,n];return i.x=a,i.y=n,i},WH.getOffset=function(e,t){let a=e.getBoundingClientRect(),n={left:a.left,top:a.top};if(!0!==t){let e=WH.getScroll();n.left+=e.x,n.top+=e.y}return n},WH.scrollTo=function(e,t){if(t=t||{},"string"==typeof e){let t=document.querySelector(e);if(!t)return void WH.error("Could not select element to scroll to.",e);e=t}if(e&&e.nodeType===Node.ELEMENT_NODE){if(t.asNeeded){let a=e.getBoundingClientRect(),n="center"===t.position?10:0;if(a.top>=WH.Layout.getHeaderBottom()+n&&(!(t.allowScrollingDown??1)||a.top+a.height+n<window.innerHeight)&&a.left>=n&&a.left+a.width+n<window.innerWidth)return}e.scrollIntoView({behavior:!1===t.animated?"auto":"smooth",block:t.position||"start"})}else WH.error("Invalid target to scroll to.",e)},WH.isElementPositionFixedOrSticky=e=>{let t=["fixed","sticky"];for(;e&&e.nodeType===Node.ELEMENT_NODE;){if(t.includes(getComputedStyle(e).position))return!0;e=e.parentNode}return!1},WH.createReverseLookupJson=function(e){var t={};for(var a in e)t[e[a]]=a;return t},WH.getLocaleFromDomain=function(e){var t=WH.getLocaleFromDomain.L;return e&&"string"==typeof e&&t[e.split(".")[0]]||0},WH.getLocaleFromDomain.L={ko:1,fr:2,de:3,cn:4,es:6,ru:7,pt:8,it:9},WH.getDomainFromLocale=function(e){var t;return(t=WH.getDomainFromLocale.L?WH.getDomainFromLocale.L:WH.getDomainFromLocale.L=WH.createReverseLookupJson(WH.getLocaleFromDomain.L))[e]?t[e]:""},WH.fetch=function(){let e=function(e){let t=[];for(let a in e)e.hasOwnProperty(a)&&t.push(encodeURIComponent(a)+"="+encodeURIComponent(e[a]));return t.join("&")},t=function(e){return e.contentType?e.contentType:"object"==typeof e.form?"application/x-www-form-urlencoded":e.hasOwnProperty("json")?"application/json":"string"==typeof e.body?"application/octet-stream":void 0};if("function"!=typeof window.fetch){let a=function(e,t,a){let n=this,i=n.responseText,s=0===(n.getResponseHeader("content-type")||"").indexOf("application/json"),o=null;if(n.status<200||n.status>399)o="Legacy WH.fetch call got a bad response code.";else if(s)try{i=JSON.parse(i)}catch(e){i=void 0,o="Could not process Legacy WH.fetch JSON response. "+e.message}o?(WH.error(o,e,n.status,n.responseText,n),t.error&&t.error(i,n.status)):t.success&&t.success(i,n.status),t.complete&&t.complete(i,n.status)},n=function(e,t,a){let n=this,i=n.responseText||void 0;t.errorExpected||WH.error("Legacy WH.fetch call could not complete.",e,n.status,n.responseText,n),t.error&&t.error(i,n.status),t.complete&&t.complete(i,n.status)};return function(i,s){(s=s||{}).query&&(i+=(i.indexOf("?")>-1?"&":"?")+WH.Url.buildQuery(s.query));let o=s.method||"GET";(s.hasOwnProperty("data")||"string"==typeof s.body)&&(o=s.method||"POST");let r=new XMLHttpRequest;WH.aE(r,"load",a.bind(r,i,s)),WH.aE(r,"error",n.bind(r,i,s)),r.overrideMimeType("text/plain"),r.open(o,i,!0);let l=t(s);l&&r.setRequestHeader("Content-Type",l),"object"==typeof s.form?r.send(e(s.form)):s.hasOwnProperty("json")?r.send(JSON.stringify(s.json)):"string"==typeof s.body?r.send(s.body):r.send()}}let a=function(e,t,a,n){a.ok?t.success&&t.success(n,a.status):(t.errorExpected||WH.error("WH.fetch call got a bad response code.",e,a.status,n,a),t.error&&t.error(n,a.status)),t.complete&&t.complete(n,a.status)},n=function(e,t,a,n){let i="Could not process WH.fetch response, callback errored. "+n.message;WH.error(i,e,a.status,"",a),t.error&&t.error(void 0,a.status),t.complete&&t.complete(void 0,a.status)},i=function(e,t,i){(0===(i.headers.get("content-type")||"").indexOf("application/json")?i.json():i.text()).then(a.bind(null,e,t,i)).catch(n.bind(null,e,t,i))},s=function(e,t,a){let n="WH.fetch call could not complete. "+a.message;WH.error(n,e,0,"",a),t.error&&t.error(void 0,0,a.message),t.complete&&t.complete(void 0,0,a.message)};return function(a,n){(n=n||{}).query&&(a+=(a.indexOf("?")>-1?"&":"?")+WH.Url.buildQuery(n.query));let o={credentials:"boolean"!=typeof n.cookies||n.cookies?"same-origin":"omit",headers:new Headers,method:n.method||"GET",mode:n.mode||"same-origin"},r=t(n);r&&o.headers.set("Content-Type",r),"object"==typeof n.form?(o.method=n.method||"POST",o.body=e(n.form)):n.hasOwnProperty("json")?(o.method=n.method||"POST",o.body=JSON.stringify(n.json)):"string"==typeof n.body&&(o.method=n.method||"POST",o.body=n.body),fetch(a,o).then(i.bind(null,a,n)).catch(s.bind(null,a,n))}}(),WH.ajaxIshRequest=function(e,t){var a=document.getElementsByTagName("head")[0];if("http:"!==e.substr(0,5)||"https:"!==location.protocol){if(t){var n=WH.ce("script",{type:"text/javascript",src:e});return WH.ae(a,n),n}var i=WH.getGets();null!=i.refresh&&(i.refresh.length?e+="&refresh="+i.refresh:e+="&refresh"),null!=i.locale&&(e+="&locale="+i.locale),null!=i.ptr&&(e+="&ptr");n=WH.ce("script",{type:"text/javascript",src:e,charset:"utf8"});return WH.ae(a,n),n}WH.error("Refused to AJAX-ish load URL.",e)},WH.xhrJsonRequest=function(e,t){var a=new XMLHttpRequest;a.onload=function(e){var a=e.target.response;switch(e.target.responseType){case"json":break;case"":case"text":try{a=JSON.parse(a)}catch(a){return WH.error("Could not parse expected JSON response",e.target),t()}break;default:return WH.error("Unexpected response type from JSON request",e.target),t()}return t(a)},a.onerror=function(){return t()},a.open("GET",e,!0),a.responseType="json",a.send()},WH.getGets=function(){if(null!=WH.getGets.C)return WH.getGets.C;var e=WH.getQueryString(),t=WH.parseQueryString(e);return WH.getGets.C=t,t},WH.visitUrlWithPostData=function(e,t){var a=WH.ce("form");for(var n in a.action=e,a.method="post",t)if(t.hasOwnProperty(n)){var i=WH.ce("input");i.type="hidden",i.name=n,i.value=t[n],WH.ae(a,i)}WH.ae(document.body,a),a.submit()},WH.getQueryString=function(){var e="";return location.pathname&&(e+=location.pathname.substr(1)),location.search&&(location.pathname&&(e+="&"),e+=location.search.substr(1)),e},WH.parseQueryString=function(e){for(var t=(e=decodeURIComponent(e).replace(/^\?+/,"")).split("&"),a={},n=0,i=t.length;n<i;++n)WH.splitQueryParam(t[n],a);return a},WH.splitQueryParam=function(e,t){if(""!==e){var a,n,i=e.indexOf("=");-1!=i?(a=e.substr(0,i),n=e.substr(i+1)):(a=e,n=""),t[a]=n}},WH.createRect=function(e,t,a,n){return{l:e,t:t,r:e+a,b:t+n}},WH.intersectRect=function(e,t){return!(e.l>=t.r||t.l>=e.r||e.t>=t.b||t.t>=e.b)},WH.getViewport=function(){var e=$(window);return new Rectangle(e.scrollLeft(),e.scrollTop(),e.width(),e.height())},WH.keyPressIsAlphaNumeric=function(e){var t=document.all?e.keycode:e.which;return t>47&&t<58||t>64&&t<91||t>95&&t<112||222==t||0==t},WH.isRemote=function(){return!WH.PageMeta.wowhead},WH.isDev=function(){return!!WH.PageMeta.dev},WH.getDataEnv=function(){return WH.PageMeta.hasOwnProperty("dataEnv")?WH.PageMeta.dataEnv.env:WH.dataEnv.MAIN},WH.getDataEnvFromKey=function(e){for(let t in WH.dataEnvKey)if(WH.dataEnvKey[t]===e)return parseInt(t)},WH.getDataEnvKey=function(e){return WH.dataEnvKey[e||WH.getDataEnv()]},WH.getDataEnvSeoName=function(e){return e=e||WH.getDataEnv(),WH.TERMS[e===WH.dataEnv.TBC?"tbcClassic":WH.getDataEnvTerm(e)]},WH.getDataEnvTerm=function(e){return WH.dataEnvTerm[e||WH.getDataEnv()]},WH.getDataTree=function(e){return void 0!==e?WH.dataEnvToTree[e]:WH.PageMeta.hasOwnProperty("dataEnv")?WH.PageMeta.dataEnv.tree:WH.dataTree.RETAIL},WH.getDataTreeFromKey=function(e){const t=WH.getDataEnvFromKey(e);if(null!=t)return WH.getDataTree(t)},WH.getDataTreeKey=function(e){return WH.getDataEnvKey(WH.dataTreeToRoot[e||WH.getDataTree()])},WH.getDataTreeShortTerm=function(e){return WH.dataTreeShortTerm[e||WH.getDataTree()]},WH.getDataTreeTerm=function(e){return WH.dataTreeTerm[e||WH.getDataTree()]},WH.getRootByTree=function(e){return WH.dataTreeToRoot[e]},WH.getRootEnv=function(e){return WH.dataTreeToRoot[WH.getDataTree(e||WH.getDataEnv())]},WH.getServerTime=function(){return WH.PageMeta.serverTime},WH.getDataCacheVersion=function(e){return(WH.PageMeta.activeDbChanged&&WH.PageMeta.activeDbChanged[e||WH.getDataEnv()]||"0").toString()},WH.isBeta=function(){return WH.getDataEnv()===WH.dataEnv.BETA},WH.isBetaActive=function(){return WH.PageMeta.hasOwnProperty("dataEnv")?WH.PageMeta.dataEnv.active.beta:!!WH.REMOTE},WH.isCataTree=function(e){return WH.getDataTree(e)===WH.dataTree.CATA},WH.isClassicTree=function(e){return WH.getDataTree(e)===WH.dataTree.CLASSIC},WH.isDataEnvActive=function(e){switch(e){case WH.dataEnv.BETA:return WH.isBetaActive();case WH.dataEnv.PTR:return WH.isPtrActive();case WH.dataEnv.PTR2:return WH.isPtr2Active();case WH.dataEnv.D4PTR:return WH.isRemote()||!!WH.PageMeta?.dataEnv?.active.d4ptr;default:return!0}},WH.isDataEnvRestricted=function(e){return!WH.isRemote()&&WH.PageMeta.restrictedDataEnvs.includes(e)},WH.isEntityRestricted=function(e){return!WH.isRemote()&&WH.PageMeta.restrictedEntities.includes(e)},WH.isPtr=function(){return WH.getDataEnv()===WH.dataEnv.PTR},WH.isPtr2=function(){return WH.getDataEnv()===WH.dataEnv.PTR2},WH.isPtrActive=function(){return WH.PageMeta.hasOwnProperty("dataEnv")?WH.PageMeta.dataEnv.active.ptr:!!WH.REMOTE},WH.isPtr2Active=function(){return WH.PageMeta.hasOwnProperty("dataEnv")?WH.PageMeta.dataEnv.active.ptr2:!!WH.REMOTE},WH.isRetailTree=function(e){return WH.getDataTree(e)===WH.dataTree.RETAIL},WH.isTbcTree=function(e){return WH.getDataTree(e)===WH.dataTree.TBC},WH.isWrathTree=function(e){return WH.getDataTree(e)===WH.dataTree.WRATH},WH.suppressExternalDebug=function(){return!!WH.PageMeta.suppressExternalDebug},WH.setupFooterMenus=function(){Menu.onLoad((()=>["help","tools","about"].forEach((e=>{const t=`footer-${e}-menu`,a=`footer_${e}`,n=WH.ge(t);n&&(n.classList.add("hassubmenu"),Menu.add(n,Menu.getMenu(a)))}))))},WH.getScreenshotUrl=function(e,t,a){t||(t="normal"),a=a||{};var n="normal"==t&&"string"==typeof a.description&&a.description?"-"+WH.Strings.slug(a.description,!0):"",i={2:".jpg",3:".png",18:".webp"},s=i[a.imageType||2]||i[2];return a.staffOnly?"/admin/screenshots/view/"+e+"?ext="+s.replace(/\./,""):WH.staticUrl+"/uploads/screenshots/"+t+"/"+e+n+s},WH.getWowMaxLevel=()=>WH.Wow?.getMaxPlayerLevel?.()??70,WH.convertRatingToPercent=function(e,t,a,n){let i=(WH.convertRatingToPercent.LT||{})[t]||{},s=i[WH.findSparseKey(i,e)]||0;if(null!=n&&(WH.isWrathTree()||WH.isCataTree())&&!WH.isRemote()){const e=WH.Wow.Item.Stat,a=WH.Wow.PlayerClass;[e.ID_HASTE_RATING,e.ID_HASTE_MELEE_RATING].includes(t)&&[a.PALADIN,a.DEATH_KNIGHT,a.SHAMAN,a.DRUID].includes(n)&&(s/=1.3)}return s?a/s:0},WH.statToRating={11:0,12:1,13:2,14:3,15:4,16:5,17:6,18:7,19:8,20:9,21:10,25:15,26:15,27:15,28:17,29:18,30:19,31:5,32:8,34:15,35:15,36:17,37:23,44:24,49:25,57:26,59:11,60:12,61:13,62:16,63:20,64:21,40:29},WH.statToJson={0:"mana",1:"health",3:"agi",4:"str",5:"int",6:"spi",7:"sta",8:"energy",9:"rage",10:"focus",13:"dodgertng",14:"parryrtng",15:"blockrtng",16:"mlehitrtng",17:"rgdhitrtng",18:"splhitrtng",19:"mlecritstrkrtng",20:"rgdcritstrkrtng",21:"splcritstrkrtng",22:"corruption",23:"corruptionres",24:"_splhitrtng",25:"_mlecritstrkrtng",26:"_rgdcritstrkrtng",27:"_splcritstrkrtng",28:"mlehastertng",29:"rgdhastertng",30:"splhastertng",31:"hitrtng",32:"critstrkrtng",33:"_hitrtng",34:"_critstrkrtng",35:"resirtng",36:"hastertng",37:"exprtng",38:"atkpwr",39:"rgdatkpwr",40:"versatility",41:"splheal",42:"spldmg",43:"manargn",44:"armorpenrtng",45:"splpwr",46:"healthrgn",47:"splpen",49:"mastrtng",50:"armorbonus",51:"firres",52:"frores",53:"holres",54:"shares",55:"natres",56:"arcres",57:"pvppower",58:"amplify",59:"multistrike",60:"readiness",61:"speedbonus",62:"lifesteal",63:"avoidance",64:"sturdiness",66:"cleave",71:"agistrint",72:"agistr",73:"agiint",74:"strint",75:"",76:"",77:"",78:"",79:"",80:"",81:""},WH.jsonToStat={},WH.statToJson)WH.jsonToStat[WH.statToJson[i]]=i;WH.individualToGlobalStat={16:31,17:31,18:31,19:32,20:32,21:32,24:33,25:34,26:34,27:34,28:36,29:36,30:36},WH.convertScalingFactor=function(e,t,a,n,i){var s=WH.convertScalingFactor.SV,o=WH.convertScalingFactor.SD.stats;if(!s||!s[e])return g_user.roles&U_GROUP_ADMIN&&alert("There are no item scaling values for level "+e),i?{}:0;var r={},l=s[e],c=o[a];if(c&&(n>=0&&n<10)){let e=WH.findSparseKey(c,n),a=WH.findSparseKey(c,n+10);r.n=WH.statToJson[c[e]],r.s=c[e],r.v=Math.floor(l[t]*c[a]/1e4)}else r.v=l[t];return i?r:r.v},WH.getScalingDistributionCurve=function(e){let t=((WH.convertScalingFactor.SD||{}).curves||{})[e];return t?{minLevel:t[0],maxLevel:t[1],curve:t[2]}:void 0},g_itemScalingCallbacks=[],WH.getSpellScalingIndexFromScalingClass=function(e,t){if(e===WH.EFFECT_SCALING_CLASS_1&&WH.isCataTree())return WH.EFFECT_SCALING_CLASS_CATA_ITEM;switch(e){case WH.EFFECT_SCALING_CLASS_2:if(463==t)return WH.EFFECT_SCALING_CLASS_ITEM;break;case WH.EFFECT_SCALING_CLASS_7:return WH.EFFECT_SCALING_CLASS_ITEM;case WH.EFFECT_SCALING_CLASS_8:case WH.EFFECT_SCALING_CLASS_9:return WH.EFFECT_SCALING_CLASS_DAMAGEREPLACESTAT}return e<0?Math.abs(e)+(WH.EFFECT_SCALING_CLASS_ITEM-1):e},WH.effectAverage=function(e,t,a,n){let i=WH.convertScalingSpell.RandPropPoints,s=e.scalingClass;e.effectScalingClass&&0!=(e.effectScalingClass?.[n]??0)&&(s=e.effectScalingClass[n]);let o=e.coefficient[n]??e.coefficient[0]??0,r=1,l=0;if(0!=o&&0!=s){if(e.scalesWithItemLevel)l=s==WH.EFFECT_SCALING_CLASS_8?i[a][0]:s==WH.EFFECT_SCALING_CLASS_9?i[a][2]:i[a][1];else{let e=WH.getSpellScalingIndexFromScalingClass(s);l=WH.convertScalingSpell.SV[t][e-1]}return s!==WH.EFFECT_SCALING_CLASS_7||!e.aura||e.aura[n]!==WH.EFFECT_AURA_DUMMY&&e.aura[n]!==WH.EFFECT_AURA_PROC_TRIGGER_SPELL||(r=WH.getCombatRatingMult(a,12)),o*l*r}return e.effectBasePoints[n]},WH.convertScalingSpell=function(e,t,a,n,i,s){var o=WH.convertScalingSpell.SpellInformation;if(!o||!o[t])return e;a-=1,null==e.effects&&(e.effects={}),e.effects.hasOwnProperty(a+1)||(e.effects[a+1]={});var r=o[t],l=0,c=WH.effectAverage(r,i,s,a);if(r.deltaCoefficient[a]){var d=r.deltaCoefficient[a],p=Math.ceil(c-c*d/2),u=Math.floor(c+c*d/2);0==n?l=(p+u)/2:1==n?l=p:2==n&&(l=u)}else l=0!=(r.coefficient[a]??0)||0!=c?c:r.effectBasePoints[a]??0;l=Math.abs(l);var h="avg";switch(parseInt(n)){case 0:case 3:default:h="avg";break;case 1:h="min";break;case 2:h="max";break;case 4:h="pts"}var g=5;return window.g_pageInfo&&window.g_pageInfo.type==WH.Types.AZERITE_ESSENCE_POWER&&(g=WH.Wow.Item.INVENTORY_TYPE_NECK),r.scalesWithItemLevel&&r.appliesRatingAura&&r.appliesRatingAura[a]&&(l*=WH.getCombatRatingMult(s,g)),e.effects[a+1][h]=l,e},WH.getDataSource=function(){if(WH.isSet("g_pageInfo"))switch(g_pageInfo.type){case WH.Types.ITEM:if(WH.isSet("g_items"))return g_items;break;case WH.Types.SPELL:if(WH.isSet("g_spells"))return g_spells;break;case WH.Types.AZERITE_ESSENCE_POWER:if(WH.isSet("g_azeriteEssencePowers"))return g_azeriteEssencePowers;break;case WH.Types.BATTLE_PET_ABILITY:if(WH.isSet("g_petabilities"))return g_petabilities}return[]},WH.setJsonItemLevel=function(e,t,a){if(a&&a.scalingcategory-11>0){for(var n=a.maxlvlscaling?Math.min(t,a.maxlvlscaling):t,i=WH.getSpellScalingValue(a.scalingcategory,n),s=1;s<3;++s){var o=a["itemenchspell"+s],r=a["itemenchtype"+s],l=WH.statToJson[o];if(5==r&&e[l]){var c=a["damage"+s];c&&(e[l]=Math.round(i*c))}}if(a.allstats)for(var d in e)e[d]=Math.round(i*a.damage1)}if(e.scadist&&e.scaflags){e.bonuses=e.bonuses||{};var p,u=255&e.scaflags,h=e.scaflags>>8&255,g=!!(65536&e.scaflags),f=!!(e.scaflags&1<<17),m=!!(e.scaflags&1<<18);switch(u){case 5:case 1:case 7:case 17:p=7;break;case 3:case 12:p=8;break;case 16:case 11:case 14:p=9;break;case 15:p=10;break;case 23:case 21:case 22:case 13:p=11;break;default:p=-1}if(p>=0)for(s=0;s<10;++s){var W=WH.convertScalingFactor(t,p,e.scadist,s,1);W.n&&(e[W.n]=W.v),e.bonuses[W.s]=W.v}if(m&&(e.splpwr=e.bonuses[45]=WH.convertScalingFactor(t,6)),g)switch(u){case 3:e.armor=WH.convertScalingFactor(t,11+h);break;case 5:e.armor=WH.convertScalingFactor(t,15+h);break;case 1:e.armor=WH.convertScalingFactor(t,19+h);break;case 7:e.armor=WH.convertScalingFactor(t,23+h);break;case 16:e.armor=WH.convertScalingFactor(t,28);break;case 14:e.armor=WH.convertScalingFactor(t,29);break;default:e.armor=0}if(f){var H,E=e.mledps?"mle":"rgd";switch(u){case 23:case 21:case 22:case 13:e.dps=e[E+"dps"]=WH.convertScalingFactor(t,m?2:0),H=.3;break;case 17:e.dps=e[E+"dps"]=WH.convertScalingFactor(t,m?3:1),H=.2;break;case 15:e.dps=e[E+"dps"]=WH.convertScalingFactor(t,19==h?5:4),H=.3;break;default:e.dps=e[E+"dps"]=0,H=0}e.dmgmin=e[E+"dmgmin"]=Math.floor(e.dps*e.speed*(1-H)),e.dmgmax=e[E+"dmgmax"]=Math.floor(e.dps*e.speed*(1+H))}}},WH.getContentTuningLevels=function(e){let t=(WH.contentTuningLevels||{}).keys||{},a=Object.keys(t).find((function(a){return t[a].includes(e)}));if(void 0!==a)return{minLevel:WH.contentTuningLevels.values[a][0],maxLevel:WH.contentTuningLevels.values[a][1]}},WH.scaleItemEnchantment=function(e,t){var a=e.enchantment;if(e.scalinginfo&&e.scalinginfo.scalingcategory-11>0){var n=a.match(/\d+/g);if(n)for(var i=parseInt(e.scalinginfo.maxlvlscaling)?Math.min(t,parseInt(e.scalinginfo.maxlvlscaling)):t,s=WH.getSpellScalingValue(e.scalinginfo.scalingcategory,i),o=0;o<n.length;++o){var r=e.scalinginfo["damage"+(o+1)];r&&(a=a.replace(n[o],Math.round(s*r)))}}return a},WH.getItemRandPropPointsType=function(e,t=!1){const a=e.slotbak?e.slotbak:e.slot;if(t)switch(a){case 14:case 23:return 2;case 15:case 26:case 25:return 4}switch(a){case 1:case 4:case 5:case 7:case 15:case 17:case 20:case 25:return 0;case 2:case 9:case 11:case 16:return 2;case 3:case 6:case 8:case 10:case 12:return 1;case 13:case 14:case 21:case 22:case 23:return 3;case 26:return 19==e.subclass?3:0;case 28:return 4;default:return-1}},WH.getItemProfessionPropPointsType=function(e){switch(e.slotbak||e.slot){case WH.Wow.Item.INVENTORY_TYPE_PROFESSION_TOOL:return 0;case WH.Wow.Item.INVENTORY_TYPE_PROFESSION_ACCESSORY:return 1;default:return-1}},WH.scaleItemLevel=function(e,t){let a=e.level,n=WH.curvePoints;if(!n)return a;let i=null,s=null,o=null;if(e.scadist){let t=WH.getScalingDistributionCurve(e.scadist);t&&t.curve&&(s=t.minLevel,o=t.maxLevel,i=t.curve)}else{if(e.contenttuning){let t=WH.getContentTuningLevels(e.contenttuning);t&&(s=t.minLevel,o=t.maxLevel)}i=e.playercurve}if(i){let e=t||WH.Wow.getMaxPlayerLevel();s&&e<s&&(e=s),o&&e>o&&(e=o);let r=n[i];if(r&&r.length>0){let t=-1;for(let a in r){if(r[a][1]>=e){t=a;break}}let n=r[-1!=t?t:r.length-1],i=null,s=0;if(t>0){i=r[t-1];let a=n[1]-i[1];if(a>0){let t=(e-i[1])/a*(n[2]-i[2]);s=i[2]+t}}else s=n[2];s>0&&(a=Math.round(s))}}return a},WH.findSparseKey=function(e,t){return e.hasOwnProperty(t)?t.toString():Object.keys(e).reduce((function(e,a){let n=parseInt(a);return n>t||parseInt(e)>n?e:a}),"0")},WH.applyStatModifications=function(e,t,a,n,i,s,o,r){const l=WH.Wow.Item;var c={};if(e.hasOwnProperty("level")?c=WH.dO(e):WH.cOr(c,e,"__"),i&&i.length)for(var d=!1,p=0;p<i.length;++p){if((W=i[p])>0&&WH.isSet("g_itembonuses")&&g_itembonuses[W])for(var u=g_itembonuses[W],h=0;h<u.length;++h){switch((H=u[h])[0]){case 11:case 13:(!1===d||H[2]<d)&&(c.scadist=H[1],c.scadistbonus=W,c.scadistbonustype=H[0],c.contenttuning=H[3],c.playercurve=H[4],d=H[2])}}}if(c.level=WH.scaleItemLevel(c,s),"pvp"==a&&e.pvpUpgrade&&(c.level+=e.pvpUpgrade),c.subitems&&c.subitems[t])for(var g in c.subitems[t].jsonequip)c.hasOwnProperty(g)||(c[g]=0),c[g]+=c.subitems[t].jsonequip[g];if(c.extraStats=[],i&&i.length){if(e.statsInfo)for(var p in c.statsInfo={},e.statsInfo)c.statsInfo[p]={alloc:parseInt(e.statsInfo[p].alloc),qty:e.statsInfo[p].qty,socketMult:e.statsInfo[p].socketMult};var f=[0,0,0,0,2147483647,2147483647,2147483647,2147483647],m=!c.scadistbonus&&0;let t=[24,25],a=0,n=0,s=null,o=null,r=null,l=null;for(p=0;p<i.length;++p){var W;if((W=i[p])>0&&WH.isSet("g_itembonuses")&&g_itembonuses[W])for(u=g_itembonuses[W],h=0;h<u.length;++h){var H;if(25==(H=u[h])[0]){let e=c.statsInfo[t[a]];if(!e||!e.alloc)continue;H[0]=2,H[2]=e.alloc,delete c.statsInfo[t[a]],a=Math.min(a+1,t.length-1)}switch(H[0]){case 1:n+=H[1],m=!1;break;case 2:c.statsInfo&&(c.statsInfo.hasOwnProperty(H[1])?c.statsInfo[H[1]].alloc+=H[2]:(c.extraStats.push(H[1]),c.statsInfo[H[1]]={alloc:parseInt(H[2]),qty:0,socketMult:0}));break;case 3:c.quality=parseInt(H[1]);break;case 4:var E=H[1],T=H[2],v=4,S=4;do{if(T<=f[v]){var I=E;E=f[v-4],f[v-4]=I;var y=T;T=f[v],f[v]=y}++v,--S}while(S);break;case 5:c.nameSuffix=WH.Wow.Item.getNameDescription(H[1])||c.nameSuffix;break;case 6:var _=c.nsockets?c.nsockets:0;c.nsockets=_+H[1];for(var b=_;b<_+H[1];++b)c["socket"+(b+1)]=H[2];break;case 8:c.reqlevel+=H[1];break;case 14:!1!==m&&(m=c.level);break;case 16:c.bond=parseInt(H[1]);break;case 35:c.limitcategory=parseInt(H[1]);break;case 42:(null==s||o>H[2])&&(s=H[1],o=H[2],m=!1);break;case 43:(null==r||l>H[2])&&(r=H[1],l=H[2],m=!1);break;case 27:if(WH.curvePoints){let e=WH.curvePoints[H[1]];e&&e[0]&&e[0][2]&&(c.reqlevel=e[0][2])}else WH.error("Could not apply item stat modifications without scaling curve points.",e.id,e.name);break;case 44:c.itemNameDescStats||(c.itemNameDescStats=[]),c.itemNameDescStats.push({qty:H[1],nameDescId:H[2]})}}}c.scadistbonus||(c.level=r||(s||c.level)+n),m&&(c.level=m,c.previewLevel=m),c.namedesc=c.namedesc?c.namedesc:"";for(h=0;h<4;++h){let e=WH.Wow.Item.getNameDescription(f[h]);if(e){let t=WH.Wow.Item.getNameDescriptionColor(f[h]);if(t>0){let e=parseInt(t).toString(16);for(;e.length<6;)e="0"+e;c.namedesc+=WH.sprintf('<span style="color: #$1">',e)}c.namedesc+=(c.namedesc?" ":"")+e,t>0&&(c.namedesc+="</span>")}}}!function(){if(r&&r.length&&c.statsInfo)for(let t,a=0;t=WH.Wow.Item.Stat.CRAFTING_STAT_FROM[a];a++){let n=r[a];n&&(c.statsInfo[t]&&(c.statsInfo[n]?c.statsInfo[n].alloc+=e.statsInfo[t].alloc:(c.statsInfo[n]=c.statsInfo[t],c.extraStats.push(n)),delete c.statsInfo[t]))}}();let w=WH.Wow.Expansion.available(WH.Wow.Expansion.WRATH)&&c.scadist>0;if(w&&c.statsInfo){let e=WH.convertScalingFactor.SD.stats[c.scadist];if(e){let t=l.SCALING_STATS_DISTRIBUTION_STAT_MAX;for(p=0;p<t;p++)e[p]>0&&e[p+t]>0&&(c.statsInfo[e[p]]={qty:0,alloc:parseInt(e[p+t]),socketMult:0})}}if(e.statsInfo&&e.level&&WH.applyStatModifications.ScalingData&&(WH.applyStatModifications.ScalingData.AL.length>1||w)){let t=WH.applyStatModifications.ScalingData.armor.total,i=WH.applyStatModifications.ScalingData.armor.shield,r=WH.applyStatModifications.ScalingData.armor.quality,d=WH.applyStatModifications.ScalingData.SV,u=WH.applyStatModifications.ScalingData.AL,h=WH.applyStatModifications.ScalingData.socketCost,g=WH.applyStatModifications.ScalingData.PPP,f=WH.convertScalingFactor.SV;c.level=n||(a&&e.upgrades&&e.upgrades[a-1]?c.level+e.upgrades[a-1]:c.level);var A=c.level-e.level,L=Math.pow(1.15,A/15);let m,W=c.slot===WH.Wow.Item.INVENTORY_TYPE_PROFESSION_TOOL||c.slot===WH.Wow.Item.INVENTORY_TYPE_PROFESSION_ACCESSORY,H=W?WH.getItemProfessionPropPointsType(c):WH.getItemRandPropPointsType(c,!WH.Wow.Expansion.available(WH.Wow.Expansion.MOP));var C=[];for(m=c.level;m>=0;m--)if(d.hasOwnProperty(m)){C=d[m];break}let E=0;if(-1!=H){let e=0;if(W){switch(c.quality){case WH.Wow.Item.QUALITY_EPIC:e=0;break;case WH.Wow.Item.QUALITY_RARE:e=2;break;case WH.Wow.Item.QUALITY_UNCOMMON:e=4;break;default:e=-1}if(-1!==e){e+=H;let t=WH.findSparseKey(g,m),a=WH.findSparseKey(g[t]||{},e);E=(g[t]||{})[a]||0}}else if(w){let e=null;switch(c.slot){case WH.Wow.Item.INVENTORY_TYPE_BACK:e=WH.isCataTree()?9:7;break;case WH.Wow.Item.INVENTORY_TYPE_SHOULDERS:e=30;break;case WH.Wow.Item.INVENTORY_TYPE_TRINKET:e=31;break;case WH.Wow.Item.INVENTORY_TYPE_FINGER:e=9;break;case WH.Wow.Item.INVENTORY_TYPE_ONE_HAND:e=11;break;case WH.Wow.Item.INVENTORY_TYPE_MAIN_HAND:e=WH.isCataTree()?11:7;break;case WH.Wow.Item.INVENTORY_TYPE_RANGED:e=10;break;default:e=7}f[s]&&f[s][e]&&(E=f[s][e])}else{switch(c.quality){case WH.Wow.Item.QUALITY_LEGENDARY:case WH.Wow.Item.QUALITY_EPIC:e=0;break;case WH.Wow.Item.QUALITY_HEIRLOOM:case WH.Wow.Item.QUALITY_RARE:e=1;break;case WH.Wow.Item.QUALITY_UNCOMMON:e=2}let t=WH.findSparseKey(C,e),a=WH.findSparseKey(C[t]||{},H);E=(C[t]||{})[a]||0}}let T=h[WH.findSparseKey(h,m)]||0;for(var p in WH.statToJson){var R=WH.statToJson[p];if(c[R]||c.statsInfo&&c.statsInfo[p]){var M=0,N=0;c.statsInfo.hasOwnProperty(p)&&(M=parseFloat(c.statsInfo[p].socketMult),N=parseInt(c.statsInfo[p].alloc));var O=Math.round(M*T);switch(N&&(E>0||c.contenttuning>0)?c[R]=1e-4*N*E-O:c[R]=(c[R]+O)*L-O,"sta"==R?c[R]=c[R]*WH.getStaminaRatingMult(c.level,c.slot||g_items[c.id].slot):o&&WH.inArray(WH.applyStatModifications.BASE_STATS,p)<0?c[R]=c[R]*WH.getCombatRatingMult(c.level,c.slot||g_items[c.id].slot):"corruption"!==R&&"corruptionres"!==R||(c[R]=N),R){case"agistrint":c.agi=c.str=c.int=c[R];break;case"agistr":c.agi=c.str=c[R];break;case"agiint":c.agi=c.int=c[R];break;case"strint":c.str=c.int=c[R]}}}if(c.scadist>0&&(c.dbcFlags??0)&l.DBCITEM_FLAGS_SCALING_SPELL_POWER){let e=f[s]?.[l.ITEM_SCALING_VALUE_SPELL_POWER_INDEX]??0;c.statsInfo[WH.Wow.Item.Stat.ID_SPELL_POWER]=e,c.splpwr=e}if(c.armor||w){let e=c.quality===l.QUALITY_HEIRLOOM?l.QUALITY_RARE:c.quality,a=c.subclass===l.ARMOR_SUBCLASS_CLOAKS?l.ARMOR_SUBCLASS_CLOTH:c.subclass;if(w){let e=null;l.WRATH_ARMOR_SCALING_INDEXES[c.subclass]&&l.WRATH_ARMOR_SCALING_INDEXES[c.subclass][c.slot]&&(e=l.WRATH_ARMOR_SCALING_INDEXES[c.subclass][c.slot]),f[s]&&f[s][e]&&(c.armor=f[s][e])}else if(l.isBodyArmor(l.CLASS_ARMOR,a)){let n=WH.findSparseKey(r,c.level),i=WH.findSparseKey(r[n]||{},e),s=(r[n]||{})[i]||0,o=WH.findSparseKey(t,c.level),l=WH.findSparseKey(t[o]||{},a-1),d=(t[o]||{})[l]||0,p=u[c.slot][a-1];c.armor=Math.floor(d*s*p+.5)}if(c.subclass===l.ARMOR_SUBCLASS_SHIELDS){let t=WH.findSparseKey(i,c.level),a=WH.findSparseKey(i[t]||{},e);c.armor=Math.round((i[t]||{})[a]||0)}}if(c.dps||w){var D=["dps","mledps","rgddps"],P=["dmgmin1","mledmgmin","rgddmgmin","dmgmax1","mledmgmax","rgddmgmax"],x=WH.getEffectiveWeaponDamage(c,!1),k=WH.getEffectiveWeaponDamage(c,!0);x=Math.floor(Math.max(1,x)),k=Math.max(1,k),WH.isRetailTree()||(x=c.damagemin||c.dmgmin1||x,k=c.damagemax||c.dmgmax1||k);let e=0;if(w){let t=null;switch(c.subclass){case l.WEAPON_SUBCLASS_DAGGER:case l.WEAPON_SUBCLASS_FIST_WEAPON:case l.WEAPON_SUBCLASS_ONE_HANDED_AXE:case l.WEAPON_SUBCLASS_ONE_HANDED_SWORD:t=0;break;case l.WEAPON_SUBCLASS_FISHING_POLE:case l.WEAPON_SUBCLASS_POLEARM:case l.WEAPON_SUBCLASS_TWO_HANDED_AXE:case l.WEAPON_SUBCLASS_TWO_HANDED_MACE:case l.WEAPON_SUBCLASS_TWO_HANDED_SWORD:t=1;break;case l.WEAPON_SUBCLASS_ONE_HANDED_MACE:t=WH.isCataTree()?0:2;break;case l.WEAPON_SUBCLASS_STAFF:t=WH.isCataTree()?4:3;break;case l.WEAPON_SUBCLASS_BOW:case l.WEAPON_SUBCLASS_CROSSBOW:case l.WEAPON_SUBCLASS_GUN:case l.WEAPON_SUBCLASS_THROWN:t=4;break;case l.WEAPON_SUBCLASS_WAND:t=5;break;default:t=-1}f[s]&&f[s][t]&&(e=f[s][t],x=Math.floor(e*c.speed*(1-c.dmgrange/2)),k=Math.floor(e*c.speed*(1+c.dmgrange/2)+.5),c.dmgmin1=x,c.dmgmax1=k)}else e=(x+k)/2/c.speed;var B=e>=1e3?0:WH.isRetailTree()?1:2;for(var p in e=parseFloat(e.toFixed(B)),D)(c[D[p]]||w)&&(c[D[p]]=e);for(var p in P)c[P[p]]&&(-1!=P[p].indexOf("max")?c[P[p]]=k:c[P[p]]=x)}}return c},WH.applyStatModifications.BASE_STATS=[4,3,5,71,72,73,74,7,1,0,8,9,2,10],WH.getItemDamageValue=function(e,t,a){let n=WH.applyStatModifications.ScalingData.DV;if(n&&n[e]){let i=7*a+t;return n[e][WH.findSparseKey(n[e],i)]}return 0},WH.getEffectiveWeaponDamage=function(e,t){var a=e.level,n=e.subclass,i=e.quality,s=e.slotbak?e.slotbak:e.slot,o=0,r=!1,l=512&e.flags2;if(2!=e.classs)return 0;if(i>7)return 0;if(7==i&&(i=3),s>22?(24==s&&(o=0,r=!0),!r&&(s<=24||s>26)&&(r=!0)):(21!=s&&22!=s&&13!=s||(o=l?WH.getItemDamageValue(a,i,1):WH.getItemDamageValue(a,i,0),r=!0),r||15==s||(17!=s||(o=l?WH.getItemDamageValue(a,i,3):WH.getItemDamageValue(a,i,2)),r=!0)),!r&&n>=2&&(2!=n&&3!=n&&18!=n||(o=l?WH.getItemDamageValue(a,i,3):WH.getItemDamageValue(a,i,2),r=!0),r||19!=n||(o=WH.getItemDamageValue(a,i,1))),o>0){var c=e.dmgrange||0;return t?Math.floor(o*e.speed*(1+c/2)+.5):o*e.speed*(1-c/2)}return 0},WH.getJsonReforge=function(e,t){if(!t){if(!WH.reforgeStats)return[];for(var t in e.__reforge={},e.__reforge.all=[],WH.reforgeStats){(n=WH.getJsonReforge(e,t)).amount&&e.__reforge.all.push(n)}return e.__reforge.all}if(!WH.reforgeStats||!WH.reforgeStats[t])return{};for(var a in e.__statidx={},e)WH.individualToGlobalStat[WH.jsonToStat[a]]?e.__statidx[WH.individualToGlobalStat[WH.jsonToStat[a]]]=e[a]:e.__statidx[WH.jsonToStat[a]]=e[a];e.__reforge||(e.__reforge={});var n=e.__reforge[t]=WH.dO(WH.reforgeStats[t]);return e.__reforge[t].amount=Math.floor(n.v*(e.__statidx[n.i1]&&!e.__statidx[n.i2]?e.__statidx[n.i1]:0)),e.__reforge[t]},WH.getJsonItemEnchantMask=function(e){return 2==e.classs&&19==e.subclass?1<<20:1<<e.slot-1},WH.getArtifactKnowledgeMultiplier=function(e){let t=WH.Tooltips.getScalingData(WH.Types.ITEM,"artifactKnowledgeMultiplier")||{};return t[WH.findSparseKey(t,e)]||1},WH.getCurveValue=function(e,t){var a;if(WH.curvePoints&&(a=WH.curvePoints[e])){var n=a[0][1],i=a[0][2];if(n>t)return i;for(var s,o=0;s=a[o];o++){if(t==s[1])return s[2];if(t<s[1])return(s[2]-i)/(s[1]-n)*(t-n)+i;n=s[1],i=s[2]}return i}},WH.setItemModifications=function(e,t,a,n,i,s,o){if(!WH.isSet("g_items")||!g_items[t]||!g_items[t].jsonequip)return e;const r=WH.Wow.Item.Gems;i||(i=WH.Wow.getMaxPlayerLevel()),a=a?a.split(":"):null,s||(s=WH.Timewalking.getGearIlvlByStringId(n)||0),n=s?null:n;var l=WH.applyStatModifications(g_items[t].jsonequip,0,n,s,a,i,void 0,o);!l.name&&g_items[t].hasOwnProperty("name_"+Locale.getName())&&(l.name=g_items[t]["name_"+Locale.getName()],l.quality=g_items[t].quality),e=e.replace(/(<!--ilvl-->)\d+\+?/,(function(e,t){return t+l.level+(l.previewLevel?"+":"")}));let c=!1,d=1,p=WH.Wow.getMaxPlayerLevel();if(l.scadist){let e=WH.getScalingDistributionCurve(l.scadist);e&&e.maxLevel&&(c=!0,d=e.minLevel||1,p=e.maxLevel)}else if(l.contenttuning){let e=WH.getContentTuningLevels(l.contenttuning);e&&(c=!0,d=e.minLevel,p=e.maxLevel)}else if(l.scadistbonus&&13===l.scadistbonustype&&l.playercurve){let e=WH.curvePoints[l.playercurve];d=e[0][1],p=Math.min(e[e.length-1][1],WH.Wow.getMaxPlayerLevel()),c=!0}if(c){i=i&&i<=p?i:p,e=e.replace(/(<!--lvl-->)\d+/g,(function(e,t){return t+(i&&i<=p?i:p)})),e=e.replace(/(<!--minlvl-->)\d+/,(function(e,t){return t+d})),e=e.replace(/(<!--maxlvl-->)\d+/,(function(e,t){return t+p}));let a=!1;e=e.replace(/<!--i\?(\d+):(\d+):(\d+):(\d+)(?::(\d+):(\d+))?/,(function(e,t,n,s,o,r,c){return a=!0,"\x3c!--i?"+t+":"+d+":"+p+":"+i+":"+(l.scadist||l.contenttuning)+":"+(c||0)})),a||(e+="\x3c!--i?"+t+":"+d+":"+p+":"+i+":"+(l.scadist||l.contenttuning)+":0--\x3e"),e=e.replace(/(<!--huindex-->)\d+/,(function(e,t){let a=0;if(l.scadistbonus&&l.heirloombonuses)for(let e,t=0;e=l.heirloombonuses[t];t++)if(parseInt(l.scadistbonus)===e){a=t+1;break}return t+a}))}else e=e.replace(/<!--i\?(\d+):(\d+):(\d+):(\d+)(?::(\d+):(\d+))?/,(function(e,t,a,n,s,o,r){return"\x3c!--i?"+t+":"+a+":"+n+":"+(i||n)}));var u;(u=WH.ge("sl"+t))&&(u.style.display=c?"block":"none"),e=e.replace(/(<!--pvpilvl-->)\d+/,(function(e,t){return t+(l.level+("pvp"!=n?l.pvpUpgrade:0))})),e=e.replace(/(<!--ilvldelta-->)\d+/,(function(e,t){return t+Math.floor(WH.getCurveValue(1718,l.level)||2)})),e=e.replace(/(<!--rlvl-->)\d+/,(function(e,t){return t+l.reqlevel})),e=e.replace(/(<!--uindex-->)\d+/,(function(e,t){return n&&"pvp"!=n?t+n:e}));var h=void 0!==l.dmgrange&&l.dmgrange,g=new RegExp("(\x3c!--dmg--\x3e)[\\d,]+"+(h?"(\\D*?)[\\d,]+":""));e=e.replace(g,(function(e,t,a){return t+WH.numberFormat(l.dmgmin1)+(h?a+WH.numberFormat(l.dmgmax1):"")})),e=e.replace(/(<!--dps-->\D*?)([\d,]+(?:\.\d+)?)/,(function(e,t){var a=l.dps>=1e3?0:WH.isRetailTree()?1:2;return t+(l.dps?WH.numberFormat(l.dps.toFixed(a)):"0")})),e=e.replace(/(<!--amr-->)\d+/,(function(e,t){return t+l.armor}));var f=WH.getCombatRatingMult(l.level,g_items[t].slot);if(e=function(e){let t=WH.ce("div",{innerHTML:e});return WH.qsa("span",t).forEach((function(e){let t,a,n,i;if(e.childNodes.forEach((function(e){if(e.nodeType===Node.COMMENT_NODE){let s;(s=(e.nodeValue||"").match(/^stat(\d+)$/))&&(t=parseInt(s[1]),n=e),(s=(e.nodeValue||"").match(/^rtg(\d+)$/))&&(a=parseInt(s[1]),i=e)}})),void 0===t&&void 0===a)return;let s=!1;if(a){let e=l[WH.statToJson[a]]?l[WH.statToJson[a]]:0,t=e<0?"-":"+";e?e=Math.round(e*f):(s=!0,e=0);let n=i.previousSibling;n&&n.nodeType===Node.TEXT_NODE&&(n.nodeValue=n.nodeValue.replace(/[-+]$/,t));let o=i.nextSibling;o&&o.nodeType===Node.TEXT_NODE&&(o.nodeValue=o.nodeValue.replace(/[-\d\.,]+/,e))}else{let e=l[WH.statToJson[t]]?l[WH.statToJson[t]]:0;if(e){let t=Math.round(e);e=(t>0?"+":"-")+WH.numberLocaleFormat(t)}else s=!0,e="+0";let a=n.nextSibling;a&&a.nodeType===Node.TEXT_NODE&&(a.nodeValue=a.nodeValue.replace(/[-+][-\d\.,]+/,e))}if(s){WH.displayNone(e);let t=e.nextSibling;for(;t;){if(t.nodeType===Node.ELEMENT_NODE){"br"===t.nodeName.toLowerCase()&&t.parentNode.replaceChild(document.createComment("br"),t);break}t=t.nextSibling}}else WH.displayDefault(e)})),t.innerHTML}(e),l.extraStats&&l.extraStats.length){e=e.replace(/<!--re--><span[^<]*?<\/span>(<br \/>)?/,"");var m=WH.applyStatModifications.BASE_STATS;e=e.replace(/<!--ebstats-->/,(function(e){for(var t="",a=0;a<l.extraStats.length;++a){var n=l.extraStats[a];if(-1!=m.indexOf(n)){var i="$1$2 "+(WH.statToJson&&WH.statToJson[n]&&WH.Wow.Item.Stat.jsonToName(WH.statToJson[n])||"Unknown"),s=WH.statToJson&&WH.statToJson[n]?l[WH.statToJson[n]]:0,o=Math.round(s*f),r=WH.numberLocaleFormat(o);t+="<br /><span>\x3c!--stat"+n+"--\x3e"+WH.sprintf(i,o<0?"-":"+",r)+"</span>"}}return t+e})),e=e.replace(/<!--egstats-->/,(function(e){for(var t="",a=0;a<l.extraStats.length;++a){var n=l.extraStats[a];if(-1==m.indexOf(n)){var i=f,s="q2";switch(WH.statToJson[n]){case"corruption":s="stat-corruption",i=1;break;case"corruptionres":s="q6",i=1}var o="$1$2 "+(WH.statToJson&&WH.statToJson[n]&&WH.Wow.Item.Stat.jsonToName(WH.statToJson[n])||"Unknown"),r=WH.statToJson&&WH.statToJson[n]?l[WH.statToJson[n]]:0,c=Math.round(r*i),d=WH.numberLocaleFormat(c),p=WH.sprintf("\x3c!--rtg$1--\x3e$2",n,d),u="";WH.statToRating&&WH.statToRating[n]&&(u=WH.sprintf("&nbsp;<small>(\x3c!--rtg%$1--\x3e0&nbsp;@&nbsp;L$2"+WH.Wow.getMaxPlayerLevel()+")</small>",n,"\x3c!--lvl--\x3e"));var h="";50==n&&(h="\x3c!--stat%d--\x3e"),64==n&&(o=o.substr(5),u=""),t+='<br /><span class="'+s+'">'+h+WH.sprintf(o,c>=0?"+":"-",p)+u+"</span>"}}return t+e}))}l.itemNameDescStats?.length&&(e=e.replace(/<!--nameDescStats-->/,(e=>{let t="";return l.itemNameDescStats.forEach((e=>{let a=WH.Wow.Item.getNameDescription(e.nameDescId);if(a){let n=WH.Wow.Item.getNameDescriptionColor(e.nameDescId),i=parseInt(n).toString(16);for(;i.length<6;)i="0"+i;t+=WH.sprintf('<br><span style="color: $1">$2$3 $4</span>',"#"+i,e.qty>=0?"+":"",e.qty,a)}})),t+e}))),e=e.replace(/(<!--nstart-->)(.*)(<!--nend-->)/,(function(e,t,a,n){var i=l.quality,s=l.name,o=l.nameSuffix?" "+l.nameSuffix:"";return t+WH.sprintf('<b class="q$1">$2</b>',i,s+o)+n})),e=e.replace(/(<!--ndstart-->)(.*)(<!--ndend-->)/,(function(e,t,a,n){return l.namedesc?t+"<br />"+l.namedesc+n:t+n}));var W=0|g_items[t].jsonequip.nsockets;if(!W&&l.nsockets||W&&l.nsockets>W){const t=81,a=225,n=1,i=2,s=3,o=4,c=5,d=6,p=9,u=10,h=11,g=12,f=13,m=14,H=15,E=16;e=e.replace(/<!--ps-->(<br(?: \/)?>)?/,(function(e,T){for(var v="",S=W;S<l.nsockets;++S){if(!l["socket"+(S+1)])continue;let e=l["socket"+(S+1)];var I="socket-unknown";let W=t;var y=e;switch(e){case r.SOCKET_META:I="socket-meta",W=t,y=n;break;case r.SOCKET_RED:I="socket-red",W=t,y=i;break;case r.SOCKET_YELLOW:I="socket-yellow",W=t,y=s;break;case r.SOCKET_BLUE:I="socket-blue",W=t,y=o;break;case r.SOCKET_SHA_TOUCHED:I="socket-hydraulic",W=t,y=c;break;case r.SOCKET_COGWHEEL:I="socket-cogwheel",W=t,y=d;break;case r.SOCKET_PRISMATIC:I="socket-prismatic",W=t,y=p;break;case r.SOCKET_RELIC_IRON:I="socket-relic-iron",W=a,y=64;break;case r.SOCKET_RELIC_BLOOD:I="socket-relic-blood",W=a,y=128;break;case r.SOCKET_RELIC_SHADOW:I="socket-relic-shadow",W=a,y=256;break;case r.SOCKET_RELIC_FEL:I="socket-relic-fel",W=a,y=512;break;case r.SOCKET_RELIC_ARCANE:I="socket-relic-arcane",W=a,y=1024;break;case r.SOCKET_RELIC_FROST:I="socket-relic-frost",W=a,y=2048;break;case r.SOCKET_RELIC_FIRE:I="socket-relic-fire",W=a,y=4096;break;case r.SOCKET_RELIC_WATER:I="socket-relic-water",W=a,y=8192;break;case r.SOCKET_RELIC_LIFE:I="socket-relic-life",W=a,y=16384;break;case r.SOCKET_RELIC_STORM:I="socket-relic-storm",W=a,y=32768;break;case r.SOCKET_RELIC_HOLY:I="socket-relic-holy",W=a,y=65536;break;case r.SOCKET_PUNCHCARD_RED:I="socket-red",W=t,y=u;break;case r.SOCKET_PUNCHCARD_YELLOW:I="socket-yellow",W=t,y=h;break;case r.SOCKET_PUNCHCARD_BLUE:I="socket-blue",W=t,y=g;break;case r.SOCKET_DOMINATION:I="socket-domination",W=t,y=f;break;case r.SOCKET_CRYSTALLIC:I="socket-crystallic",W=t,y=m;break;case r.SOCKET_TINKER:I="socket-tinker",W=t,y=H;break;case r.SOCKET_PRIMORDIAL:I="socket-primordial",W=t,y=E}let T=WH.Url.generatePath(WH.sprintf("/items/gems?filter=$1;$2;0",W,y));var _=WH.sprintf('<a href="'+WH.Strings.escapeHtml(T)+'" class="$1 q0">',I);_+=r.getSocketName(e)||"Unknown Socket",v+="<br>"+(_+="</a>")}return(0==W?"<br>":"")+v+"<br><br>"}))}if(a){let t=WH.Tooltips.getScalingData(WH.Types.ITEM,"bonusEffects"),n=t&&t.bonus;n&&(e=e.replace(/<!--itemEffects:(\d)-->/,(function(e,i){let s=l.extraStats&&l.extraStats.indexOf(parseInt(WH.jsonToStat.corruption))>=0,o="";for(let e,i=0;e=a[i];i++){let a=n[e]||[];for(let e,n=0;e=a[n];n++){let a=t.effect[e];a&&(s&&(a=a.replace(/\b(class=")q2\b/g,"$1stat-corruption")),o+=(o?"<br>":"")+a)}}return o+(o&&i?"<br>":"")+e})))}if(WH.applyStatModifications&&WH.convertScalingSpell.SpellInformation){for(var H,E={effects:{}},T=/(<!--pts(\d):(\d):(\d+(?:\.\d+)?):(\d+)(:\d+(?:\.\d+)?)?(:crm)?-->(?:<!--rtg\d+-->)?)(\d+(?:\.\d+)?)(<!---->(%?))?/g;null!==(H=T.exec(e));){var v=H[2],S=H[3],I=H[5];if(I<=0)continue;E[I]=E[I]||{};let e=l.scadistbonus&&13===l.scadistbonustype?g_items[t].level:l.level;WH.cO(E[I],WH.convertScalingSpell(E[I],I,v,S,i,e))}e=WH.adjustSpellPoints(e,E,l.level,g_items[t].jsonequip.slot)}let y=WH.Timewalking.getCharLevelFromIlvl(s)||0;return y&&(e=e.replace(/<!--ee(\d+):(\d+):(\d+):(\d+):(\d+):(\d+)-->([^<]*)<\/span>/gi,(function(e,t,a,n,i,s,o,r){var l={enchantment:r,scalinginfo:{scalingcategory:t,minlvlscaling:a,maxlvlscaling:n,damage1:i/1e3,damage2:s/1e3,damage3:o/1e3}};return"\x3c!--ee--\x3e"+WH.scaleItemEnchantment(l,y)+"</span>"}))),e=e.replace(/(<!--rtg%(\d+)-->)([\.,0-9]+)%?/g,(function(t,a,n,s){if(_=e.match(new RegExp("\x3c!--rtg"+n+"--\x3e([\\d\\.,]+)(-[\\d\\.,]+)?")),!_)return t;_[2]&&(_[2]=_[2].replace(/\D/,"")),_[1]=_[1].replace(/\D/,"");var o=_[2]?(Math.abs(parseInt(_[2]))+parseInt(_[1]))/2:_[1];return a+(_[2]?"~":"")+Math.round(100*WH.convertRatingToPercent(i||WH.Wow.getMaxPlayerLevel(),n,o))/100+(49!=n?"%":"")})),e=e.replace(/<!--bo-->(<br(?: \/)?>)?([^<]+)/,(function(e,t,a){return l.bond&&(a=WH.Wow.Item.getBondTypeName(l.bond)),"\x3c!--bo--\x3e"+t+a})),e=e.replace(/<!--bo-->/,(function(e){if(!a)return e;let t=WH.getPageData("wow.item.bonuses.upgrades")||{},n="";return a.some((function(e){if(t[e]){let a=WH.ce("div");return WH.ae(a,WH.ce("br")),WH.ae(a,WH.ce("span",{className:"q"},WH.ct(t[e][2]?WH.Strings.sprintf(WH.GlobalStrings.ITEM_UPGRADE_TOOLTIP_FORMAT_STRING,t[e][2],t[e][0],t[e][1]):WH.Strings.sprintf(WH.GlobalStrings.ITEM_UPGRADE_TOOLTIP_FORMAT,t[e][0],t[e][1])))),n=a.innerHTML,!0}})),n+e})),e=e.replace(/<!--ue-->/,(function(){if(!l.limitcategory)return"";let e="",t=(WH.getPageData("wow.item.bonusLimitCategoryNames")||{})[l.limitcategory];if(t){let a=t.uniqueEquipped?WH.GlobalStrings.ITEM_UNIQUE_EQUIPPABLE:WH.GlobalStrings.ITEM_UNIQUE;e=WH.Strings.escapeHtml(a+WH.TERMS.colon_punct+WH.Strings.sprintf(WH.TERMS.parens_format,t.name,t.maxCount)),e="<br />"+e}return e})),function(){var a=WH.ce("div");a.innerHTML=e,a.querySelectorAll('a[href*="/spell="]').forEach((function(e){var t=e.dataset.wowhead||"";t=t.replace(/(^|&)i?lvl=\d+/g,""),i&&(t+=(t?"&":"")+"lvl="+i),l.level&&(t+=(t?"&":"")+"ilvl="+l.level),e.dataset.wowhead=t}));let n=WH.getPageData("item.sellprice."+t),s=a.querySelector(".whtt-sellprice");if(n&&s){let e=s.firstChild;WH.ee(s),WH.ae(s,e);let t=n.itemLevel,a=t[l.level]||t[Math.max.apply(null,Object.keys(t))],i=n.quality[l.quality]||0,o=Math.floor(n.base*a*i);WH.ae(s,WH.Wow.buildMoney({copper:o}))}e=a.innerHTML}(),e},WH.setTooltipLevel=function(e,t,a){var n=typeof e;if("number"==n){var i=WH.getDataSource();if(!i[e]||!i[e][(a?"buff_":"tooltip_")+Locale.getName()])return e;e=i[e][(a?"buff_":"tooltip_")+Locale.getName()]}else if("string"!=n)return e;e=e.replace(/<!--(gem|ee)(\d+):(\d+):(\d+):(\d+):(\d+):(\d+)-->([^<]*)<\/span>/gi,(function(e,a,n,i,s,o,r,l,c){var d={enchantment:c,scalinginfo:{scalingcategory:n,minlvlscaling:i,maxlvlscaling:s,damage1:o/1e3,damage2:r/1e3,damage3:l/1e3}};return"\x3c!--"+a+"--\x3e"+WH.scaleItemEnchantment(d,t)+"</span>"}));var s,o,r=e.match(/<!--i?\?([0-9-:]*)-->/);if(r&&(s=r[1].split(":").map(Number),t=Math.min(s[2],Math.max(s[1],t)),o=s[4]||0),o)if(e.match(/<!--pts\d:\d:\d+(?:\.\d+)?:\d+-->/g)||o<0||a)if(o>0){!s[7]&&WH.isSet("g_pageInfo")&&3==g_pageInfo.type&&g_items[g_pageInfo.typeId]&&7!=g_items[g_pageInfo.typeId].quality&&(t=Math.min(g_items[g_pageInfo.typeId].reqlevel,t));var l={scadist:o};e=e.replace(/<!--cast-->\d+\.\d+/,"\x3c!--cast--\x3e"+l.cast);var c=/<!--pts([0-9-:]*)-->/g,d=c.exec(e);for(l.effects=!0;null!=d;){var p=d[1].split(":").map(Number),u=p[0],h=p[1],g=p[3];g>0&&(null==l[g]&&(l[g]={},l[g].effects={}),WH.cO(l[g],WH.convertScalingSpell(l[g],g,u,h,t,t))),d=c.exec(e)}if(l.effects){var f=5;if(window.g_pageInfo&&window.g_pageInfo.type==WH.Types.AZERITE_ESSENCE_POWER&&(f=WH.Wow.Item.INVENTORY_TYPE_NECK),e=WH.adjustSpellPoints(e,l,t,f),this.modified)for(var m in this.modified[1])for(var W=this.modified[1][m],H=0;H<W.length;++H)W[H][0]=WH.adjustSpellPoints(W[H][0],l,t,f),W[H][1]=WH.adjustSpellPoints(W[H][1],l,t,f)}}else for(var E=-o,T=WH.getSpellScalingValue(E,t),v=0;v<3;++v){var S=s[5+v]/1e3;e=e.replace(new RegExp("\x3c!--gem"+(v+1)+"--\x3e(.+?)<"),"\x3c!--gem"+(v+1)+"--\x3e"+Math.round(T*S)+"<")}else e=WH.setItemModifications(e,s[0],null,null,t),WH.updateItemStringLink.call(this);return e=e.replace(/<!--ppl(\d+):(\d+):(\d+):(\d+):(\d+)(?::(1))?-->\s*\d+/gi,(function(e,a,n,i,s,o,r){return"\x3c!--ppl"+a+":"+n+":"+i+":"+s+":"+o+"--\x3e"+(r?Math.ceil:Math.floor)(parseInt(s)+(Math.min(Math.max(t,n),i)-n)*o/100)})),e=e.replace(/(<!--rtg%(\d+)-->)([\.0-9]+)%?/g,(function(a,n,i,s){return _=e.match(new RegExp("\x3c!--rtg"+i+"--\x3e(\\d+)")),_?n+Math.round(100*WH.convertRatingToPercent(t,i,_[1]))/100+(49!=i?"%":""):a})),e=e.replace(/<!--pl(\d+):(\d+):(\d+)-->\s?(\d+)/gi,(function(e,a,n,i,s){return"\x3c!--pl"+a+":"+n+":"+i+"--\x3e"+(t=Math.min(t,WH.Wow.getMaxPlayerLevel()))})),e=(e=e.replace(/(<!--i?\?\d+:\d+:\d+:)\d+/g,"$1"+t)).replace(/<!--lvl-->\d+/g,"\x3c!--lvl--\x3e"+t)},WH.updateTooltipSingular=function(e){return e.replace(/(\d+)(\D*)<!--singular:(.*?):(.*?)-->.*?<!--singular-->/gi,(function(e,t,a,n,i){return t+a+"\x3c!--singular:"+n+":"+i+"--\x3e"+(1===parseInt(t)?n:i)+"\x3c!--singular--\x3e"}))},WH.getSpellScalingValue=function(e,t){var a=WH.convertScalingSpell?WH.convertScalingSpell.SV:null;return a?a[t][e-1]:0},WH.adjustSpellPoints=function(e,t,a,n){var i=1;a&&n&&(i=WH.getCombatRatingMult(a,n));for(var s=1;s<=20;++s)e=e.replace(new RegExp("\x3c!--pts"+s+":0:0:(\\d+)(:\\d+(?:\\.\\d+)?)?(:crm)?--\x3e(\x3c!--rtg\\d+--\x3e)?(.+?)<","g"),(function(e,a,n,o,r){var l=t[a]&&t[a].hasOwnProperty("effects")?t[a].effects[s]:t.effects[s];if(!l)return e;var c=Math.round(l.avg*(o?i:1));return"\x3c!--pts"+s+":0:0:"+a+(n||"")+(o||"")+"--\x3e"+(r||"")+c+"<"})),e=e.replace(new RegExp("\x3c!--pts"+s+":1:0:(\\d+)(:\\d+(?:\\.\\d+)?)?(:crm)?--\x3e(\x3c!--rtg\\d+--\x3e)?(.+?)<","g"),(function(e,a,n,o,r){var l=t[a]&&t[a].hasOwnProperty("effects")?t[a].effects[s]:t.effects[s];if(!l)return e;var c=Math.round(l.min*(o?i:1));return"\x3c!--pts"+s+":1:0:"+a+(n||"")+(o||"")+"--\x3e"+(r||"")+c+"<"})),e=e.replace(new RegExp("\x3c!--pts"+s+":2:0:(\\d+)(:\\d+(?:\\.\\d+)?)?(:crm)?--\x3e(\x3c!--rtg\\d+--\x3e)?(.+?)<","g"),(function(e,a,n,o,r){var l=t[a]&&t[a].hasOwnProperty("effects")?t[a].effects[s]:t.effects[s];if(!l)return e;var c=Math.round(l.max*(o?i:1));return"\x3c!--pts"+s+":2:0:"+a+(n||"")+(o||"")+"--\x3e"+(r||"")+c+"<"})),e=e.replace(new RegExp("\x3c!--pts"+s+":3:(\\d+(?:\\.\\d+)?):(\\d+)(:\\d+(?:\\.\\d+)?)?(:crm)?--\x3e(\x3c!--rtg\\d+--\x3e)?(.+?)<","g"),(function(e,a,n,o,r,l){var c=t[n]&&t[n].hasOwnProperty("effects")?t[n].effects[s]:t.effects[s];if(!c)return e;var d=Math.round(c.avg*a*(r?i:1));return"\x3c!--pts"+s+":3:"+a+":"+n+(o||"")+(r||"")+"--\x3e"+(l||"")+d+"<"})),e=e.replace(new RegExp("\x3c!--pts"+s+":4:0:(\\d+)(:\\d+(?:\\.\\d+)?)?(:crm)?--\x3e(\x3c!--rtg\\d+--\x3e)?(.+?)<","g"),(function(e,a,n,o,r){var l=t[a]&&t[a].hasOwnProperty("effects")?t[a].effects[s]:t.effects[s];if(!l)return e;var c=Math.round(l.pts*(o?i:1));return"\x3c!--pts"+s+":4:0:"+a+(n||"")+(o||"")+"--\x3e"+(r||"")+c+"<"}));return e},WH.getStaminaRatingMult=function(e,t){if(!WH.staminaFactor)return 1;let a=0;switch(t){case 2:case 11:a=3;break;case 12:a=2;break;case 13:case 14:case 15:case 17:case 21:case 22:case 23:case 25:case 26:a=1}let n=WH.findSparseKey(WH.staminaFactor,e),i=WH.findSparseKey(WH.staminaFactor[n]||{},a);return(WH.staminaFactor[n]||{})[i]||1},WH.getCombatRatingMult=function(e,t){if(!WH.convertRatingToPercent.RM)return 1;let a=0;switch(t){case 2:case 11:a=3;break;case 12:a=2;break;case 13:case 14:case 15:case 17:case 21:case 22:case 23:case 25:case 26:a=1}let n=WH.findSparseKey(WH.convertRatingToPercent.RM,e),i=WH.findSparseKey(WH.convertRatingToPercent.RM[n]||{},a);return(WH.convertRatingToPercent.RM[n]||{})[i]||1},WH.roundArtifactPower=function(e){var t=1;return e>50&&(t=5),e>1e3&&(t=25),e>5e3&&(t=50),WH.roundHalfEven(e/t)*t},WH.roundHalfEven=function(e){if(Math.floor(1e5*e)%1e5==5e4){var t=Math.floor(e);return t+t%2}return Math.round(e)},WH.setTooltipSpells=function(e,t,a,n,i=0){if(a=a||{},(t=t||[]).length){let e=window.g_pageInfo?g_pageInfo.typeId:null;if(e){let a=t.indexOf(parseInt(e));-1!==a&&(t[a]=0)}}else t=[0];if(void 0===n){var s=function(e){var t=[];e.hasOwnProperty("data")&&t.push(e.data);for(var a=0;a<e.children.length;a++)t=t.concat(s(e.children[a]));return t};for(let e in a)if(a.hasOwnProperty(e)&&!(a[e].length<2)){for(var o=0;o<a[e].length;o++){a[e][o]={data:a[e][o],children:[]};for(var r=0,l=0;l<=1;l++)for(var c=-1;(c=a[e][o].data[l].indexOf("\x3c!--sp"+e+"--\x3e",c+1))>=0;)r++;var d=o-r;if(!(d<0))for(;r-- >0;){var p=a[e].splice(d,1);o--,a[e][o].children.push(p[0])}}a[e]=s({children:a[e]})}}n=n||{};for(var u,h=function(e){n[e]=(n[e]||0)+1,n[e]>=(a[e]||[]).length&&(n[e]=0)},g=[],f=/<!--sp([0-9]+):[01]-->/g;u=f.exec(e);){var m=u[0],W=u.index+m.length,H="\x3c!--sp"+u[1]+"--\x3e",E=e.indexOf(H,W);if(E<0)return WH.warn("Could not find closing end tag for tooltip spell.",H,e),e;var T=new RegExp("\x3c!--sp"+u[1]+":[01]--\x3e","g");T.lastIndex=W;for(var v=T.exec(e);v&&v.index<E;){if((E=e.indexOf(H,E+H.length))<0)return WH.warn("Could not find nested closing end tag for tooltip spell.",H,e),e;v=T.exec(e)}g.push(e.substring(u.index,E+H.length)),f.lastIndex=E+H.length}for(var S=0,I=/^(<!--sp([0-9]+):[01]-->).*(<!--sp\2-->)$/,y=0;y<g.length;++y){var _=g[y].match(I)[2],b=WH.inArray(t,parseInt(_))>=0?1:0;if(null!=a[_]){null==n[_]&&(n[_]=0);var w=a[_][n[_]];if(null!=w&&null!=w[b]){h(_),b&&(u=w[2].match(/^(!?)(\d+)$/))&&(u[1]?WH.inArray(t,parseInt(u[2]))>=0&&(b=0):t.push(parseInt(u[2])));var A=w[b],L="\x3c!--sp"+_+":"+b+"--\x3e"+(A=WH.setTooltipSpells(A,t,a,n,i+1))+"\x3c!--sp"+_+"--\x3e";if(S=(e=e.substr(0,S)+e.substr(S).replace(g[y],L)).indexOf(L,S)+L.length,b)for(var C=y+1;C<g.length&&e.indexOf(g[C],S)===S;C++)L=(u=g[C].match(I))[1]+u[3],e=e.substr(0,S)+e.substr(S).replace(g[C],L),h(u[2]),S+=L.length,y++}}}return e=WH.Tooltips.evalFormulas(e,i)},WH.enhanceTooltip=function(e,t,a,n,i,s,o,r,l,c,d,p,u){if((!WH.applyStatModifications||!WH.applyStatModifications.ScalingData)&&(u||r))return g_itemScalingCallbacks.push(function(h){return function(){var g=WH.enhanceTooltip.call(h,e,t,a,n,i,s,o,r,l,c,d,p,u);WH.updateTooltip.call(h,g)}}(this)),WH.TERMS.loading_ellipsis;var h,g,f=typeof e,m=WH.getDataSource(),W=WH.isSet("g_pageInfo")?g_pageInfo.type:null;if(g=WH.isSet("g_pageInfo")?g_pageInfo.typeId:null,this._spellModifiers=s,"number"==f){var H="tooltip_";if(i&&(H="buff_"),d&&(H="tooltip_premium_"),p&&(H="text_"),!m[g=e]||!m[g][H+Locale.getName()])return e;e=m[g][H+Locale.getName()],h=m[g][(i?"buff":"")+"spells_"+Locale.getName()],this._rppmModList=m[g].rppmmod,h&&(e=WH.setTooltipSpells(e,s,h))}else if("string"!=f)return e;let E,T;if(a){var v=WH.getGets();if(v.lvl)T=Math.min(v.lvl,WH.Wow.getMaxPlayerLevel()),e=WH.setTooltipLevel(e,T,i);else{let e=WH.Wow.Season.MAX_LEVEL_BY_PHASE[WH.getDataEnv()]?.[WH.Wow.Season.getCurrentPhase()];e&&(T=e)}T&&(e=WH.setTooltipLevel(e,T,i)),E=v.ilvl}let S,I=WH.parseQueryString(WH.getQueryString()),y=function(){return I["crafted-stats"]?I["crafted-stats"].split(":").map((function(e){return parseInt(e)})).filter((function(e){return WH.Wow.Item.Stat.CRAFTING_STAT_TO.includes(e)})):[]},_=y();if((u||r||_.length)&&g&&(e=WH.setItemModifications(e,g,u,r,this._selectedLevel?this._selectedLevel:null,E,_)),t&&(e=e.replace(/\(([^\)]*?<!--lvl-->[^\(]*?)\)/gi,(function(e,t){return'(<a href="javascript:" onmousedown="return false" class="tip" style="color: white; cursor: pointer" onclick="WH.staticTooltipLevelClick(this, null, 0)" onmouseover="WH.Tooltips.showAtCursor(event, \'<span class=\\\'q2\\\'>\' + WH.TERMS.clicktochangelevel_stc + \'</span>\')" onmousemove="WH.Tooltips.cursorUpdate(event)" onmouseout="WH.Tooltips.hide()">'+t+"</a>)"})),e.indexOf("\x3c!--artpow:")>0)){if(!this.hasOwnProperty("_knowledgeLevel")){var b=/(&|\?)artk=(\d+)/.exec(location.href);b&&parseInt(b[2])<=g_artifact_knowledge_max_level&&(this._knowledgeLevel=parseInt(b[2]))}var w=this._knowledgeLevel?parseInt(this._knowledgeLevel):0;e=e.replace(/(<!--ndstart-->)?<!--ndend-->/i,(function(e,t){return(t?t+"<br />":" ")+'<a href="javascript:" onmousedown="return false" class="tip" style="color: white; cursor: pointer" onclick="WH.staticTooltipKnowledgeLevelClick(this, null, '+g+')" onmouseover="WH.Tooltips.showAtCursor(event, \'<span class=\\\'q2\\\'>\' + WH.TERMS.clicktochangelevel_stc + \'</span>\')" onmousemove="WH.Tooltips.cursorUpdate(event)" onmouseout="WH.Tooltips.hide()">'+WH.sprintf(WH.TERMS.knowledge_format.replace("%d","$1"),w)+"</a>"})),e=e.replace(/(<!--artpow:(\d+)-->)[\d\.\,]+/,(function(e,t,a){return t+WH.numberLocaleFormat(WH.roundArtifactPower(parseInt(a)*WH.getArtifactKnowledgeMultiplier(w)))}))}if(n&&Slider){var A=WH.groupSizeScalingShouldShow(g);if(i)i.bufftip=this,A&&WH.isSet("g_difficulties")&&g_difficulties[A]&&(e=WH.groupSizeScalingOnChange.call(i,this,g_difficulties[A].maxplayers,1,!0));else{var L=new RegExp("\x3c!--"+(W&&3==W?"i":"")+"\\?(\\d+):(\\d+):(\\d+):(\\d+)"),C=e.match(L);if(void 0===C&&3==W&&(L=new RegExp("\x3c!--\\?(\\d+):(\\d+):(\\d+):(\\d+)"),C=e.match(L)),!C&&!WH.isRetailTree()){L=new RegExp("\x3c!--ppl(\\d+):(\\d+):(\\d+):(\\d+):(\\d+)");let t=e.match(L);t&&(C=[null,null,t[2],WH.Wow.getMaxPlayerLevel(),T??WH.Wow.getMaxPlayerLevel()])}if(!C){L=new RegExp("\x3c!--pl(\\d+):(\\d+):(\\d+)--\x3e\\s?(\\d+)");let t=e.match(L);t&&(C=[null,null,t[2],t[3],T??t[4]])}if(A&&WH.isSet("g_difficulties")&&g_difficulties[A]){var R=WH.ce("label");R.innerHTML=WH.TERMS.difficulty+": ",this._difficultyBtn=WH.ce("a"),this._difficultyBtn.ttId=g,WH.difficultyBtnBuildMenu.call(this,g),Menu.add(this._difficultyBtn,this._difficultyBtn.menu);let t=WH.ge("dd"+g);WH.ae(t,R),WH.ae(t,this._difficultyBtn),t.style.display="block",WH.difficultyBtnOnChange.call(this,m[g].initial_dd||A,m[g].initial_ddSize),e=WH.groupSizeScalingOnChange.call(this,this,g_difficulties[A].maxplayers,0,!0)}else C&&C[2]!=C[3]&&(this.slider=Slider.init(n,{maxValue:parseInt(C[3]),minValue:Math.max(parseInt(C[2]),1),onMove:WH.tooltipSliderMove.bind(this),title:WH.GlobalStrings.LEVEL}),n.style.display="block",Slider.setValue(this.slider,parseInt(C[4])),this.slider.onmouseover=function(e){WH.Tooltips.showAtCursor(e,WH.TERMS.dragtochangelevel_stc,"q2")},this.slider.onmousemove=WH.Tooltips.cursorUpdate,this.slider.onmouseout=WH.Tooltips.hide,WH.Tooltips.attach(Slider.getInput(this.slider),WH.TERMS.clicktochangelevel_stc,"q2"))}}if(o&&!o.dataset.initialized){if(i&&i.modified)i.bufftip=this;else{let e=WH.getPageData("WH.Wow.Covenant.data");for(let t in h){let a=Object.keys(e).find((a=>e[a].spellId===parseInt(t)));if((!WH.Gatherer.get(WH.Types.SPELL,t)||s.includes(t))&&!a)continue;let n=WH.Gatherer.get(WH.Types.SPELL,t),i=n["name_"+Locale.getName()],r=n["rank_"+Locale.getName()]||"",l=r?WH.term("parens_format",i,r):i,c=WH.ce("label"),d=WH.ce("input",{type:"checkbox",dataset:{spellId:t}});WH.ae(c,d),WH.aE(d,"click",WH.tooltipSpellsChange.bind(this));let p=WH.ce("a",void 0,WH.ct(l));a?p.classList.add("covenant-"+WH.Wow.Covenant.getSlug(a)):(p.href=WH.Entity.getUrl(WH.Types.SPELL,t,i),WH.aE(p,"click",(function(e){e.preventDefault(),d.click()}))),WH.ae(c,p),c.setAttribute("unselectable",""),WH.ae(o,c),WH.ae(o,WH.ce("br"))}}WH.onLoad((()=>{let e=e=>{let t=WH.qs(`.tooltip-options #ks${g} input[type="checkbox"][data-spell-id="${e}"]`);t&&(t.checked=!0)},t=WH.Url.parseQueryString(location.search);if(t.covenant){let a=((WH.getPageData("WH.Wow.Covenant.data")||{})[t.covenant]||{}).spellId;a&&e(a)}t.spellModifier&&t.spellModifier.split(":").forEach((t=>{e(t)})),WH.tooltipSpellsChange.call(this)})),this.modified=[o,h,s],o.style.display=WH.DOM.isEmpty(o)?"none":"inline-block",o.dataset.initialized="true"}if(c){var M=e.match(/<!--rppm-->(\d+(?:\.\d+)?)<!--rppm-->/);if(M){var N=$("#rppm"+g);if(this._rppmModList.hasOwnProperty(4))if(this._rppmModBase=parseFloat(M[1]),N.is(":empty"))for(var O in this._rppmSpecModList=this._rppmModList[4],this._rppmSpecModList.splice(0,0,{spec:-1,modifiervalue:0,filename:""}),N.append(WH.getMajorHeading(WH.TERMS.realppmmodifiers,2,3)),this._rppmSpecModList){var D=Icon.create(this._rppmSpecModList[O].filename,0,null);D.style.display="inline-block",D.style.verticalAlign="middle";var P=$('<input name="rppmmod" type="radio" id="rppm-'+O+'" />');P.get(0).checked=-1==this._rppmSpecModList[O].spec,N.append(P).append(-1==this._rppmSpecModList[O].spec?"":D).append('<label for="rppm-'+O+'"> <a>'+(-1==this._rppmSpecModList[O].spec?WH.TERMS.none:WH.Wow.PlayerClass.Specialization.getName(this._rppmSpecModList[O].spec))+"</a></label>").append("<br />");var x=this;$("#rppm-"+O).change((function(){WH.tooltipRPPMChange.call(this,x)}))}else{var k=this._rppmModBase,B=this._rppmSpecModList;e=e.replace(/<!--rppm-->(\[?)(\d+(?:\.\d+)?)([^<]*)<!--rppm-->/,(function(e,t,a,n){return"\x3c!--rppm--\x3e"+t+(k*(1+parseFloat(B[$('input[name="rppmmod"]:checked',N).attr("id").match(/\d+$/)[0]].modifiervalue))).toFixed(2)+n+"\x3c!--rppm--\x3e"}))}N.toggle(!N.is(":empty"));var F="";this._rppmModList.hasOwnProperty(1)?F+=" + "+WH.Wow.Item.Stat.jsonToAbbr("hastertng"):this._rppmModList.hasOwnProperty(2)&&(F+=" + "+WH.Wow.Item.Stat.jsonToAbbr("critstrkrtng")),6==g_pageInfo.type&&this._rppmModList.hasOwnProperty(6)&&(F+=" + Budget"),F.length>0&&(e=e.replace(/<!--rppm-->\[?(\d+(?:\.\d+)?)([^<]*)<!--rppm-->/,(function(e,t,a){return"\x3c!--rppm--\x3e["+t+F+"]"+a+"\x3c!--rppm--\x3e"})))}}if(l){m[g]&&m[g].hasOwnProperty("tooltip_"+Locale.getName()+"_pvp")&&($(l).append('<input type="checkbox" id="item-upgrade-pvp" />').append('<label for="item-upgrade-pvp"><a>'+WH.TERMS.pvpmode+"</a></label>").append("<br />"),$("#item-upgrade-pvp").change(WH.upgradeItemTooltip.bind(this,l,"pvp")));let e=WH.Timewalking.getConfigs();if(e.length>0){let t=WH.ce("span",void 0,WH.ct(WH.TERMS.timewalkingScaling));WH.Tooltips.attach(t,WH.TERMS.timewalkingScaling_tip,"q");let a=WH.ce("label",void 0,[t,WH.ct(WH.TERMS.colon_punct)]),n=WH.ce("a",void 0,WH.ct(WH.TERMS.none));WH.ae(l,a),WH.ae(l,n);let i=[];i.push(Menu.createItem({label:WH.TERMS.none,url:()=>{delete l.dataset.selected,WH.upgradeItemTooltip.bind(this,l,void 0,!0)(),WH.st(n,WH.TERMS.none)},options:{checkedFunc:()=>!l.dataset.selected}})),e.forEach((e=>{let t=`tooltip_${Locale.getName()}_${e.stringId}`;if(!m[g]||!m[g].hasOwnProperty(t))return;let a=WH.Wow.Expansion.getName(e.id);i.push(Menu.createItem({label:a,crumb:e.stringId,url:()=>{l.dataset.selected!==e.stringId&&(delete l.dataset.selected,l.dataset.selected=e.stringId,WH.upgradeItemTooltip.bind(this,l,e.stringId,!0)(),WH.st(n,a))},options:{checkedFunc:()=>e.stringId===l.dataset.selected,className:`item-upgrade-${e.stringId}`}})),$(l).toggle(!$(l).is(":empty"))})),Menu.add(n,i)}}if(3==W){var U=$("#cs"+g);if(U&&WH.Wow.Item.tooltipHasSpecStats(e)){if(!this._classSpecBtn){var G=WH.ce("label");G.innerHTML=WH.TERMS.showingtooltipfor_stc+" ",this._classSpecBtn=WH.ce("a"),this._classSpecBtn.ttId=g,WH.classSpecBtnBuildMenu.call(this,!!m[g].hasOwnProperty("validMenuSpecs")&&m[g].validMenuSpecs),Menu.add(this._classSpecBtn,this._classSpecBtn.menu),U.append(G).append(this._classSpecBtn).show()}S=WH.LocalStorage.get(WH.LocalStorage.KEY_WOW_DATABASE_SPEC_FILTER),"object"!=typeof S&&(S=null);var q=/(&|\?)class=(\d+)/.exec(location.href);q&&(S={classId:parseInt(q[2]),specId:0});var z,j,Y=/(&|\?)spec=(\d+)/.exec(location.href);Y&&(z=parseInt(Y[2]),(j=WH.Wow.PlayerClass.getBySpec(z))&&(S={classId:j,specId:z})),S?e=WH.classSpecBtnOnChange.call(this,S.classId,S.specId,e,!0):$(this._classSpecBtn).text(WH.isRetailTree()?WH.TERMS.chooseaspec_stc:WH.TERMS.chooseAClass_stc)}}W===WH.Types.ITEM&&m[g]&&WH.Page.WowItem.initBonuses(this,u),function(){let e=WH.ge("craftedStatsSelector"+g);if(!m[g]||!e||e.dataset.initialized)return;const t=this;let a,n=0,i=function(e){let t=y(),a=t.indexOf(e);if(a>=0?t.splice(a,1):(t.push(e),t=t.slice(-1*n)),WH.Url.replacePageQuery((function(e){t.length?e["crafted-stats"]=t.join(":"):delete e["crafted-stats"]})),s(),m[g]["tooltip_"+Locale.getName()]){let e=this._bonusesBtn&&this._bonusesBtn.selectedBonus?this._bonusesBtn.selectedBonus:null,t=WH.enhanceTooltip.call(this,g,!0,!0,!1,null,this._spellModifiers,WH.ge("ks"+g),r,null,!0,null,null,e);WH.updateTooltip.call(this,t)}},s=function(){let e="",t=y();t.length?t.forEach((function(t){e+=(e?" + ":"")+WH.Wow.Item.Stat.jsonToDesc(WH.statToJson[t])})):e=WH.TERMS.none,WH.st(a,e)};e.dataset.initialized=1;let o=m[g].jsonequip&&m[g].jsonequip.statsInfo||{};if(WH.Wow.Item.Stat.CRAFTING_STAT_FROM.forEach((function(e){o.hasOwnProperty(e)&&n++})),!n)return;WH.displayDefault(e),WH.ae(e,WH.ce("label",{},WH.ct(WH.TERMS.optionalReagentStats+WH.TERMS.colon_punct))),a=WH.ce("a",{},WH.ct(WH.TERMS.none)),WH.ae(e,a);let l=[];WH.Wow.Item.Stat.CRAFTING_STAT_TO.forEach((function(e){l.push(Menu.createItem({crumb:e,label:WH.Wow.Item.Stat.jsonToDesc(WH.statToJson[e]),url:i.bind(t,e),options:{checkedFunc:function(e){return y().includes(parseInt(e[Menu.ITEM_CRUMB]))}}}))})),l.sort((function(e,t){return e[Menu.ITEM_LABEL].localeCompare(t[Menu.ITEM_LABEL])})),Menu.add(a,l),s()}.call(this);let K=this.slider?this.slider._max:WH.Wow.getMaxPlayerLevel(),V=this._selectedLevel||K,Q=S?S.classId:WH.Wow.PlayerClass.WARRIOR;return e=WH.addRatingPercent(e,V,K,Q),W===WH.Types.ITEM&&WH.updateItemStringLink.call(this),e=WH.updateTooltipSingular(e),I.spec&&(e=WH.Tooltips.parseItemEffectTooltipForSpec(e,parseInt(I.spec))),e},WH.addRatingPercent=function(e,t,a,n){let i=WH.ce("div",{innerHTML:e});return WH.qsa("span",i).forEach((function(e){let i,s;if(e.childNodes.forEach((function(e){if(e.nodeType===Node.COMMENT_NODE){let t=(e.nodeValue||"").match(/^rtg(\d+)$/);t&&(i=parseInt(t[1]),s=e)}})),void 0===i)return;let o=s.nextSibling.nodeValue.match(/(\d+)(.*)$/);if(!o)return;let r=WH.qs("small.rating-percent");r&&WH.de(r);let l=parseInt(o[0]),c=o[2],d=WH.convertRatingToPercent(t,i,l,n),p=WH.TERMS?WH.term("valueAtLevel_format",d.toFixed(2),t):" ("+d.toFixed(2)+"% @ L"+t+")",u=s.nextSibling,h=WH.ce("small",{className:"rating-percent"},WH.ct(p));"."===c?(u.parentNode.insertBefore(WH.ct(l),u),u.parentNode.insertBefore(h,u),u.parentNode.insertBefore(WH.ct("."),u)):(u.parentNode.insertBefore(WH.ce("span",null,WH.ct(l+c)),u),u.parentNode.insertBefore(h,u)),u.parentNode.removeChild(u),h.setAttribute("onclick","WH.tooltipLevelPrompt("+t+", "+a+");")})),i.innerHTML},WH.tooltipLevelPrompt=function(e,t){let a=prompt(WH.sprintf(WH.TERMS.ratinglevel_format,1,t),e.toString());if(null===a)return;if(a=parseInt(a),a<1||a>t)return void alert("Invalid value; must be between 1 and "+t+".");let n=WH.qs(".wowhead-tooltip");n.slider&&Slider.setValue(n.slider,a),WH.staticTooltipLevelClick(n,a,1)},WH.groupSizeScalingShouldShow=function(e){return!!(WH.isSet("g_difficulties")&&WH.isSet("g_spells")&&g_spells[e]&&g_spells[e].difficulties&&g_spells[e].difficulties.length>0)&&g_spells[e].difficulties[0]},WH.groupSizeScalingSliderMove=function(e,t,a){var n=WH.getDataSource(),i=WH.isSet("g_pageInfo")?g_pageInfo.typeId:null;if(!n[i])return;let s=this._difficultyBtn.selectedDD,o=a.value;WH.Url.replacePageQuery((function(e){s!=WH.groupSizeScalingShouldShow(i)||o!=g_difficulties[WH.groupSizeScalingShouldShow(i)].maxplayers?(e.dd=s,e.ddsize=o):(delete e.dd,delete e.ddsize)})),WH.groupSizeScalingOnChange.call(this,this,a.value,0),this.bufftip&&WH.groupSizeScalingOnChange.call(this,this.bufftip,a.value,1),WH.Tooltips.hide()},WH.groupSizeScalingOnChange=function(e,t,a,n){const i=this;for(;-1==e.className.indexOf("tooltip");)e=e.parentNode;if(t=parseInt(t),!isNaN(t)){var s=WH.getDataSource(),o=WH.isSet("g_pageInfo")?g_pageInfo.typeId:null;if(s[o]){var r=this._difficultyBtn.selectedDD,l=Locale.getName(),c="server_"+(a?"buff_":"tooltip_")+l,d="dd"+r+"ddsize"+t;if(WH.groupSizeScalingOnChange.lastCall=d,!s[o][c]){s[o]["server_tooltip_"+l]={},s[o]["server_buff_"+l]={};var p="dd"+s[o].initial_dd+"ddsize"+s[o].initial_ddSize;s[o]["server_tooltip_"+l][p]=s[o]["tooltip_"+l],s[o]["server_buff_"+l][p]=s[o]["buff_"+l]}if(s[o][c][d]){var u=s[o][c][d];return n?u:void WH.updateTooltip.call(e,u)}if(n)return s[o][c.substr(7)];if(!a&&!s[o][c].hasOwnProperty(d)){s[o][c][d]="";var h=WH.Entity.getUrl(WH.Types.SPELL,o)+"?dd="+r+"&ddsize="+t;(WH.isBeta()||WH.isPtr()||WH.isPtr2())&&(h+="&"+WH.getDataCacheVersion()),WH.xhrJsonRequest(h,(function(a){a&&(s[o]["server_tooltip_"+l][d]=a.tooltip,s[o]["server_buff_"+l][d]=a.buff,WH.groupSizeScalingOnChange.lastCall===d&&(WH.groupSizeScalingOnChange.call(i,e,t),i.bufftip&&WH.groupSizeScalingOnChange.call(i,i.bufftip,t,!0)))}))}}}},WH.difficultyBtnBuildMenu=function(e){for(var t=[],a=g_spells[e],n=0;n<a.difficulties.length;++n){var i=a.difficulties[n],s=[i,WH.Wow.Difficulty.getName(i),WH.difficultyBtnOnChange.bind(this,i,!1)];t.push(s)}this._difficultyBtn.menu=t},WH.difficultyBtnOnChange=function(e,t){this._difficultyBtn.selectedDD=e,$(this._difficultyBtn).text(""),WH.arrayWalk(this._difficultyBtn.menu,(function(e){e.checked=!1}));var a=Menu.findItem(this._difficultyBtn.menu,[e]);a.checked=!0,$(this._difficultyBtn).text(a[Menu.ITEM_LABEL]);var n=this._difficultyBtn.selectedPlayers||t,i=g_difficulties[e].minplayers,s=g_difficulties[e].maxplayers,o=g_difficulties[e].maxplayers;n&&(o=n>s?s:n<i?i:n),i=s;var r=$("#sl"+this._difficultyBtn.ttId);r.html("").hide(),this.slider=null,i!=s&&(r.show(),this.slider=Slider.init(r.get(0),{maxValue:parseInt(s),minValue:parseInt(i),onMove:WH.groupSizeScalingSliderMove.bind(this),title:WH.TERMS.players}),Slider.setValue(this.slider,parseInt(o)),this.slider.onmouseover=function(e){WH.Tooltips.showAtCursor(e,WH.TERMS.dragtochangeplayers_stc,"q2")},this.slider.onmousemove=WH.Tooltips.cursorUpdate,this.slider.onmouseout=WH.Tooltips.hide,WH.Tooltips.attach(Slider.getInput(this.slider),WH.TERMS.clicktochangeplayers_stc,"q2")),WH.groupSizeScalingSliderMove.call(this,null,null,{value:o})},WH.classSpecBtnOnChange=function(e,t,a,n){const i=WH.LocalStorage;e=parseInt(e),t=t?parseInt(t):null,WH.ee(this._classSpecBtn),this._classSpecBtn.selectedSpec=t;let s=Menu.findItem(this._classSpecBtn.menu,[e,t]);if(s&&s[Menu.ITEM_OPTIONS]&&s[Menu.ITEM_OPTIONS].tinyIcon){let e=s[Menu.ITEM_OPTIONS].tinyIcon,t=WH.Icon.create(e,WH.Icon.SMALL,"javascript:");t.style.display="inline-block",t.style.verticalAlign="middle",WH.ae(this._classSpecBtn,t)}let o=WH.Wow.PlayerClass.Specialization.getName(t);WH.ae(this._classSpecBtn,WH.ce("span",void 0,WH.ct(" "+(WH.isRetailTree()&&o?WH.Strings.sprintf(WH.TERMS.specclass_format,o,WH.Wow.PlayerClass.getName(e)):WH.Wow.PlayerClass.getName(e))))),n||i.set(i.KEY_WOW_DATABASE_SPEC_FILTER,{classId:e,specId:t});var r=a||this.innerHTML;return r=r.replace(/<!--scstart(\d+):(\d+)--><span class="q(\d+)">(<!--asc\d+-->)?(.*?)<\/span><!--scend-->/i,(function(t,a,n,i,s,o){i=1;var r=2==a&&(!g_classes_allowed_weapon[e]||-1==WH.inArray(g_classes_allowed_weapon[e],n)),l=4==a&&(!g_classes_allowed_armor[e]||-1==WH.inArray(g_classes_allowed_armor[e],n));return(r||l)&&(i=10),"\x3c!--scstart"+a+":"+n+'--\x3e<span class="q'+i+'">'+(s||"")+o+"</span>\x3c!--scend--\x3e"})),WH.isRetailTree()&&(r=r.replace(/<span[^>]*?><!--stat(\d+)-->([-+][\d\.,]+(?:-[\d\.,]+)?)(\D*?)<\/span>/gi,(function(a,n,i,s){let o=WH.ce("div",{innerHTML:a}),r=WH.qs("span",o);r.classList.remove("q0","q2"),50===(n=parseInt(n))&&r.classList.add("q2"),g_grayedOutStats[n]&&-1!=g_grayedOutStats[n].indexOf(t)&&(r.classList.remove("q2"),r.classList.add("q0"));let l=t?WH.getStatForSpec(n,t):WH.getStatForClass(n,e);if(l!==n&&WH.statToJson[l]){let e=WH.Wow.Item.Stat.jsonToName(WH.statToJson[l]);e&&(s=" "+e)}return r.innerHTML="\x3c!--stat"+n+"--\x3e",WH.ae(r,WH.ct(i+s)),r.outerHTML})),r=r.replace(/(<!--traitspecstart:(\d+)(?::(\d+))?-->)[\w\W]*?(<!--traitspecend-->)/g,(function(e,a,n,i,s){var o="";return WH.isSet("g_pageInfo")&&g_pageInfo.hasOwnProperty("typeId")&&3==g_pageInfo.type&&g_items.hasOwnProperty(g_pageInfo.typeId)&&g_items[g_pageInfo.typeId].hasOwnProperty("affectsArtifactPowerTypesData")&&g_items[g_pageInfo.typeId].affectsArtifactPowerTypesData.hasOwnProperty(n)&&g_items[g_pageInfo.typeId].affectsArtifactPowerTypesData[n].hasOwnProperty(t)?o=g_items[g_pageInfo.typeId].affectsArtifactPowerTypesData[n][t]:i&&(o='<span style="color: #00FF00">'+WH.term("relicrank"+(1!=i?"s":"")+"increase_format",i)+": </span>"+WH.TERMS.relic_minortrait),a+o+s}))),t&&(r=WH.Tooltips.parseItemEffectTooltipForSpec(r,t)),WH.Url.replacePageQuery((function(a){e?a.class=e:delete a.class,WH.isRetailTree()&&t?a.spec=t:delete a.spec})),a||(this.innerHTML=WH.Tooltips.evalFormulas(r)),r},WH.classSpecBtnBuildMenu=function(e){const t=WH.Wow.PlayerClass,a=WH.Wow.PlayerClass.Specialization,n=WH.isRetailTree();let i=[Menu.createHeading({label:n?WH.TERMS.chooseaspec_stc:WH.TERMS.chooseAClass_stc})];e&&(e=e.map((e=>parseInt(`${e}`)))),t.getAll().forEach((s=>{const o=Menu.createItem({crumb:`${s}`,label:t.getName(s),options:{className:"c{$classId}",tinyIcon:t.getIconName(s)}});if(n){const t=[];a.getByClass(s).forEach((n=>{const i=!e||e.includes(n),o=Menu.createItem({crumb:`${n}`,label:a.getName(n),url:i?WH.classSpecBtnOnChange.bind(this,s,n,!1):"javascript:",options:i?{tinyIcon:a.getIconName(n)}:{className:"q0"}});t.push(o)})),Menu.setSubmenu(o,t)}else Menu.setItemUrl(o,WH.classSpecBtnOnChange.bind(this,s,0,!1));i.push(o)})),this._classSpecBtn.menu=i},WH.getStatForClass=function(e,t){let a,n=WH.Wow.PlayerClass.Specialization.getByClass(t)||[];for(let t,i=0;t=n[i];i++){let n=WH.getStatForSpec(e,t);if(void 0===a)a=n;else if(a!==n){a=null;break}}return a},WH.getStatForSpec=function(e,t){var a,n,i=g_specPrimaryStatOrders[t],s=g_specPrimaryStatOrders[t].length;if(71===e){if(n=0,!s)return 5;for(;!((a=i[n])>=3&&a<=5);)if(++n>=s)return 5}else{if(72!==e){if(73!==e){if(74!==e)return e;if(n=0,s){for(;!((a=i[n])>=4&&a<=5);)if(++n>=s)return 5;return a}return 5}if(n=0,s){for(;a=i[n],3!==i[n]&&5!==i[n];)if(++n>=s)return 5;return a}return 5}if(n=0,!s)return 3;for(;!((a=i[n])>=3&&a<=4);)if(++n>=s)return 3}return a},WH.getItemBonusChanceType=function(e){var t=0;if(e>0&&WH.isSet("g_itembonuses")&&g_itembonuses&&g_itembonuses[e])for(var a=g_itembonuses[e],n=0;n<a.length;++n){var i=0;switch(a[n][0]){case 1:case 3:case 4:case 5:case 11:i=1;break;case 2:i=2;break;case 6:i=4}i&&(!t||i<t)&&(t=i)}return t},WH.getItemBonusUpgradeType=function(e){if(e>0&&WH.isSet("g_itembonuses")&&g_itembonuses&&g_itembonuses[e])for(var t=g_itembonuses[e],a=0;a<t.length;++a){var n=t[a];switch(n[0]){case 3:case 4:case 5:case 11:return 1<<n[0]}}return 0},WH.bonusesBtnGetContextBonusId=function(e){let t=0,a=WH.getPageData("wow.item.bonuses.listGroup");if(e&&e.length)for(let n=0;n<e.length;++n){let i=parseInt(e[n]);if(window.g_itembonuses&&g_itembonuses[-1]&&g_itembonuses[-1].includes(i)||null!==a&&a.includes(i)){t=e[n];break}}return t},WH.bonusesGetItem=function(){return WH.getDataSource()[this._bonusesBtn.ttId]},WH.updateItemStringLink=function(){var e=WH.getDataSource(),t=WH.isSet("g_pageInfo")?g_pageInfo.typeId:null;if(e[t]){var a="",n=[];this._bonusesBtn&&this._bonusesBtn.selectedBonus&&(n=(a=this._bonusesBtn.selectedBonus.replace(/u:/,"")).split(":"));var i=this._selectedLevel?this._selectedLevel:WH.Wow.getMaxPlayerLevel(),s=this._knowledgeLevel?this._knowledgeLevel:0,o=this._classSpecBtn&&this._classSpecBtn.selectedSpec?this._classSpecBtn.selectedSpec:"",r=0,l="";if(n.length&&g_itembonuses)e:for(var c,d=0;c=n[d];d++)if(g_itembonuses[c])for(var p,u=0;p=g_itembonuses[c][u];u++)if(11==p[0]||13==p[0]){r|=512,l=(l?":":"")+i;break e}s&&(r|=8388608,l=(l?":":"")+(s+1));var h=(r||"")+"::"+(n.length?n.length+":":"")+a+":"+l,g=WH.ge("open-links-button");if(g){var f={type:3,typeId:t,linkColor:"ff"+WH.Wow.Item.getQualityColor(e[t].quality,!0).replace(/^#/,""),linkId:"item:"+t+"::::::::"+i+":"+o+":"+h,linkName:e[t]["name_"+Locale.getName()],bonuses:n,slot:e[t].slot};i!=WH.Wow.getMaxPlayerLevel()&&(f.lvl=i),o&&(f.spec=o),(sliderControl=WH.ge("sl"+t))&&(f.dropLevel=$(sliderControl).find("input").val()),g.onclick=WH.Links.show.bind(WH.Links,g,f)}}},WH.upgradeItemTooltip=function(e,t,a){let n=WH.getDataSource(),i=g_pageInfo.typeId;if(n[i]){if(a)return void s(this);let o=$("#"+e.id+" > input"),r=null;"number"!=typeof t?o.each((function(e,a){if(-1!=a.id.indexOf(t))return r=a,!1})):r=o.get(t-1);let l=r.checked;function s(e){if(this._selectedUpgrade=t,WH.updateItemStringLink.call(e),n[i]["tooltip_"+Locale.getName()]){let a=e._bonusesBtn&&e._bonusesBtn.selectedBonus?e._bonusesBtn.selectedBonus:null,n=WH.enhanceTooltip.call(e,i,!0,!0,!1,null,e._spellModifiers,WH.ge("ks"+i),t,null,!0,null,null,a);WH.updateTooltip.call(e,n)}}o.each((function(e,t){t.checked=!1})),r.checked=l,l||(t=null),s(this)}},WH.updateTooltip=function(e){e=WH.updateTooltipSingular(e),this.classList.contains("partial-sub-tooltip")?this.innerHTML=WH.Tooltips.evalFormulas(e):(this.innerHTML="<table><tr><td>"+WH.Tooltips.evalFormulas(e)+'</td><th style="background-position: top right"></th></tr><tr><th style="background-position: bottom left"></th><th style="background-position: bottom right"></th></tr></table>',WH.Tooltips.finalizeSizeAndReveal(this))},WH.staticTooltipLevelClick=function(e,t,a,n){for(;-1==e.className.indexOf("tooltip");)e=e.parentNode;var i=e.innerHTML,s=i.match(/<!--i\?(\d+):(\d+):(\d+):(\d+)/);if(s||(s=i.match(/<!--\?(\d+):(\d+):(\d+):(\d+)/)),s||WH.isRetailTree()||(s=i.match(/<!--ppl(\d+):(\d+):(\d+):(\d+):(\d+)/))&&(s=[null,s[1],s[2],WH.Wow.getMaxPlayerLevel(),0]),s||(s=i.match(/<!--pl(\d+):(\d+):(\d+)-->\s?(\d+)/))&&(WH.isSet("g_pageInfo")&&g_pageInfo.type==WH.Types.ITEM&&(s[1]=g_pageInfo.typeId),s=[null,s[1],s[2],s[3],s[4]]),s){var o=parseInt(s[1]),r=parseInt(s[2]),l=parseInt(s[3]),c=parseInt(s[4]);if(!(r>=l||(isNaN(t)&&(t=prompt(WH.sprintf(WH.TERMS.ratinglevel_format,r,l),c)),t=parseInt(t),isNaN(t)||t==c||t<r||t>l))){e._selectedLevel=t;var d=WH.getDataSource();s=WH.setTooltipLevel.bind(e,d[o][(n?"buff_":"tooltip_")+Locale.getName()],t,n)();var p=e._bonusesBtn&&e._bonusesBtn.selectedBonus?e._bonusesBtn.selectedBonus:null,u=e._selectedUpgrade?e._selectedUpgrade:0;s=WH.enhanceTooltip.call(e,s,!0,null,null,null,null,null,u,null,null,null,null,p),WH.updateTooltip.call(e,s),e.slider&&!a&&Slider.setValue(e.slider,t),n||WH.tooltipSpellsChange.bind(e)()}}},WH.staticTooltipKnowledgeLevelClick=function(e,t,a){for(;-1==e.className.indexOf("tooltip");)e=e.parentNode;var n=e.innerHTML;if(isNaN(t)&&(WH.Tooltips.hide(),t=prompt(WH.sprintf(WH.TERMS.ratinglevel_format,0,g_artifact_knowledge_max_level),e._knowledgeLevel?e._knowledgeLevel:0)),t=parseInt(t),!isNaN(t)&&!(t<0||t>g_artifact_knowledge_max_level)){e._knowledgeLevel=t,WH.Url.replacePageQuery((function(e){t?e.artk=t:delete e.artk}));var i=WH.getDataSource();n=WH.setTooltipLevel.bind(e,i[a]["tooltip_"+Locale.getName()],e._selectedLevel,null)();var s=e._bonusesBtn&&e._bonusesBtn.selectedBonus?e._bonusesBtn.selectedBonus:null,o=e._selectedUpgrade?e._selectedUpgrade:0;n=WH.enhanceTooltip.call(e,n,!0,null,null,null,null,null,o,null,null,null,null,s),WH.updateTooltip.call(e,n)}},WH.tooltipSliderMove=function(e,t,a){WH.staticTooltipLevelClick(this,a.value,1),this.bufftip&&WH.staticTooltipLevelClick(this.bufftip,a.value,1,1),WH.Tooltips.hide()},WH.tooltipSpellsChange=function(){if(this.modified){var e=this.modified[0],t=this.modified[1],a=[];$.each($("input:checked",e),(function(e,t){a.push(parseInt(t.dataset.spellId))})),this.modified[2]=a,WH.qsa(".lazy-load-background",this).forEach((e=>e.classList.remove("lazy-load-background"))),this.innerHTML=WH.setTooltipSpells(this.innerHTML,a,t),this.bufftip&&WH.tooltipSpellsChange.bind(this.bufftip)(),WH.Url.replacePageQuery((function(e){let t=WH.getPageData("WH.Wow.Covenant.data");delete e.spellModifier,delete e.covenant;let n=[];a.forEach((a=>{let i=Object.keys(t).find((e=>t[e].spellId===a));i?e.covenant=i:n.push(a)})),n.length&&(e.spellModifier=n.join(":"))}))}},WH.tooltipRPPMChange=function(e){var t=$(this).attr("id").match(/\d+$/)[0];WH.qsa(".lazy-load-background",e).forEach((e=>e.classList.remove("lazy-load-background"))),e.innerHTML=WH.Tooltips.evalFormulas(e.innerHTML.replace(/<!--rppm-->(\[?)(\d+(?:\.\d+)?)([^<]*)<!--rppm-->/,(function(a,n,i,s){return"\x3c!--rppm--\x3e"+n+(e._rppmModBase*(1+parseFloat(e._rppmSpecModList[t].modifiervalue))).toFixed(2)+s+"\x3c!--rppm--\x3e"})))},WH.validateBpet=function(e,t){var a=1,n=25,i=0,s=4,o=1023,r=3,l=$.extend({},t);return e.minlevel&&(a=e.minlevel),e.maxlevel&&(n=e.maxlevel),e.companion&&(n=a),l.level||(l.level=25),l.level=Math.min(Math.max(l.level,a),n),e.minquality&&(i=e.minquality,e.untameable&&(s=i)),e.maxquality&&(s=e.maxquality),null==l.quality&&(l.quality=3),l.quality=Math.min(Math.max(l.quality,i),s),e.companion&&delete l.quality,e.breeds>0&&(o=e.breeds&o),o&1<<r-3||(r=Math.floor(3+Math.log(o)/Math.LN2)),l.breed&&l.breed>=13&&(l.breed-=10),l.breed&&o&1<<l.breed-3||(l.breed=r),l},WH.calcBattlePetStats=function(e,t,a,n,i){WH.battlePetBreedStats[t]||(t=3);var s=e.health;isNaN(s)&&(s=0);var o=e.power;isNaN(o)&&(o=0);var r=e.speed;isNaN(r)&&(r=0),isNaN(a)&&(a=1),a=Math.min(Math.max(0,a),5),isNaN(n)&&(n=1),n=Math.min(Math.max(1,n),25);var l=WH.battlePetBreedStats[t],c=1+a/10;return s=5*(s+l[0])*n*c+100,o=(o+l[1])*n*c,r=(r+l[2])*n*c,i&&(s=5*s/6,o=4*o/5),{health:Math.round(s),power:Math.round(o),speed:Math.round(r)}},WH.battlePetBreedStats={3:[.5,.5,.5],4:[0,2,0],5:[0,0,2],6:[2,0,0],7:[.9,.9,0],8:[0,.9,.9],9:[.9,0,.9],10:[.4,.9,.4],11:[.4,.4,.9],12:[.9,.4,.4]},WH.battlePetAbilityLevels=[1,2,4,10,15,20],WH.createButton=function(e,t,a){var n="btn btn-site",i="",s="",o="",r=[],l=[];if(a||(a={}),a["no-margin"]||l.push("margin-left:5px"),"string"==typeof t&&""!==t||(t="javascript:"),a["new-window"]&&(i=' target="_blank"'),"string"==typeof a.id&&(s=' id="'+a.id+'"'),void 0!==a.size)switch(a.size){case"small":case"large":r.push("btn-"+a.size)}else r.push("btn-small");if("string"==typeof a.class&&r.push(a.class),"string"==typeof a.type)switch(a.type){case"default":case"gray":n="btn";break;default:n="btn btn-"+a.type}a.disabled&&(r.push("btn-disabled"),t="javascript:"),r.length&&(n+=" "+r.join(" ")),n&&(n=' class="'+n+'"'),(void 0===a.float||a.float)&&l.push("float:right"),"string"==typeof a.style&&l.push(a.style),l.length&&(o=' style="'+l.join(";")+'"');var c='<a href="'+t+'"'+i+s+n+o+">"+(e||"")+"</a>",d=WH.ce("div");d.innerHTML=c;var p=d.childNodes[0];return"function"!=typeof a.click||a.disabled||(p.onclick=a.click),void 0!==a.tooltip&&(!1!==a.tooltip&&p.setAttribute("data-whattach","true"),!1===a.tooltip?p.rel="np":"string"==typeof a.tooltip?WH.Tooltips.attach(p,a.tooltip):"object"==typeof a.tooltip&&a.tooltip.text&&WH.Tooltips.attach(p,a.tooltip.text,a.tooltip.class)),p},WH.D4=new function(){this.getImageUrlFromHash=(e,t)=>{"string"==typeof e&&(e=parseInt(e)),t??=WH.getDataEnv();const a=WH.isDataEnvRestricted(t);let n=t===WH.dataEnv.D4PTR?"/d4/texture-ptr/":"/d4/texture/",i=WH.WebP.getImageExtension(),s=e?`${n}hash/${255&e}/${e}${i}`:`${n}hash/74/582516298${i}`;return a?WH.Url.generatePrivate(s):`${WH.STATIC_URL}${s}`},this.getStringHash=(e,t=!0)=>{let a=Array.from(t?e.toLowerCase():e).map((e=>e.charCodeAt(0))).reduce(((e,t)=>(e<<5)+e+t&4294967295),0);return a<0?a+4294967296:a}},WH.Device=new function(){const e={isMobile:void 0,isTablet:void 0,isTouch:void 0};this.isMobile=function(){return e.isMobile},this.isTablet=function(){return e.isTablet},this.isTouch=function(){return e.isTouch},function(){let t=navigator.userAgent||navigator.vendor||window.opera;(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e.isMobile=!0),e.isMobile||/(android|ipad|playbook|silk)/i.test(t)&&(e.isTablet=!0),e.isTouch=e.isMobile||e.isTablet}()},WH.DI=new function(){},WH.Game=new function(){const e=this;this.WOW=1,this.D2=2,this.DI=3,this.D4=4,this.DEFAULT=this.WOW;const t=[WH.dataTree.RETAIL,WH.dataTree.CLASSIC,WH.dataTree.CATA,WH.dataTree.D4],a={[this.D2]:{dataTrees:[WH.dataTree.D2],defaultTree:WH.dataTree.D2,term:"diablo2Resurrected",termAbbrev:"diablo2_abbrev",termSeo:"diablo2Resurrected"},[this.DI]:{dataTrees:[WH.dataTree.DI],defaultTree:WH.dataTree.DI,term:"diabloImmortal",termAbbrev:"diabloImmortal_abbrev",termSeo:"diabloImmortal"},[this.D4]:{dataTrees:[WH.dataTree.D4],defaultTree:WH.dataTree.D4,term:"diablo4",termAbbrev:"diablo4_abbrev",termSeo:"diablo4_seo"},[this.WOW]:{dataTrees:[WH.dataTree.RETAIL,WH.dataTree.CLASSIC,WH.dataTree.TBC,WH.dataTree.WRATH,WH.dataTree.CATA],defaultTree:WH.dataTree.RETAIL,term:"worldofwarcraft",termAbbrev:"worldOfWarcraft_abbrev",termSeo:"worldofwarcraft"}},n={[this.D2]:"d2",[this.DI]:"di",[this.WOW]:"wow",[this.D4]:"d4"},i={[this.D2]:WH.dataEnv.D2,[this.DI]:WH.dataEnv.DI,[this.WOW]:WH.dataEnv.MAIN,[this.D4]:WH.dataEnv.D4};let s={[WH.dataEnv.BETA]:"beta",[WH.dataEnv.D2]:"diablo-2",[WH.dataEnv.DI]:"diablo-immortal",[WH.dataEnv.WRATH]:"wotlk",[WH.dataEnv.CLASSIC]:"classic",[WH.dataEnv.PTR]:"ptr",[WH.dataEnv.PTR2]:"ptr-2",[WH.dataEnv.TBC]:"tbc",[WH.dataEnv.D4]:"diablo-4",[WH.dataEnv.CATA]:"cata",[WH.dataEnv.D4PTR]:"diablo-4-ptr"};const o={[WH.dataTree.RETAIL]:this.WOW,[WH.dataTree.CLASSIC]:this.WOW,[WH.dataTree.TBC]:this.WOW,[WH.dataTree.D2]:this.D2,[WH.dataTree.DI]:this.DI,[WH.dataTree.WRATH]:this.WOW,[WH.dataTree.D4]:this.D4,[WH.dataTree.CATA]:this.WOW},r=[this.D2,this.DI],l={[this.WOW]:"wow_token01",[this.D2]:"inv_diablostone",[this.DI]:"inv_cape_special_treasuregoblin_d_01",[this.D4]:"diabloanniversary_achievement"};this.get=()=>e.getByTree(WH.getDataTree()),this.getAll=()=>Object.keys(n).map(Number),this.getAllSelectors=()=>Object.values(s),this.getAllSorted=()=>{let t=e.getAll();return t.sort(((t,a)=>t===e.WOW?-1:a===e.WOW?1:a-t)),t},this.getByKey=e=>{for(let t of Object.keys(n))if(n[t]===e)return parseInt(t)},this.getByEnv=t=>e.getByTree(WH.getDataTree(t)),this.getByTree=e=>o[e],this.getDataEnvBySelector=e=>WH.findKey(s,e,!0),this.getDataEnvs=e=>{let t=[],n=a[e].dataTrees;return Object.entries(WH.dataEnvToTree).forEach((([e,a])=>{n.includes(a)&&t.push(parseInt(e))})),t},this.getDataTrees=e=>{let t=a[e]?.dataTrees||[];if(!WH.REMOTE){const e=WH.PageMeta.availableDataEnvs.map((e=>WH.getDataTree(e)));t=t.filter((t=>e.includes(t)))}return t.length?t:void 0},this.getDefaultEnv=e=>i[e],this.getEnv=t=>(t=t||e.DEFAULT)===WH.Game.get()?WH.getDataEnv():WH.Game.getDefaultEnv(t),this.getFeaturedTrees=()=>t,this.getName=e=>a[e]?WH.TERMS[a[e].term]:void 0,this.getAbbrev=e=>a[e]?WH.TERMS[a[e].termAbbrev]:void 0,this.getKey=e=>n[e],this.getRoot=t=>WH.getRootEnv(e.getEnv(t)),this.getSelectorByDataEnv=e=>s[e],this.getSeoName=e=>a[e]?WH.TERMS[a[e].termSeo]:void 0,this.getWowIconName=e=>l[e],this.hasAccess=t=>(e.getDataTrees(t)||[]).length>0,this.isUnderstated=e=>r.includes(e),this.supportsRandomPages=t=>[e.WOW,e.DI].includes(t)},WH.Fonts=new function(){const e=WH.Game,t="https://use.typekit.net/kxf7wgk.css",a=`${WH.STATIC_URL}/css/fonts/d4.css`,n="https://use.typekit.net/qwt0uqi.css",i={[e.D2]:[n],[e.D4]:[t,a],[e.DI]:[n]},s={requestedUrls:new Set};this.load=e=>{i[e]&&i[e].forEach((e=>function(e){if(!e||s.requestedUrls.has(e))return;s.requestedUrls.add(e),e===t&&s.requestedUrls.add(n);if(document.head.querySelector('link[rel="stylesheet"][href="'+e+'"]'))return;WH.ae(document.head,WH.ce("link",{href:e,rel:"stylesheet",type:"text/css"}))}(e)))}},WH.Icon=new function(){const e=this,t=WH.Game,n=WH.Types;this.TINY="tiny",this.SMALL="small",this.MEDIUM="medium",this.LARGE="large",this.BLIZZARD="blizzard",this.LEGACY_IDS={0:this.SMALL,1:this.MEDIUM,2:this.LARGE,3:this.BLIZZARD},this.WOW_MEDIUM_SELECTED_CLASS="iconmedium-gold-selected",this.UNKNOWN="inv_misc_questionmark",this.UNKNOWN_ZONE="inv_misc_map08";const i=[this.TINY,this.SMALL,this.MEDIUM,this.LARGE,this.BLIZZARD];this.create=function(i,s,o,r){i&&(i=`${i}`);let l=(r=r||{}).dataEnv||r.type&&n.getPreferredDataEnv(r.type)||t.getEnv(r.game),c=t.getByEnv(l);if(s===e.TINY)return WH.ce("img",{className:"icontiny",src:e.getIconUrl(i,s,l)});let d=WH.ce(r.span?"span":"div",{className:"icon"+s,dataset:{env:WH.getDataEnvKey(l),tree:WH.getDataTreeKey(WH.getDataTree(l)),game:t.getKey(c)}});WH.ae(d,WH.ce("ins")),!1!==r.border&&WH.ae(d,WH.ce("del"));let p=r.type&&n.getStringId(r.type);p&&(d.dataset.type=p),!0===r.simple?d.dataset.kind="simple":r.kind&&(d.dataset.kind=r.kind),r.color&&(d.dataset.color=r.color),WH.cO(d.dataset,r.dataset),i&&(i.includes("/")?e.setImage(d,i,!0,r.isMask):e.setImage(d,e.getIconUrl(i,s,l),!1,r.isMask),WH.isRemote()||!1===r.lazyLoad||WH.DOM.lazyLoadBackground(d.firstChild));const u=r.ariaLabel||WH.TERMS.icon;if(o){let e=WH.ce("a",{ariaLabel:u,href:o});-1===o.indexOf("wowhead.com")&&/^https?:/.test(o)&&(e.target="_blank"),WH.ae(d,e)}else if(i){-1!==d.firstChild.style.backgroundImage.indexOf("/avatars/")||null!==o&&(WH.ae(d,WH.ce("a",{ariaLabel:u,href:"javascript:"})),d.onclick=Icon.onClick)}return r.rel&&"undefined"!=typeof a&&(a.rel=r.rel),e.setText(d,r.number,r.quantity),d},this.createByEntity=function(t,a,i,s){let o=(s=s||{}).size;delete s.size,s.dataEnv=s.dataEnv||t.dataEnv||(n.getRequiredTrees(a)||[])[0],s.type=a,s.ariaLabel??=t.name;const r=WH.DI.GeneralItem;switch(a){case n.DI_EQUIP_ITEM:s.dataset=s.dataset||{},s.dataset.gridType=s.gridType||t.gridType||([6,11,4,3,7,9,8].includes(t.inventoryPosition)?r.GRID_TYPE_1x1:r.GRID_TYPE_2x1),delete s.gridType,null!=t.inventoryColor&&(s.dataset.inventoryColor=t.inventoryColor);break;case n.DI_MISC_ITEM:s.dataset=s.dataset||{},s.dataset.gridType=s.gridType||t.gridType||r.GRID_TYPE_2x1,delete s.gridType,null!=t.inventoryColor&&(s.dataset.inventoryColor=t.inventoryColor);break;case n.DI_PARAGON_SKILL:s.dataset=s.dataset||{},s.dataset.specSkill=JSON.stringify(!(!s.isSpecSkill&&!t.isSpecSkill));break;case n.D4_PARAGON_NODE:s.dataset=s.dataset||{},s.isMask=!!t.iconImageHash,s.dataset.nodeType=`${t.type}`,s.dataset.isGate=`${!!t.isGate}`,s.dataset.hasSocket=`${!!t.hasSocket}`;case n.D4_ITEM:case n.D4_PARAGON_GLYPH:case n.D4_SENESCHAL_STONE:null!=t.quality&&(s.dataset=s.dataset||{},s.dataset.quality=t.quality);break;case n.D4_SKILL:!1===(s.active??t.active)&&delete(s={...s,dataset:{skillType:"passive"}}).active}return e.create(t.icon||t.iconImageHash,o||e.MEDIUM,i,s)},this.getIconUrl=function(a,n,i=t.getEnv(t.DEFAULT)){let s=t.getByEnv(i),o=t.getKey(s);o||(WH.warn('Invalid game provided for "'+a+'" icon: '+s),o=t.getKey(t.WOW),a=e.UNKNOWN);let r=n===e.TINY?".gif":".jpg";return`https://db.newbeebox.com/wow/wz/${`/images/${o}/icons/${n}/${a.toLowerCase()}${r}`}`},this.getLink=function(e){return e.querySelector("a")},this.isValidSize=function(e){return-1!==i.indexOf(e)},this.setImage=function(e,t,a,n){let i=e.firstChild;i.style.backgroundPosition="",n?i.style["-webkit-mask-image"]=t?'url("'+t+'")':"":i.style.backgroundImage=t?'url("'+t+'")':"",!0===a&&(i.style.backgroundSize="contain")},this.setLinkUrl=function(t,a){let n=e.getLink(t);n&&(n.href=a)},this.setName=function(t,a,n,i){n?(a===e.BLIZZARD&&(a=e.LARGE),e.setImage(t,e.getIconUrl(n,a,i))):e.setImage(t,null)},this.setText=function(e,t,a){WH.qsa(".wh-icon-text",e).forEach((e=>WH.de(e))),null!=t&&(t>1&&t<2147483647||t.length&&"0"!==t&&"1"!==t)&&WH.ae(e,WH.ce("span",{className:"wh-icon-text",dataset:{type:"number"}},WH.ct(t))),null!=a&&a>0&&WH.ae(e,WH.ce("span",{className:"wh-icon-text",dataset:{type:"quantity"}},WH.ct("("+a+")")))}};var Icon={questionMarkIcon:WH.Icon.UNKNOWN,sizes:["small","medium","large","blizzard"],sizes2:[18,36,56,64],sizeIds:{small:0,medium:1,large:2,blizzard:3},premiumOffsets:[[-56,-36],[-56,0],[0,0],[0,0]],premiumBorderClasses:["-premium","-gold","","-premiumred","-red",""],STANDARD_BORDER:2,privilegeBorderClasses:{uncommon:"-q2",rare:"-q3",epic:"-q4",legendary:"-q5"},idLookupCache:{},create:function(e,t,a,n,i,s,o,r,l,c,d){return d=d||{},null==t&&(t=Icon.sizeIds.medium),WH.Icon.create(e,WH.Icon.LEGACY_IDS[t],!1===n?null:n,{border:!o,color:d.color,game:d.game,lazyLoad:d.lazyLoad,number:i,quantity:s,rel:r,simple:c,span:l,type:d.type})},createUser:function(e,t,a,n,i,s,o){2==e&&(t=WH.staticUrl+"/uploads/avatars/"+t+".jpg");var r=Icon.create(t,a,null,n,null,null,s);return i!=Icon.STANDARD_BORDER?Icon.premiumBorderClasses[i]&&(r.className+=" "+r.className+Icon.premiumBorderClasses[i]):o&&Icon.privilegeBorderClasses.hasOwnProperty(o)&&(r.className+=" "+r.className+Icon.privilegeBorderClasses[o]),2==e&&Icon.moveTexture(r,a,Icon.premiumOffsets[a][0],Icon.premiumOffsets[a][1],!0),r.classList.add("icon"+Icon.sizes[a]+"-sprite"),r},getIdFromName:function(e,t){Icon.idLookupCache.hasOwnProperty(e)?window.requestAnimationFrame((function(){t(Icon.idLookupCache[e]||void 0)})):$.ajax({url:WH.Url.generatePath("/icon/get-id-from-name"),data:{name:e},dataType:"json",success:function(a){Icon.idLookupCache[e]=a,t(a||void 0)}})},getPrivilegeBorder:function(e){var t=!1;return e>=5e3&&(t="uncommon"),e>=1e4&&(t="rare"),e>=15e3&&(t="epic"),e>=25e3&&(t="legendary"),t},setUrl:function(e,t){t||(t="javascript:"),Icon.getLink(e).href=t},setTexture:function(e,t,a){var n=e.firstChild.style;if(n.backgroundSize="",n.backgroundPosition="",a)if(-1!==a.indexOf("/"))n.backgroundImage="url("+a+")",n.backgroundSize="contain";else{let e=Icon.sizes[t];"blizzard"===e&&(e="large"),n.backgroundImage=`url("${WH.Icon.getIconUrl(a,e)}")`}else n.backgroundImage=null},moveTexture:function(e,t,a,n,i){var s=e.firstChild.style;s.backgroundSize="",a||n?s.backgroundPosition=i?a+"px "+n+"px":-a*Icon.sizes2[t]+"px "+-n*Icon.sizes2[t]+"px":s.backgroundPosition&&(s.backgroundPosition="")},getLink:function(e){return WH.gE(e,"a")[0]},showIconInfo:function(e){const t=e.dataset.env?WH.getDataEnvFromKey(e.dataset.env):null;if(e.firstChild&&t){let a=e.firstChild.style;if(a.backgroundImage&&(!WH.STATIC_URL||a.backgroundImage.indexOf(WH.STATIC_URL)>=4)){let e=a.backgroundImage.match(/images\/([^/]+)\/icons\/[^/]+\/([^/.]+).(?:jpg|gif)/);e&&Icon.displayIcon(e[2],t)}}},onClick:function(){Icon.showIconInfo(this)},displayIcon:function(e,t){Dialog.templates.icondisplay||(Dialog.templates.icondisplay={title:WH.TERMS.icon,width:500,buttons:[["arrow",WH.TERMS.original],["x",WH.TERMS.close]],fields:[{id:"icon",label:WH.TERMS.name_colon,required:1,type:"text",labelAlign:"left",compute:function(e,a,n,i){i.classList.add("icon-dialog-content");var s=this.iconDiv=WH.ce("div");s.update=function(){setTimeout((function(){WH.safeSelect(e)}),10),WH.ee(s),WH.ae(s,WH.Icon.create(e.value,WH.Icon.LARGE,void 0,{dataEnv:t}))},WH.ae(s,WH.Icon.create(a,WH.Icon.LARGE,void 0,{dataEnv:t})),WH.ae(i,s),WH.ae(i,e)}},{id:"iconId",label:WH.TERMS.id+WH.TERMS.colon_punct,type:"text",labelAlign:"left",compute:function(e,t,a,n){n.classList.add("icon-dialog-content"),e.value="",this.iconIdField=e}},{id:"location",label:" ",required:1,type:"caption",compute:function(e,t,a,n,i){WH.ee(n),n.classList.add("icon-dialog-caption");let s=WH.Strings.escapeHtml(WH.Url.generatePath("/items?filter=142;0;"+this.data.icon)),o=WH.Strings.escapeHtml(WH.Url.generatePath("/spells?filter=15;0;"+this.data.icon)),r=WH.Strings.escapeHtml(WH.Url.generatePath("/achievements?filter=10;0;"+this.data.icon));var l=WH.TERMS.seeallusingicon_format;l=(l=(l=l.replace("$1",'<a href="'+s+'">'+WH.Types.getLowerPlural(WH.Types.ITEM)+"</a>")).replace("$2",'<a href="'+o+'">'+WH.Types.getLowerPlural(WH.Types.SPELL)+"</a>")).replace("$3",'<a href="'+r+'">'+WH.Types.getLowerPlural(WH.Types.ACHIEVEMENT)+"</a>"),n.innerHTML=l}}],onInit:function(e){this.updateIcon=this.template.updateIcon.bind(this,e)},onShow:function(e){this.updateIcon(),location.hash&&-1==location.hash.indexOf("#icon")?this.oldHash=location.hash:this.oldHash="";var t="#icon";window.g_pageInfo&&g_pageInfo.type&&[WH.Types.ITEM,WH.Types.SPELL,WH.Types.ACHIEVEMENT].includes(g_pageInfo.type)||(t+=`:${this.data.icon}`,this.data.env&&this.data.env!==WH.getDataEnv()&&(t+=`:${WH.getDataEnvKey(this.data.env)}`)),location.hash=t},onHide:function(e){this.oldHash?WH.setHash(this.oldHash):WH.clearHash()},updateIcon:function(e){this.iconDiv.update();var t=this.iconIdField;Icon.getIdFromName(e.icon.value,(function(e){t.value=e||""}))},onSubmit:function(e,t,a,n){if("arrow"===a){let e=WH.Icon.getIconUrl(t.icon,WH.Icon.LARGE,t.env);return window.open(e,"_blank").focus(),!1}return!0}}),Icon.icDialog||(Icon.icDialog=new Dialog),Icon.icDialog.show("icondisplay",{data:{icon:e,env:t}})},checkPound:function(){if(location.hash&&0===location.hash.indexOf("#icon")){let e,t=location.hash.split(":"),a=WH.getDataEnv();3===t.length?(e=t[1],a=WH.getDataEnvFromKey(t[2])??a):2===t.length?e=t[1]:1===t.length&&window.g_pageInfo&&(e=WH.Gatherer.getIconName(g_pageInfo.type,g_pageInfo.typeId)),e&&Icon.displayIcon(e,a)}}};WH.REMOTE||WH.onLoad(Icon.checkPound),WH.Tooltips=WH.Tooltips||new function(){const e=this,t=WH.Game,a=WH.Icon,n=WH.Types,i=550,s={garrisonability:"mission-ability",itemset:"item-set",petability:"pet-ability"},o={1:299204,2:299205,3:299206,4:299207},r=15,l=15,c=[n.ACHIEVEMENT,n.AFFIX,n.AZERITE_ESSENCE,n.AZERITE_ESSENCE_POWER,n.ITEM,n.SPELL,n.DI_EQUIP_ITEM,n.DI_MISC_ITEM,n.DI_PARAGON_SKILL,n.DI_SKILL,n.D4_AFFIX,n.D4_ASPECT,n.D4_ITEM,n.D4_PARAGON_GLYPH,n.D4_PARAGON_NODE,n.D4_SKILL,n.D4_VAMPIRIC_POWER,n.D4_SENESCHAL_STONE],d={"-1000":{name:"Mount",path:"mount",mobile:!0,data:{},maxId:5e4},"-1001":{name:"Recipe",path:"recipe",mobile:!0,data:{},maxId:5e5},"-1002":{name:"Battle Pet",path:"battle-pet",mobile:!0,data:{},maxId:5e4},[n.NPC]:{name:"NPC",path:"npc",mobile:!1,data:{},maxId:5e5},[n.OBJECT]:{name:"Object",path:"object",mobile:!1,data:{},maxId:75e4},[n.ITEM]:{name:"Item",path:"item",mobile:!0,data:{},maxId:5e5},[n.ITEM_SET]:{name:"Item Set",path:"item-set",mobile:!0,data:{},maxId:1e4,minId:-5e3},[n.QUEST]:{name:"Quest",path:"quest",mobile:!1,data:{},maxId:1e5},[n.SPELL]:{name:"Spell",path:"spell",mobile:!0,data:{},maxId:5e5},[n.ZONE]:{name:"Zone",path:"zone",mobile:!1,data:{},maxId:5e4},[n.ACHIEVEMENT]:{name:"Achievement",path:"achievement",mobile:!0,data:{},maxId:5e4},[n.EVENT]:{name:"Event",path:"event",mobile:!1,data:{},maxId:1e4},[n.CURRENCY]:{name:"Currency",path:"currency",mobile:!1,data:{},maxId:1e4},[n.BUILDING]:{name:"Building",path:"building",mobile:!1,data:{},maxId:1e3},[n.FOLLOWER]:{name:"Follower",path:"follower",mobile:!0,data:{},maxId:1e4},[n.MISSION_ABILITY]:{name:"Mission Ability",path:"mission-ability",mobile:!0,data:{},maxId:1e4},[n.MISSION]:{name:"Mission",path:"mission",mobile:!0,data:{},maxId:1e4},[n.SHIP]:{name:"Ship",path:"ship",mobile:!0,data:{},maxId:1e4},[n.THREAT]:{name:"Threat",path:"threat",mobile:!1,data:{},maxId:1e3},[n.RESOURCE]:{name:"Resource",path:"resource",mobile:!0,data:{},maxId:100,minId:0},[n.CHAMPION]:{name:"Champion",path:"champion",mobile:!0,data:{},maxId:1e4},[n.ORDER_ADVANCEMENT]:{name:"Order Advancement",path:"order-advancement",mobile:!0,data:{},maxId:5e3},[n.BFA_CHAMPION]:{name:"BFA Champion",path:"bfa-champion",mobile:!0,data:{},maxId:1e4},[n.AFFIX]:{name:"Affix",path:"affix",mobile:!0,data:{},maxId:1e3},[n.AZERITE_ESSENCE_POWER]:{name:"Azerite Essence Power",path:"azerite-essence-power",mobile:!0,data:{},maxId:1e3},[n.AZERITE_ESSENCE]:{name:"Azerite Essence",path:"azerite-essence",mobile:!1,data:{},maxId:100},[n.STORYLINE]:{name:"Storyline",path:"storyline",mobile:!1,data:{},maxId:1e4},[n.ADVENTURE_COMBATANT_ABILITY]:{name:"Adventure Combatant Ability",path:"adventure-combatant-ability",mobile:!0,data:{},maxId:1e4},[n.GUIDE]:{name:"Guide",path:"guide",mobile:!1,data:{}},[n.TRANSMOG_SET]:{name:"Transmog Set",path:"transmog-set",mobile:!0,data:{},maxId:5e4},[n.OUTFIT]:{name:"Outfit",path:"outfit",mobile:!0,data:{}},[n.BATTLE_PET_ABILITY]:{name:"Battle Pet Ability",path:"pet-ability",mobile:!0,data:{},maxId:1e4},[n.DI_EQUIP_ITEM]:{name:"Equipment Item",path:"equip-item",mobile:!0,data:{},embeddedIcons:!0},[n.DI_MISC_ITEM]:{name:"Miscellaneous Item",path:"misc-item",mobile:!0,data:{},embeddedIcons:!0},[n.DI_NPC]:{name:"NPC",path:"npc",mobile:!0,data:{}},[n.DI_PARAGON_SKILL]:{name:"Paragon Skill",path:"paragon-skill",mobile:!0,data:{}},[n.DI_QUEST]:{name:"Quest",path:"quest",mobile:!0,data:{}},[n.DI_SET]:{name:"Set",path:"set",mobile:!0,data:{}},[n.DI_SKILL]:{name:"Skill",path:"skill",mobile:!0,data:{}},[n.DI_ZONE]:{name:"Zone",path:"zone",mobile:!0,data:{}},[n.D4_AFFIX]:{name:"Affix",path:"affix",mobile:!0,data:{},embeddedIcons:!0},[n.D4_ASPECT]:{name:"Aspect",path:"aspect",mobile:!0,data:{},embeddedIcons:!0},[n.D4_PARAGON_GLYPH]:{name:"Paragon Glyph",path:"paragon-glyph",mobile:!0,data:{},embeddedIcons:!0},[n.D4_PARAGON_NODE]:{name:"Paragon Node",path:"paragon-node",mobile:!0,data:{},embeddedIcons:!0},[n.D4_SKILL]:{name:"Skill",path:"skill",mobile:!0,data:{},embeddedIcons:!0},[n.PROFESSION_TRAIT]:{name:"Profession Trait",path:"profession-trait",mobile:!0,data:{},maxId:5e5},[n.D4_ITEM]:{name:"Item",path:"item",mobile:!0,data:{},embeddedIcons:!0},[n.TRADING_POST_ACTIVITY]:{name:"Trading Post Activity",path:"trading-post-activity",mobile:!0,data:{},maxId:1e4},[n.D4_VAMPIRIC_POWER]:{name:"Vampiric Power",path:"vampiric-power",mobile:!0,data:{},embeddedIcons:!0},[n.D4_SENESCHAL_STONE]:{name:"Seneschal Stone",path:"seneschal-stone",mobile:!0,data:{},embeddedIcons:!0}},p=(()=>{let e={[WH.dataTree.D2]:["guide"],[WH.dataTree.D4]:["affix","aspect","guide","item","paragon-glyph","paragon-node","seneschal-stone","skill","vampiric-power"],[WH.dataTree.DI]:["equip-item","guide","misc-item","npc","paragon-skill","set","skill"],[WH.dataTree.RETAIL]:["achievement","adventure-combatant-ability","affix","azerite-essence","azerite-essence-power","battle-pet","bfa-champion","building","champion","currency","event","follower","garrisonability","guide","item","item-set","itemset","mission","mission-ability","mount","npc","object","order-advancement","outfit","pet-ability","petability","profession-trait","quest","recipe","resource","ship","spell","statistic","storyline","threat","trading-post-activity","transmog-set","zone"],[WH.dataTree.CLASSIC]:["currency","event","guide","item","item-set","itemset","npc","object","outfit","pet-ability","petability","quest","resource","spell","statistic","transmog-set","zone"]};return e[WH.dataTree.TBC]=e[WH.dataTree.CLASSIC],e[WH.dataTree.WRATH]=e[WH.dataTree.TBC].concat(["achievement"]),e[WH.dataTree.CATA]=e[WH.dataTree.WRATH],e})(),u={traits:{agi:["Agility","Agi","Agi"],arcres:["Arcane resistance","Arcane Resist","ArcR"],arcsplpwr:["Arcane spell power","Arcane Power","ArcP"],armor:["Armor","Armor","Armor"],armorbonus:["Additional armor","Bonus Armor","AddAr"],armorpenrtng:["Armor penetration rating","Armor Pen","Pen"],atkpwr:["Attack power","AP","AP"],block:["Block value","Block Value","BkVal"],blockrtng:["Block rating","Block","Block"],critstrkrtng:["Critical strike rating","Crit","Crit"],defrtng:["Defense rating","Defense","Def"],dmg:["Weapon damage","Damage","Dmg"],dmgmax1:["Maximum damage","Max Damage","Max"],dmgmin1:["Minimum damage","Min Damage","Min"],dodgertng:["Dodge rating","Dodge","Dodge"],dps:["Damage per second","DPS","DPS"],exprtng:["Expertise rating","Expertise","Exp"],firres:["Fire resistance","Fire Resist","FirR"],firsplpwr:["Fire spell power","Fire Power","FireP"],frores:["Frost resistance","Frost Resist","FroR"],frosplpwr:["Frost spell power","Frost Power","FroP"],hastertng:["Haste rating","Haste","Haste"],health:["Health","Health","Hlth"],healthrgn:["Health regeneration","HP5","HP5"],hitrtng:["Hit rating","Hit","Hit"],holres:["Holy resistance","Holy Resist","HolR"],holsplpwr:["Holy spell power","Holy Power","HolP"],int:["Intellect","Int","Int"],level:["Level","Level","Lvl"],mana:["Mana","Mana","Mana"],manargn:["Mana regeneration","MP5","MP5"],mastrtng:["Mastery rating","Mastery","Mastery"],mleatkpwr:["Melee attack power","Melee AP","AP"],mlecritstrkrtng:["Melee critical strike rating","Melee Crit","Crit"],mledmgmax:["Melee maximum damage","Melee Max Damage","Max"],mledmgmin:["Melee minimum damage","Melee Min Damage","Min"],mledps:["Melee DPS","Melee DPS","DPS"],mlehastertng:["Melee haste rating","Melee Haste","Haste"],mlehitrtng:["Melee hit rating","Melee Hit","Hit"],mlespeed:["Melee speed","Melee Speed","Speed"],natres:["Nature resistance","Nature Resist","NatR"],natsplpwr:["Nature spell power","Nature Power","NatP"],nsockets:["Number of sockets","Sockets","Sockt"],parryrtng:["Parry rating","Parry","Parry"],reqarenartng:["Required personal and team arena rating","Req Rating","Rating"],reqlevel:["Required level","Req Level","Level"],resirtng:["PvP Resilience rating","PvP Resilience","Resil"],rgdatkpwr:["Ranged attack power","Ranged AP","RAP"],rgdcritstrkrtng:["Ranged critical strike rating","Ranged Crit","Crit"],rgddmgmax:["Ranged maximum damage","Ranged Max Damage","Max"],rgddmgmin:["Ranged minimum damage","Ranged Min Damage","Min"],rgddps:["Ranged DPS","Ranged DPS","DPS"],rgdhastertng:["Ranged haste rating","Ranged Haste","Haste"],rgdhitrtng:["Ranged hit rating","Ranged Hit","Hit"],rgdspeed:["Ranged speed","Ranged Speed","Speed"],sepbasestats:"Base stats",sepdefensivestats:"Defensive stats",sepindividualstats:"Individual stats",sepoffensivestats:"Offensive stats",sepresistances:"Resistances",sepweaponstats:"Weapon stats",shares:["Shadow resistance","Shadow Resist","ShaR"],shasplpwr:["Shadow spell power","Shadow Power","ShaP"],speed:["Speed","Speed","Speed"],spi:["Spirit","Spi","Spi"],splcritstrkrtng:["Spell critical strike rating","Spell Crit","Crit"],spldmg:["Damage done by spells","Spell Damage","Dmg"],splheal:["Healing done by spells","Healing","Heal"],splpwr:["Spell power","Spell Power","SP"],splhastertng:["Spell haste rating","Spell Haste","Haste"],splhitrtng:["Spell hit rating","Spell Hit","Hit"],splpen:["Spell penetration","Spell Pen","Pen"],sta:["Stamina","Sta","Sta"],str:["Strength","Str","Str"],pvppower:["PvP Power","PvPPower","PvPPower"]}},h={colorLinks:"colorlinks",iconizeLinks:"iconizelinks",renameLinks:"renamelinks"},g=WH.TERMS||{genericequip_tip:'<span class="q2">Equip: Increases your $1 by \x3c!--rtg$2--\x3e$3.</span><br />',reforged_format:"Reforged ($1 $2 &rarr; $1 $3)"},f={0:"enus",1:"kokr",2:"frfr",3:"dede",4:"zhcn",6:"eses",7:"ruru",8:"ptbr",9:"itit"},m=320,W=0,H=5,E=3,T=4,v=1,S=2,I=[{},{top:!1},{right:!1},{right:!1,top:!1}],y=/([a-zA-Z0-9-]+)=?([^&?#]*)/g,_=(()=>{let e={};return Object.entries(d).forEach((([a,i])=>{let s=parseInt(a);if(s<0)return void(e[i.path]=s);let o=n.getGame(s),r=o===t.WOW?"":`${t.getKey(o)}-`;n.getHistoricalDetailPageNames(s).forEach((t=>e[r+t]=s))})),e})(),b="(?![^/?&#])",w="^https?://(.+?)?\\.?(?:wowhead)\\.com(?:\\:\\d+)?/",A=new RegExp(w+"\\??("+p[WH.dataTree.RETAIL].join("|")+")[=/](?:[^/?&#]+-)?(-?\\d+(?:\\.\\d+)?)"+b),L=new RegExp(w+"(guide)s?/([^?&#]+)"),C=[WH.dataEnv.MAIN,WH.dataEnv.PTR,WH.dataEnv.PTR2,WH.dataEnv.BETA,WH.dataEnv.CATA,WH.dataEnv.D4,WH.dataEnv.D4PTR,WH.dataEnv.WRATH,WH.dataEnv.DI,WH.dataEnv.TBC,WH.dataEnv.CLASSIC,WH.dataEnv.D2].map((e=>{let a=WH.getDataTree(e),n=t.getByTree(a),i=p[a],s=t.getSelectorByDataEnv(e),o="^https?://(?:\\w+\\.)*wowhead\\.com(?:\\:\\d+)?"+(s?`/${s}`:"")+"/(?:(\\w\\w)/)?",r="("+i.join("|")+")";return{detailPagePrefix:n===t.WOW?"":`${t.getKey(n)}-`,envId:e,prefixedDetailPageNames:n===t.WOW?[]:i.filter((e=>"guide"!==e)),regexFrontPaths:new RegExp(o+r+"/(?:[^/?&#]+-)?(\\d+)"+b),regexGuidePaths:new RegExp(o+"(guide)s?/([^?&#]+)"),regexLegacyPaths:new RegExp(o+r+"=(-?\\d+(?:\\.\\d+)?)"),treeId:a}})),R=-1,M=0,N=1,O=0,D=1,P=2,x=3,k=4,B=5,F={[D]:"loading",[B]:"loading",[P]:"error",[O]:"loading",[x]:"error",[k]:"ok"},U=[n.GUIDE],G={0:{achievementComplete:"Achievement earned by $1 on $2/$3/$4",loading:"Loading…",noResponse:"No response from server :(",notFound:"%s Not Found"},1:{achievementComplete:"$1이(가) $2/$3/$4에 업적을 달성함",loading:"로딩 중…",noResponse:"서버가 응답하지 않습니다 :(",notFound:"%s 을(를) 찾을 수 없음"},2:{achievementComplete:"Haut-fait reçu par $1 le $2/$3/$4",loading:"Chargement…",noResponse:"Pas de réponse du serveur :(",notFound:"%s non trouvé"},3:{achievementComplete:"Erfolg wurde von $1 am $3.$2.$4 errungen",loading:"Lädt…",noResponse:"Keine Antwort vom Server :(",notFound:"%s nicht gefunden"},4:{achievementComplete:"$1在$2/$3/$4上获得成就",loading:"正在载入…",noResponse:"服务器没有响应 :(",notFound:"%s未找到"},6:{achievementComplete:"Logro conseguido por $1 el $2/$3/$4",loading:"Cargando…",noResponse:"No hay respuesta del servidor :(",notFound:"%s no encontrado/a"},7:{achievementComplete:"$1 получил(а) это достижение $2/$3/$4",loading:"Загрузка…",noResponse:"Нет ответа от сервера :(",notFound:"%s не найдено"},8:{achievementComplete:"Conquista conseguida por $1 em $3/$2/$4",loading:"Carregando…",noResponse:"Sem resposta do servidor :(",notFound:"%s não encontrado(a)"},9:{achievementComplete:"Impresa compiuta da $1 su $2/$3/$4",loading:"Caricamento…",noResponse:"Nessuna risposta dal server :(",notFound:"%s Non Trovato"}},q=WH.Device.isTouch(),$={cursorX:void 0,cursorY:void 0,enabled:!0,element:void 0,elements:{icon:void 0,logo:void 0,screen:void 0,screenCaption:void 0,screenInnerBox:void 0,screenInnerWrapper:void 0,tooltip:void 0,tooltip2:void 0,tooltipTable:void 0,tooltipTable2:void 0,tooltipTd:void 0,tooltipTd2:void 0},showScreenshots:!1,initiatedByUser:!1,iScroll:null,mobileScrollInitialized:!1,show:{dataEnv:void 0,fullId:void 0,hasLogo:!0,locale:void 0,mode:W,params:{},type:void 0},showCharacterCompletion:!WH.REMOTE,showIcon:!1,showSecondary:!1,showingTooltip:!1,touchElement:void 0,usingScreen:!1};function z(e,t){if(e.classList)for(let a=0,n=t.length;a<n;a++)e.classList.add(t[a]);else for(var a=0;a<t.length;a++){let n=e.getAttribute&&e.getAttribute("class")||"";(" "+n+" ").indexOf(" "+t[a]+" ")<0&&e.setAttribute("class",(n?n+" ":"")+t[a])}}function j(e,t){let a=WH.reforgeStats?.[t];if(!a)return e;let n,i=[a.i1];for(let e in WH.individualToGlobalStat)WH.individualToGlobalStat[e]===i[0]&&i.push(e);if((n=e.match(new RegExp("(\x3c!--(stat|rtg)("+i.join("|")+")--\x3e)[+-]?([0-9]+)")))&&!e.match(new RegExp("\x3c!--(stat|rtg)"+a.i2+"--\x3e[+-]?[0-9]+"))){let t=Math.floor(n[4]*a.v),i=u.traits[a.s2][0];e=(e=(e=6==a.i2?e.replace("\x3c!--rs--\x3e","<br />+"+t+" "+i):e.replace("\x3c!--rr--\x3e",WH.sprintfGlobal(g.genericequip_tip,i.toLowerCase(),a.i2,t))).replace(n[0],n[1]+(n[4]-t))).replace("\x3c!--rf--\x3e",'<span class="q2">'+WH.sprintfGlobal(g.reforged_format,t,u.traits[a.s1][2],u.traits[a.s2][2])+"</span><br />")}return e}function Y(e,t,a,n){n?e.dataset.status=F[n]:delete e.dataset.status;let i=t&&WH.Game.getKey(WH.Game.getByEnv(t));i?e.dataset.game=i:delete e.dataset.game;let s=t&&WH.getDataTreeKey(WH.getDataTree(t));s?e.dataset.tree=s:delete e.dataset.tree;let o=t&&WH.getDataEnvKey(t);o?e.dataset.env=o:delete e.dataset.env;let r=a&&WH.Types.getReferenceName(a);r?e.dataset.type=r:delete e.dataset.type}function K(){WH.aE(document,"keydown",(function(t){if(27===t.keyCode)e.clearTouchTooltip(),me()})),q?Q():WH.aE(document,"mouseover",Ae),K=()=>{}}function V(e){e.dataset&&"true"!==e.dataset.hasWhTouchEvent&&(null==e.onclick?e.onclick=Le:WH.aE(e,"click",Le),e.dataset.hasWhTouchEvent="true")}function Q(e){q&&_e((function(){e=e||document.body;for(var t=WH.gE(e,"a"),a=0,n=t.length;a<n;a++)V(t[a])}))}function J(e,t){t.style.maxHeight=null,delete e.whttHeightCap,delete e.dataset.height,e.style.maxHeight=null}function X(e,t){let a=WH.ce("div",{className:"wowhead-tooltip"}),n=WH.ce("table"),i=WH.ce("tbody"),s=WH.ce("tr"),o=WH.ce("tr"),r=WH.ce("td"),l=WH.ce("th",{style:{backgroundPosition:"top right"}}),c=WH.ce("th",{style:{backgroundPosition:"bottom left"}}),d=WH.ce("th",{style:{backgroundPosition:"bottom right"}}),p={tooltip:a};return e&&(r.innerHTML=e),WH.ae(s,r),WH.ae(s,l),WH.ae(i,s),WH.ae(o,c),WH.ae(o,d),WH.ae(i,o),WH.ae(n,i),t||(p.icon=WH.ce("div",{className:"whtt-tooltip-icon",style:{visibility:"hidden"}}),WH.ae(a,p.icon)),WH.ae(a,n),t||(p.logo=WH.ce("div",{className:"wowhead-tooltip-powered"}),WH.ae(a,p.logo)),p}function Z(t,a,n,i,s){var o=le(t,a,s=s||{});$.show.type=t,$.show.fullId=o,$.show.dataEnv=n,$.show.locale=i,$.show.params=s,Je.isLoaded(t,n);let r=e.getEntity(t,o,n,i);r.status===k||r.status===x?Ke():r.status===D||r.status===B?-1===WH.inArray(U,t)&&Ye(r.status,i,de(i,"loading")):De(t,a,n,i,-1!==WH.inArray(U,t),s)}function ee(e){return!(!e||!e.icon&&!e.iconImageHash)}function te(e,t){let a=WH.qs("table",e),n=WH.qs("td",a),i=n.childNodes;if(e.classList.remove("tooltip-slider"),i.length>=2&&"TABLE"===i[0].nodeName&&"TABLE"===i[1].nodeName){let s=i[0],o=i[1];s.style.whiteSpace="nowrap";let r=parseInt(e.style.width);e.slider&&r||(r=Math.max(s.getBoundingClientRect().width,o.getBoundingClientRect().width)+20),r>m&&(s.style.whiteSpace=null);for(let e=2;e<i.length;e++)"BLOCKQUOTE"===i[e].nodeName&&(r=Math.max(r,i[e].getBoundingClientRect().width+20));r=Math.min(m,r),r>20&&(e.slider&&(Slider.setSize(e.slider,r-6),e.classList.add("tooltip-slider")),e.classList.add("wowhead-tooltip-width-restriction"),e.classList.add("wowhead-tooltip-width-"+r),e.style.width=r+"px",WH.qsa(":scope > table",n).forEach((e=>e.style.width="100%")),t&&e.offsetHeight>he()&&a.classList.add("shrink"))}else if(i.length&&e.slider){let n=i[0],s="TABLE"===n.nodeName;s&&(n.style.whiteSpace="nowrap");let o=parseInt(e.style.width);!o&&s?(o=n.getBoundingClientRect().width+20,o>m&&(n.style.whiteSpace=null)):o=a.getBoundingClientRect().width+20,o=Math.min(m,o),o>20&&(e.style.width=o+"px",s&&(n.style.width="100%"),e.slider&&(Slider.setSize(e.slider,o-6),e.classList.add("tooltip-slider")),t&&e.offsetHeight>he()&&a.classList.add("shrink"))}}function ae(e){te(e,!1),Ue(e,!0)}function ne(e){if($.elements.tooltip)try{$.elements.tooltip.dispatchEvent(new Event(e))}catch(t){try{let t=document.createEvent("Event");t.initEvent(e,!0,!0),$.elements.tooltip.dispatchEvent(t)}catch(e){}}}function ie(){let e=[];for(let t=0;t<document.links.length;t++)e.push(document.links[t]);return e}function se(e){if("object"==typeof d[e]){if(WH.REMOTE&&d[e].hasOwnProperty("maxId"))return{min:d[e].hasOwnProperty("minId")?d[e].minId:1,max:d[e].maxId}}else WH.error("Wowhead tooltips could not find config for entity type.",e)}function oe(e){return"object"!=typeof d[e]?(WH.error("Wowhead tooltips could not find config for entity type.",e),"Entity"):d[e].name}function re(e){return"object"!=typeof d[e]?(WH.error("Wowhead tooltips could not find config for entity type.",e),"unknown"):d[e].path}function le(e,t,a){return a.build?t+"build"+a.build:t+(a.rand?"r"+a.rand:"")+(a.ench?"e"+a.ench.join(","):"")+(a.gems?"g"+a.gems.join(","):"")+(a.sock?"s":"")+(a.twtbc?"twtbc":"")+(a.twwotlk?"twwotlk":"")+(a.twcata?"twcata":"")+(a.twmists?"twmists":"")+(a.twwod?"twwod":"")+(a.ilvl?"ilvl"+a.ilvl:"")+(a.lvl?"lvl"+a.lvl:"")+(a.gem1lvl?"g1lvl"+a.gem1lvl:"")+(a.gem2lvl?"g2lvl"+a.gem2lvl:"")+(a.gem3lvl?"g3lvl"+a.gem3lvl:"")+(a.artk?"ak"+a.artk:"")+(a.nlc?"nlc"+a.nlc:"")+(a.transmog?"transmog"+a.transmog:"")+(a.tink?"tink"+a.tink:"")+(a.pvp?"pvp":"")+(a.bonus?"b"+a.bonus.join(","):"")+(a.gem1bonus?"g1b"+a.gem1bonus.join(","):"")+(a.gem2bonus?"g2b"+a.gem2bonus.join(","):"")+(a.gem3bonus?"g3b"+a.gem3bonus.join(","):"")+(a["crafted-stats"]?"craftedStats"+a["crafted-stats"].join(","):"")+(a["crafting-quality"]?"craftingQuality"+a["crafting-quality"]:"")+(a.q?"q"+a.q:"")+(a.level?"level"+a.level:"")+(a.abil?"abil"+a.abil.join(","):"")+(a.dd?"dd"+a.dd:"")+(a.ddsize?"ddsize"+a.ddsize:"")+(a.diff===n.SPELL?"diff"+a.diff:"")+(a.def?"def"+a.def:"")+(a.rank?"rank"+a.rank:"")+(a.alt?"alt"+a.alt.join(","):"")+(a.awakened?"awakened"+a.awakened:"")+(a.class?"class"+a.class:"")+(e!==n.SPELL&&a.spec?"spec"+a.spec:"")+(a.rewards?"rewards"+a.rewards.join(":"):"")+(a["azerite-powers"]?"azPowers"+a["azerite-powers"]:"")+(a["azerite-essence-powers"]?"aePowers"+a["azerite-essence-powers"]:"")+(a.nomajor?"nomajor":"")+(a.affixes?"affixes"+a.affixes.join(","):"")+(a.board?"board"+a.board:"")+(a.glyph?"glyph"+a.glyph:"")+(a.greaterAffixes?"greaterAffixes"+a.greaterAffixes.join(","):"")+(a.itemPower?"itemPower"+a.itemPower:"")+(a.itemType?"itemType"+a.itemType:"")+(a.masterworking?"masterworking"+a.masterworking.join(","):"")+(a.hasOwnProperty("mod")?"mod"+a.mod:"")+(a.mods?"mods"+a.mods.join(","):"")+(a.nodes?"nodes"+a.nodes.join(","):"")+(a.upgrades?"upgrades"+a.upgrades:"")+(a.stars?"stars"+a.stars:"")}function ce(e,t,a){if(WH.REMOTE)return!1;if(!WH.User.isPremium())return!1;if(!$.showScreenshots)return!1;let i=WH.Gatherer.get(e,t,a,!0);if(i){if(i.screenshot&&i.screenshot.id)return[WH.getScreenshotUrl(i.screenshot.id,"small",{imageType:i.screenshot.imageType}),"screenshot"];if(!WH.REMOTE&&e===n.ITEM&&i.jsonequip&&i.jsonequip.displayid){let e=i.jsonequip.displayid,t=i.reqrace||i.jsonequip.races,a=WH.Wow.Models.getRaceIdFromMask(t);(i.classs&&i.classs!==WH.Wow.Item.CLASS_ARMOR||i.jsonequip.slotbak&&!WH.Wow.Item.isArmorInvType(i.jsonequip.slotbak))&&(a=void 0);let n=Listview.funcBox.getCurrentItemBonuses.call(this,i),s=g_items.getAppearance(i.id,n);if(s&&s[0]&&(e=s[0]),e)return[WH.Wow.Item.getThumbUrl(e,a),"screenshot"]}}return!1}function de(e,t){return(G[e]||G[0])[t]||""}function pe(e){var t=ue();return t?t.hasOwnProperty(e)?t[e]:h[e]&&t.hasOwnProperty(h[e])?t[h[e]]:null:null}function ue(){return"object"==typeof whTooltips?whTooltips:"object"==typeof wowhead_tooltips?wowhead_tooltips:null}function he(){let e=document.documentElement,t=document.body;return Math.max(t.offsetHeight,t.scrollHeight,e.clientHeight,e.offsetHeight,e.scrollHeight)}function ge(){return($.show.params&&$.show.params.buff?"buff":"")+"spells"}function fe(e){var t="tooltip";return $.show.params&&$.show.params.buff&&(t="buff"),$.show.params&&$.show.params.text&&(t="text"),$.show.params&&$.show.params.premium&&(t="tooltip_premium"),t+(e||"")}function me(){if($.elements.tooltip){let e=$.elements.tooltip;$.showingTooltip=!1,e.style.display="none",Ue(e,!1),$.elements.tooltipTable.className="";let t=(e.whttHeightCap||{}).innerScroll;t&&J(e,t),ke(),WH.WAS&&WH.WAS.restoreHidden(),ne("hide")}$.elements.tooltip2&&($.elements.tooltip2.style.display="none",Ue($.elements.tooltip2,!1),$.elements.tooltipTable2.className="")}function We(e,t){if(WH.REMOTE||!WH.isRetailTree(t.dataEnv))return e;let a=WH.Profiler.getFavorite(!0);return a?((WH.User.Completion.getByType(WH.Types.ACHIEVEMENT)[a.id]||[]).includes(parseInt(t.fullId))?e=e.replace(new RegExp("\x3c!--cr\\d+:[^<]+","g"),'<span class="q2">$&</span>'):(WH.User.Completion.getAchievementCriteria()[t.fullId]||[]).forEach((t=>{e=e.replace(new RegExp("\x3c!--cr"+t+":[^<]+","g"),'<span class="q2">$&</span>')})),e):e}function He(e,i,s,o){o&&a.isValidSize(o)||(o="tiny");let r=s.icon;switch(WH.Types.getGame(i)){case t.WOW:r=r.toLowerCase();break;case t.D4:r=s.iconImageHash}if("tiny"===o){let s=n.getGame(i),o=a.getIconUrl(r,a.TINY,t.getEnv(s));z(e,["icontinyl"]),e.dataset.game=t.getKey(s),e.dataset.type=n.getStringId(i),e.style.backgroundImage="url("+o+")"}else{if("true"===e.getAttribute("data-wh-icon-added"))return;WH.aef(e,a.createByEntity(s,i,null,{size:o,span:!0}))}e.setAttribute("data-wh-icon-added","true")}function Ee(){var e=pe("hide");if(!e)return;if(!document.styleSheets)return;var t=document.createElement("style");t.type="text/css",document.head.appendChild(t),window.createPopup||document.head.appendChild(WH.ct(""));let a=document.styleSheets[document.styleSheets.length-1];for(var n in e)e.hasOwnProperty(n)&&e[n]&&(a.insertRule?a.insertRule(".wowhead-tooltip .whtt-"+n+"{display: none}",a.cssRules.length):a.addRule&&a.addRule(".wowhead-tooltip .whtt-"+n,"display: none",-1));Ee=()=>{}}function Te(e){return"object"!=typeof d[e]?(WH.error("Wowhead tooltips could not find config for entity type.",e),!1):d[e].mobile}function ve(t,a,n,i){let s=e.getEntity(t,a,n,i);s.status=P,$.show.type===t&&$.show.fullId===a&&$.show.dataEnv===n&&$.show.locale===i&&Ye(s.status,i,de(i,"noResponse"))}function Se(e,t,a,n,i,s){if(!$.elements.tooltip)return;let o=$.elements.tooltip;o.style.left="-1000px",o.style.top="-1000px",o.style.width=null,o.style.maxWidth=m+"px";let r=o.getBoundingClientRect().width,l=$.elements.tooltip2;l.style.left="-1000px",l.style.top="-1000px",l.style.width=null,l.style.maxWidth=m+"px";let c,d,p=$.showSecondary?l.getBoundingClientRect().width:0;if(o.style.maxWidth=null,l.style.maxWidth=null,o.style.width=r?r+"px":"auto",l.style.width=p+"px",e||t){let e=o.whttHeightCap,t=(e||{}).maxHeight||window.innerHeight,a=(e||{}).innerScroll;if(o.offsetHeight>=t){if((a=a||WH.qs(".whtt-scroll",o))&&(o.dataset.height="restricted",o.style.maxHeight=t+"px",!e)){let e=o.scrollHeight-o.offsetHeight;a.style.maxHeight=a.scrollHeight-e+"px",o.whttHeightCap={innerScroll:a,maxHeight:o.offsetHeight}}}else a&&J(o,a)}for(let o=0,r=I.length;o<r;++o){let r=I[o];if(c=Ie(e,t,a,n,i,s,r.right,r.top),WH.WAS&&!WH.WAS.intersect(c)){d=!0;break}if(!WH.WAS)break}WH.WAS&&!d&&WH.WAS.intersect(c,!0),o.style.left=c.l+"px",o.style.top=c.t+"px",Ue(o,!0),$.showSecondary&&(l.style.left=c.l+r+"px",l.style.top=c.t+"px",Ue(l,!0)),ne("move")}function Ie(e,t,a,n,i,s,o,r){let l=e,c=t,d=$.elements.tooltip,p=$.elements.tooltip.getBoundingClientRect(),u=p.width,h=p.height,g=$.elements.tooltip2.getBoundingClientRect(),f=$.showSecondary?g.width:0,m=$.showSecondary?g.height:0,W=WH.getWindowSize(),H=WH.getScroll(),E=H.x,T=H.y,v=H.x+W.w,S=H.y+W.h;return"fixed"===d.style.position&&(l-=e-=H.x,c-=t-=H.y,H={x:0,y:0},E=T=0,v=W.w,S=W.h),window.ZUL?.getEnabled()&&(T+=ZUL.HEIGHT),null==o&&(o=e+a+u+f<=v),null==r&&(r=t-Math.max(h,m)>=T),o?e+=a+i:e=Math.max(e-(u+f),E)-i,r?t-=Math.max(h,m)+s:t+=n+s,e<E?e=E:e+u+f>v&&(e=v-(u+f)),t<T?t=T:t+Math.max(h,m)>S&&(t=Math.max(H.y,S-Math.max(h,m))),$.showIcon&&l>=e-48&&l<=e&&c>=t-4&&c<=t+48&&(t-=48-(c-t)),WH.createRect(e,t,u,h)}function ye(t,a,i,o,r,l,c,d){if(!d.ctrlKey||2!==d.button)return;d.preventDefault(),d.stopPropagation();let p=WH.DOM.getData(this,"menu");if(p)return void Menu.show(p,this);p=[];let u=e.getEntity(i,le(i,r,l),t,a);u.data.name&&p.push(Menu.createItem({label:WH.term("copy_format",WH.TERMS.name),url:WH.copyToClipboard.bind(void 0,u.data.name)})),p.push(Menu.createItem({label:WH.term("copy_format",WH.TERMS.id),url:WH.copyToClipboard.bind(void 0,r)}));let h=c;!h&&n.existsInDataEnv(i)&&(h=WH.Entity.getUrl(i,r,void 0,void 0,t,a)),h&&p.push(Menu.createItem({label:WH.term("copy_format",WH.TERMS.url),url:WH.copyToClipboard.bind(void 0,c)}));let g=s[o]||o;if(WH.markup.tags[g]){let e="";i===WH.Types.SPELL&&l.def&&l.rank&&(e+=` def=${l.def} rank=${l.rank}`),p.push(Menu.createItem({label:WH.term("copy_format",WH.TERMS.wowheadMarkupTag),url:WH.copyToClipboard.bind(void 0,`[${g}=${r}${e}]`)}))}Menu.add(this,p,{noEvents:!0,showAtElement:!0,showImmediately:!0},d)}function _e(e){"loading"===document.readyState?document.addEventListener("DOMContentLoaded",e):e()}function be(e){Qe(e),Se($.cursorX,$.cursorY,0,0,r,l)}function we(){$.show.type=void 0,$.element=void 0,me()}function Ae(e){let t=e.target,a=0;for(;t&&a<5&&Pe(t,e)===R;)t=t.parentNode,a++}function Le(e){let t=this;if(!0===t.hasWHTouchTooltip)return;let a,n=0;for(;t&&n<5&&(a=Pe(t,e))===R;)t=t.parentNode,n++;return a===N?($.touchElement&&($.touchElement.removeAttribute("data-showing-touch-tooltip"),$.touchElement.hasWHTouchTooltip=!1),$.touchElement=t,$.touchElement.hasWHTouchTooltip=!0,e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),!1):void 0}function Ce(e,t,a){switch(t){case"awakened":case"buff":case"map":case"noimage":case"nomajor":case"notip":case"premium":case"pvp":case"sock":case"text":case"twcata":case"twmists":case"twtbc":case"twwod":case"twwotlk":e[t]=!0;break;case"artk":case"board":case"c":case"class":case"covenant":case"crafting-quality":case"dd":case"ddsize":case"def":case"diff":case"diffnew":case"gem1lvl":case"gem2lvl":case"gem3lvl":case"glyph":case"ilvl":case"itemPower":case"itemType":case"level":case"lvl":case"mod":case"nlc":case"pwr":case"q":case"rand":case"rank":case"spec":case"stars":case"tink":case"upgrades":e[t]=parseInt(a);break;case"abil":case"affixes":case"alt":case"azerite-essence-powers":case"azerite-powers":case"bonus":case"crafted-stats":case"cri":case"ench":case"forg":case"gem1bonus":case"gem2bonus":case"gem3bonus":case"gems":case"greaterAffixes":case"know":case"masterworking":case"mods":case"nodes":case"pcs":case"rewards":case"spellModifier":e[t]=a.split(":");break;case"build":case"domain":case"gender":case"who":e[t]=a;break;case"image":"premium"===a?e[a]=!0:e[t]=a?"_"+a:"";break;case"transmog":e[t]="hidden"===a?a:parseInt(a);break;case"when":e[t]=new Date(parseInt(a))}}function Re(t,a,i,s){switch(s.type){case n.ACHIEVEMENT:t=We(t,s),window.requestAnimationFrame(i.bind(null,t));break;case n.AZERITE_ESSENCE_POWER:let o=e.getEntity(s.type,s.fullId,s.dataEnv,s.locale);if(!(!s.params.spec||s.params.know&&s.params.know.length)){Je.getSpellsBySpec(s.params.spec,(function(e){t=t.replace(/<!--embed:([^>]+)-->/g,(function(t,a){return WH.setTooltipSpells(o.data.embeds[a].tooltip,e,o.data.embeds[a].spells)})),i(t)}));break}t=t.replace(/<!--embed:([^>]+)-->/g,(function(e,t){return WH.setTooltipSpells(o.data.embeds[t].tooltip,s.params.know,o.data.embeds[t].spells)})),window.requestAnimationFrame(i.bind(null,t));break;case n.SPELL:if(s.params.spec&&(!s.params.know||!s.params.know.length)){Je.getSpellsBySpec(s.params.spec,(function(e){t=WH.setTooltipSpells(t,e,a),i(t)}));break}window.requestAnimationFrame(i.bind(null,t));break;default:window.requestAnimationFrame(i.bind(null,t))}}function Me(e,a,n,i,s){if(!$.elements.tooltip){let e=X();$.elements.icon=e.icon,$.elements.logo=e.logo;let t=e.tooltip;t.style.left=t.style.top="-2323px",$.elements.tooltip=t,$.elements.tooltipTable=WH.gE(t,"table")[0],$.elements.tooltipTd=WH.gE(t,"td")[0];let a=X(void 0,!0).tooltip;a.style.left=a.style.top="-2323px",$.elements.tooltip2=a,$.elements.tooltipTable2=WH.gE(a,"table")[0],$.elements.tooltipTd2=WH.gE(a,"td")[0]}Y($.elements.tooltip,e,a,s),Y($.elements.tooltip2,e,a,s);let o=!0===n?"fixed":"absolute";$.elements.tooltip.style.position=o,$.elements.tooltip2.style.position=o;let r=i||document.fullscreenElement||document.body;WH.ae(r,$.elements.tooltip),WH.ae(r,$.elements.tooltip2);let l=t.getByEnv(e);l!==t.get()&&WH.Fonts.load(l)}function Ne(){if($.elements.screen)$.elements.screen.style.display="block";else{$.elements.screen=WH.ce("div",{id:"wowhead-tooltip-screen",className:"wowhead-tooltip-screen"});let e=WH.ce("a",{id:"wowhead-tooltip-screen-close",className:"wowhead-tooltip-screen-close",onclick:WH.Tooltips.clearTouchTooltip});$.elements.screenInnerWrapper=WH.ce("div",{id:"wowhead-tooltip-screen-inner-wrapper",className:"wowhead-tooltip-screen-inner-wrapper"});let t=WH.ce("div",{id:"wowhead-tooltip-screen-inner",className:"wowhead-tooltip-screen-inner"});$.elements.screenInnerBox=WH.ce("div",{id:"wowhead-tooltip-screen-inner-box",className:"wowhead-tooltip-screen-inner-box"}),$.elements.screenCaption=WH.ce("div",{id:"wowhead-tooltip-screen-caption",className:"wowhead-tooltip-screen-caption"}),WH.ae($.elements.screen,e),WH.ae(t,$.elements.screenInnerBox),WH.ae($.elements.screenInnerWrapper,t),WH.ae($.elements.screen,$.elements.screenInnerWrapper),WH.ae($.elements.screen,$.elements.screenCaption),WH.ae(document.body,$.elements.screen)}$.usingScreen=!0,function(){if(!$.mobileScrollInitialized){let e=function(e){$.usingScreen&&(document.getElementById("wowhead-tooltip-screen-inner").contains(e.target)||e.preventDefault())};WH.aE(document.body,"touchmove",e),WH.aE(document.body,"mousewheel",e),$.mobileScrollInitialized=!0}"function"==typeof IScroll&&setTimeout((function(){$.iScroll&&($.iScroll.destroy(),$.iScroll=null),$.iScroll=new IScroll($.elements.screenInnerWrapper,{mouseWheel:!0,tap:!0})}),1)}()}function Oe(e,t,a,n){if("string"==typeof(e="function"==typeof e?e.call(n.target,n):e)){void 0===t&&e.length<30&&(t=!0);let n=[];t&&n.push(' class="no-wrap"'),a&&!isNaN(a)&&n.push(' style="max-width:'+a+'px"'),n.length&&(e=`<div${n.join("")}>${e}</div>`)}return e}function De(t,a,i,s,o,r){var l=le(t,a,r);let c=e.getEntity(t,l,i,s);if(c.status!==O&&c.status!==P)return;c.status=D;var d=se(t);if(d&&(parseInt(a,10)<d.min||parseInt(a,10)>d.max))return void e.register(t,a,i,s,{error:"ID is out of range"});o||(c.timer=setTimeout(je.bind(this,t,l,i,s),333));var p=[];for(var u in r)switch(u){case"spec":if(t===n.SPELL||t===n.AZERITE_ESSENCE_POWER)break;case"abil":case"affixes":case"alt":case"artk":case"awakened":case"azerite-essence-powers":case"azerite-powers":case"board":case"bonus":case"build":case"class":case"covenant":case"crafted-stats":case"crafting-quality":case"dd":case"ddsize":case"def":case"diff":case"diffnew":case"ench":case"gem1bonus":case"gem1lvl":case"gem2bonus":case"gem2lvl":case"gem3bonus":case"gem3lvl":case"gems":case"gender":case"glyph":case"greaterAffixes":case"ilvl":case"itemPower":case"itemType":case"level":case"lvl":case"masterworking":case"mod":case"mods":case"nlc":case"nodes":case"nomajor":case"pvp":case"q":case"rand":case"rank":case"rewards":case"sock":case"stars":case"tink":case"transmog":case"twcata":case"twmists":case"twtbc":case"twwod":case"twwotlk":case"upgrades":"object"==typeof r[u]?p.push(u+"="+r[u].join(":")):!0===r[u]?p.push(u):p.push(u+"="+r[u])}p.push("dataEnv="+i),p.push("locale="+s),i!==WH.dataEnv.PTR&&i!==WH.dataEnv.PTR2&&i!==WH.dataEnv.BETA||"0"!==WH.getDataCacheVersion(i)&&p.push(WH.getDataCacheVersion(i)),Je.isLoaded(t,i)||Je.fetch(t,i),t===n.ITEM&&r&&r.hasOwnProperty("lvl")&&!Je.isLoaded(n.SPELL,i)&&Je.fetch(n.SPELL,i);let h=p.length?"?"+p.join("&"):"",g="https://db.newbeebox.com/wow/tooltip2/"+re(t)+"/"+a+h;WH.xhrJsonRequest(g,function(t,a,n,i,s,o){o?(o.error&&(U.includes(t)||WH.error("Wowhead tooltip request responded with an error.",o.error,oe(t)+" #"+a)),e.register(t,n,i,s,o)):WH.error("Wowhead tooltips failed to load entity data.",oe(t)+" #"+a)}.bind(null,t,a,l,i,s))}function Pe(a,s,o){if(s&&a.dataset&&a.dataset.simpleTooltip)return q||a.onmouseout||("attach"!==a.dataset.tooltipMode&&(a.onmousemove=be),a.onmouseout=we),Ge(a,a.dataset.simpleTooltip.length<30?'<div class="no-wrap">'+a.dataset.simpleTooltip+"</div>":a.dataset.simpleTooltip),N;if("A"!==a.nodeName&&"AREA"!==a.nodeName)return R;var r=a.rel;try{a.dataset&&a.dataset.hasOwnProperty("wowhead")?r=a.dataset.wowhead:a.getAttribute&&a.getAttribute("data-wowhead")&&(r=a.getAttribute("data-wowhead"))}catch(e){}let l=a.href;if(!l.length&&!r||r&&/^np\b/.test(r)||"true"===a.getAttribute("data-disable-wowhead-tooltip")||q&&"true"===a.getAttribute("data-disable-wowhead-touch-tooltip"))return M;if(/(?:^|\.)wow(?:classic)?db\.com$/.test(new URL(l).hostname))return M;let d=l.match(/^https?:\/\/(?:[^/]+\.)?(classic|tbc)\.(?:[^/]+\.)?wowhead\.com\/talent-calc\/embed\/[^#]+/);if(d||(d=l.match(/^https?:\/\/(?:[^/]+\.)?wowhead\.com\/(classic|tbc|wotlk)\/talent-calc\/embed\/[^#]+/)),WH.REMOTE&&d){let e=513,t=750;"tbc"===d[1]?e+=120:"wotlk"===d[1]&&(e+=517);let n=e/t*100+"%";return a.parentNode.replaceChild(WH.ce("div",{style:{margin:"10px auto",maxHeight:e+"px",maxWidth:t+"px"},className:"wowhead-embed wowhead-embed-talent-calc"},WH.ce("div",{style:{height:0,paddingTop:n,position:"relative",width:"100%"}},WH.ce("iframe",{src:d[0],width:"100%",height:"100%",style:{border:0,left:0,position:"absolute",top:0,borderRadius:"6px"},sandbox:"allow-scripts allow-top-navigation"}))),a),N}let u=l.match(/^https?:\/\/(?:[^/]+\.)?wowhead\.com\/soulbind-calc\/embed\/.+/);if(WH.REMOTE&&u)return a.parentNode.replaceChild(WH.ce("div",{style:{maxWidth:"734px",maxHeight:"1060px",margin:"10px auto"},className:"wowhead-embed wowhead-embed-soulbind-calc"},WH.ce("div",{style:{position:"relative",width:"100%",height:0,paddingTop:"144.5%"}},WH.ce("iframe",{src:u[0],width:"100%",height:"100%",style:{border:0,left:0,position:"absolute",top:0,borderRadius:"6px"},sandbox:"allow-scripts allow-top-navigation"}))),a),N;if(WH.REMOTE){let e=/^https?:\/\/(?:[^/]+\.)?wowhead\.com\/(?:(?:ptr|ptr-2|beta)\/)?(?:\w\w\/)?talent-calc\/embed\/.+/,t=l.match(e);if(t)return a.parentNode.replaceChild(WH.ce("div",{style:{minHeight:"680px",position:"relative"},className:"wowhead-embed wowhead-embed-talent-calc"},WH.ce("div",{style:{width:"100%",height:0,paddingTop:"calc(55.555% + 200px)"}},WH.ce("iframe",{src:t[0],width:"100%",height:"100%",style:{border:0,left:0,position:"absolute",top:0,borderRadius:"6px"},sandbox:"allow-scripts allow-top-navigation"}))),a),N}let h=l.match(/^https?:\/\/(?:[^/]+\.)?wowhead\.com\/diablo-2\/skill-calc\/embed\/.+/);if(WH.REMOTE&&h)return a.parentNode.replaceChild(WH.ce("div",{style:{margin:"10px auto"},className:"wowhead-embed wowhead-embed-diablo-2-skill-calc"},WH.ce("div",{style:{position:"relative",width:"100%",height:0,paddingTop:"50%"}},WH.ce("iframe",{src:h[0],width:"100%",height:"100%",style:{border:0,left:0,position:"absolute",top:0,borderRadius:"6px"},sandbox:"allow-scripts allow-top-navigation"}))),a),N;let g,f,m,I,b={};if($.show.params=b,l.startsWith("https://")||l.startsWith("http://")){let e=l.match(A);e||(e=l.match(L)),e?(g=e[1],f=e[2],m=e[3],I=l):C.some((e=>{let t=l.match(e.regexGuidePaths)||p[e.treeId].length&&(l.match(e.regexFrontPaths)||l.match(e.regexLegacyPaths));return t&&(g=(t[1]?t[1]+".":"")+WH.getDataEnvKey(e.envId),f=(e.prefixedDetailPageNames.includes(t[2])?e.detailPagePrefix:"")+t[2],m=t[3],I=l),!!t})),$.show.hasLogo=!1}if(r&&(!f||/\bignore-url\b/.test(r))){let e=[];C.forEach((t=>{e=t.prefixedDetailPageNames.length?e.concat(t.prefixedDetailPageNames.map((e=>t.detailPagePrefix+e))):e.concat(p[t.treeId])})),e=[...new Set(e)];let t=r.match(new RegExp("("+e.join("|")+").?(-?\\d+(?:\\.\\d+)?)"));t&&(f=t[1],m=t[2]),$.show.hasLogo=!0}if(!f)return M;let w=_[f];if(q&&!o&&!Te(w))return M;if(l.replace(y,((e,t,a)=>Ce(b,t,a)||"")),r&&r.replace(y,((e,t,a)=>Ce(b,t,a)||"")),b.gems&&b.gems.length>0){for(j=Math.min(3,b.gems.length-1);j>=0&&!parseInt(b.gems[j]);--j);0===++j?delete b.gems:j<b.gems.length&&(b.gems=b.gems.slice(0,j))}for(var P,x=["bonus","gem1bonus","gem2bonus","gem3bonus"],F=0;P=x[F];F++)if(b[P]&&b[P].length>0){for(j=Math.min(16,b[P].length-1);j>=0&&!parseInt(b[P][j]);--j);0===++j?delete b[P]:j<b[P].length&&(b[P]=b[P].slice(0,j))}if(b["crafted-stats"]&&b["crafted-stats"].length>0){let e=[];for(let t=0;t<Math.min(2,b["crafted-stats"].length);t++){let a=parseInt(b["crafted-stats"][t]);isNaN(a)||e.push(a)}0===e.length?delete b["crafted-stats"]:b["crafted-stats"]=e}if(b.abil&&b.abil.length>0){var U,G=[];for(j=0;j<Math.min(8,b.abil.length);j++)(U=parseInt(b.abil[j]))&&G.push(U);0===G.length?delete b.abil:b.abil=G}if(b.alt&&b.alt.length>0&&(b.alt=b.alt.map((e=>parseInt(e))).filter((e=>!isNaN(e))),0===b.alt.length&&delete b.alt),b.rewards&&b.rewards.length>0){var j;for(j=Math.min(3,b.rewards.length-1);j>=0&&!/^\d+.\d+$/.test(b.rewards[j]);--j);0===++j?delete b.rewards:j<b.rewards.length&&(b.rewards=b.rewards.slice(0,j))}$.element=a;let Y=function(e,a){let n,i={dataEnv:WH.getDataEnv(),locale:Locale.getId()};if(a?n=a.toLowerCase():e&&(n=e.toLowerCase().replace(/(?:^|\.)(staging|dev)$/,"")),void 0!==n){i.dataEnv=WH.dataEnv.MAIN,i.locale=0;let e=n.split("."),a=WH.getLocaleFromDomain.L[e[0]];a&&(i.locale=a,e.shift()),e[0]&&Object.values(WH.dataEnv).some((a=>{if([WH.dataEnvKey[a],t.getSelectorByDataEnv(a)].includes(e[0]))return i.dataEnv=a,!0}))}return WH.isDataEnvActive(i.dataEnv)||(i.dataEnv=WH.getRootEnv(i.dataEnv)),[WH.dataEnv.BETA,WH.dataEnv.PTR,WH.dataEnv.PTR2].indexOf(i.dataEnv)>=0&&(i.locale=0),i}(g,b.domain),K=Y.dataEnv,V=Y.locale,Q=WH.Types.getRequiredTrees(w)||[];if(Q.length&&!Q.includes(WH.getDataTree(K))&&(K=WH.getRootByTree(Q[0])),-1!==l.indexOf("#")&&-1!==document.location.href.indexOf(f+"="+m))return M;if($.show.mode=W,q&&!a.dataset.noTouchLightbox&&document.documentElement.offsetWidth<i)$.show.mode=S;else if(["iconmedium","iconsmall","iconlarge","iconblizzard"].some((e=>a.parentNode?.classList.contains(e)))||"icon"===a.dataset.whattach||"icon"===a.dataset.tooltipMode)$.show.mode=v;else if(q||"true"===a.dataset.whattach||"attach"===a.dataset.tooltipMode)$.show.mode=E;else if(!WH.REMOTE)for(var J=a.parentNode,X=0;J;){if(0===(J.getAttribute&&J.getAttribute("class")||"").indexOf("menu-inner")){$.show.mode=T;break}if(++X>9)break;J=J.parentNode}if(q||a.onmouseout||($.show.mode===W&&(a.onmousemove=be),a.onmouseout=we),$.show.mode===W&&"false"===a.dataset.whtticon&&($.show.mode=H),WH.REMOTE||a.whContextMenuAttached||(a.whContextMenuAttached=!0,WH.aE(a,"contextmenu",ye.bind(a,K,V,w,f,m,b,I))),s&&($.initiatedByUser=!0,Qe(s),$.showingTooltip=!0,Z(w,m,K,V,b)),s||!ue())return N;let te=e.getEntity(w,le(w,m,b),K,V);var ae=[];(pe("renameLinks")&&"false"!==a.getAttribute("data-wh-rename-link")||"true"===a.getAttribute("data-wh-rename-link"))&&ae.push((function(){delete a.dataset.whIconAdded,a.innerHTML="<span>"+te.data.name+"</span>"}));var ne=a.getAttribute("data-wh-icon-size");let ie=a.dataset.whIconizeLink;if(("true"===ie||ne||pe("iconizeLinks"))&&"false"!==ie&&c.includes(w)&&(ne||(ne=pe("iconSize")),ae.push((function(){ee(te.data)&&"true"!==a.dataset.whIconAdded&&He(a,w,te.data,ne)}))),pe("colorLinks"))switch(t.getByEnv(K)){case t.D4:ae.push((()=>{null!=te.data.quality&&z(a,["d4-q"+te.data.quality])}));break;case t.DI:switch(w){case n.DI_EQUIP_ITEM:case n.DI_MISC_ITEM:ae.push((()=>{null!=te.data.inventoryColor&&z(a,["di-ic"+te.data.inventoryColor]),null!=te.data.dropRank&&z(a,["q"+te.data.dropRank])}));break;case n.DI_SET:ae.push((()=>{null!=te.data.inventoryColor&&z(a,["di-ic"+te.data.inventoryColor])}))}break;case t.WOW:ae.push((()=>{null!=te.data.quality&&te.data.quality>-1&&z(a,["q"+te.data.quality])}))}if(ae.length)if(te.status===O||te.status===D)te.callbacks=te.callbacks.concat(ae),te.status===O&&De(w,m,K,V,!0,b);else if(te.status===k||te.status===B)for(;ae.length;)ae.shift()();return N}function xe(t,a,n,i){if($.elements.tooltip.style.width="550px",$.elements.tooltip.style.left="-2323px",$.elements.tooltip.style.top="-2323px",$.elements.tooltip.className="wowhead-tooltip",t.nodeName?(WH.ee($.elements.tooltipTd),WH.ae($.elements.tooltipTd,t)):("wow"===$.elements.tooltip.dataset.game&&(t=e.evalFormulas(t)),$.elements.tooltipTd.innerHTML=t),$.elements.tooltip.style.display="",Ue($.elements.tooltip,!0),te($.elements.tooltip,!0),a?($.showSecondary=!0,$.elements.tooltip2.style.width="550px",$.elements.tooltip2.style.left="-2323px",$.elements.tooltip2.style.top="-2323px",a.nodeName?(WH.ee($.elements.tooltipTd2),WH.ae($.elements.tooltipTd2,a)):$.elements.tooltipTd2.innerHTML=e.evalFormulas(a),$.elements.tooltip2.style.display="",te($.elements.tooltip2,!0)):$.showSecondary=!1,WH.Device.isTouch()){let e=$.showSecondary?$.elements.tooltipTd2:$.elements.tooltipTd,t=WH.ce("a");t.href="javascript:",t.className="wowhead-touch-tooltip-closer",t.onclick=WH.Tooltips.clearTouchTooltip,WH.ae(e,t)}$.elements.tooltipTable.style.display=""==t?"none":"",function(e,t){WH.qsa(":scope > .image",$.elements.tooltipTable.parentNode).forEach((e=>WH.de(e)));let a=typeof e;if("number"===a){let t=WH.getDataSource(),a=e;if(!t[a]||!t[a]["image_"+Locale.getName()])return;e=t[a]["image_"+Locale.getName()]}else if("string"!==a||!e)return;let n=WH.ce("div",{className:"image"+(t?" "+t:""),style:{backgroundImage:"url("+e+")"}});$.elements.tooltipTable.parentNode.insertBefore(n,$.elements.tooltipTable.nextSibling)}(n,i),ne("show")}function ke(e,t,a){Fe($.elements.icon,e?{icon:e}:void 0,t,a)}function Be(e){let t;!1!==e.showIcon&&(ee(e.entity)?t=e.entity:e.iconName&&(t={icon:e.iconName})),Fe($.elements.icon,t,e.type,e.dataEnv)}function Fe(e,t,a,n){WH.ee(e),d[a]?.embeddedIcons&&(t=void 0),ee(t)?(WH.ae(e,WH.Icon.createByEntity(t,a,null,{dataEnv:n,size:WH.Icon.MEDIUM})),e.style.visibility="visible",$.showIcon=!0):(e.style.visibility="hidden",$.showIcon=!1)}function Ue(e,t){t?(e.setAttribute("data-visible","yes"),e.style.visibility="visible"):(e.setAttribute("data-visible","no"),e.style.visibility="hidden")}function Ge(e,t,a,n){if(null==t||!$.enabled)return;(!(n=n||{}).padX||n.padX<1)&&(n.padX=1),(!n.padY||n.padY<1)&&(n.padY=1),a&&(t=Ve(t,a));let i=e.getBoundingClientRect();Me(n.dataEnv,n.type,WH.isElementPositionFixedOrSticky(e),void 0,n.status),Be(n),xe(t,n.finalContent2,n.image,n.imageClass),Se(i.left+window.scrollX,i.top+window.scrollY,i.width,i.height,n.padX,n.padY)}function qe(e,t,a,n){null!=t&&$.enabled&&((!(n=n||{}).padX||n.padX<10)&&(n.padX=10),(!n.padY||n.padY<10)&&(n.padY=10),a&&(t=Ve(t,a),n.finalContent2&&(n.finalContent2=Ve(n.finalContent2,a))),Me(n.dataEnv,n.type,e.target&&WH.isElementPositionFixedOrSticky(e.target),void 0,n.status),Be(n),xe(t,n.finalContent2,n.image,n.imageClass),Se(e.pageX,e.pageY,0,0,n.padX||0,n.padY||0))}function $e(e,t,a,n){null!=e&&$.enabled&&(Me((n=n||{}).dataEnv,n.type,n.fixedPosition,void 0,n.status),Be(n),xe(e,n.finalContent2,n.image,n.imageClass),Se(t,a,0,0,n.padX||0,n.padY||0))}function ze(e,t,a){if(WH.Tooltips.clearTouchTooltip(!0),null==t||!$.enabled)return;a=a||{},Ne(),WH.ee($.elements.screenCaption);let n=WH.ce("a",{innerHTML:WH.isRemote()?"Tap Link":WH.TERMS.taplink,onclick:function(e,t){if(e.setAttribute("data-disable-wowhead-tooltip","true"),e.fireEvent)e.fireEvent("on"+t);else if("function"==typeof MouseEvent)e.dispatchEvent(new MouseEvent(t,{bubbles:!0,cancelable:!0}));else{let a=document.createEvent("Events");a.initEvent(t,!0,!0),e.dispatchEvent(a)}e&&e.removeAttribute("data-disable-wowhead-tooltip"),WH.Tooltips.clearTouchTooltip()}.bind(null,e,"click")}),i=WH.ce("i",{className:"fa fa-hand-o-up"});WH.aef(n,i),WH.ae($.elements.screenCaption,n),Me(a.dataEnv,a.type,!1,$.elements.screenInnerBox,a.status),Be(a),xe(t,a.finalContent2,a.image,a.imageClass),Se()}function je(t,a,n,i){if($.show.type===t&&$.show.fullId===a&&$.show.dataEnv===n&&$.show.locale===i){Ye(D,i,de(i,"loading")),e.getEntity(t,a,n,i).timer=setTimeout(ve.bind(this,t,a,n,i),3850)}}function Ye(t,i,s,c,d,p,u,h,g,m){if(Ee(),!$.initiatedByUser)return;if($.element&&($.element._fixTooltip&&(s=$.element._fixTooltip(s,$.show.type,$.show.fullId,$.element)),$.element._fixTooltip2&&(h=$.element._fixTooltip2(h,$.show.type,$.show.fullId,$.element))),s){if($.show.params){let e=$.show.params;if(e.forg&&(s=j(s,e.forg)),e.spec&&(s=WH.Tooltips.parseItemEffectTooltipForSpec(s,e.spec)),e.pcs&&e.pcs.length){for(var W=0,I=0,y=e.pcs.length;I<y;++I){var _,b=new RegExp("<span>\x3c!--si([0-9]+:)*"+e.pcs[I]+'(:[0-9]+)*--\x3e<a href="[^"]*?/item=(\\d+)[^"]*">(.+?)</a></span>');if(_=s.match(b)){let t=isNaN(parseInt($.show.locale))?"enus":f[$.show.locale];var w=WH.isSet("g_items")&&g_items[e.pcs[I]]?g_items[e.pcs[I]]["name_"+t]:_[4];var A='<a href="'+(WH.REMOTE?"javascript:":WH.Entity.getUrl(WH.Types.ITEM,_[3]))+'">'+w+"</a>",L='<span class="q13">\x3c!--si'+e.pcs[I]+"--\x3e"+A+"</span>";s=s.replace(_[0],L),++W}}W>0&&(s=(s=s.replace("(0/","("+W+"/")).replace(new RegExp("<span>\\(([0-"+W+"])\\)","g"),'<span class="q2">($1)'))}e.lvl&&!e.ilvl&&(s=WH.setTooltipLevel(s,e.lvl?e.lvl:WH.getWowMaxLevel(),e.buff));let t=[];if(e.know&&(t=t.concat(e.know)),e.spellModifier&&(t=t.concat(e.spellModifier)),e.covenant&&t.push(o[e.covenant]),s=WH.setTooltipSpells(s,t,u),e.who&&e.when&&(s=(s=s.replace("<table><tr><td><br />",'<table><tr><td><br /><span class="q2">'+WH.sprintf(de(i,"achievementComplete"),e.who,e.when.getMonth()+1,e.when.getDate(),e.when.getFullYear())+"</span><br /><br />")).replace(/class="q0"/g,'class="r3"')),e.notip&&g&&(s="",d=void 0),$.show.type===n.BATTLE_PET_ABILITY&&e.pwr&&(s=s.replace(/<!--sca-->(\d+)<!--sca-->/g,(function(t,a){return Math.floor(parseInt(a)*(1+.05*e.pwr))}))),$.show.type===n.ACHIEVEMENT&&e.cri)for(I=0;I<e.cri.length;I++)s=s.replace(new RegExp("\x3c!--cr"+parseInt(e.cri[I])+":[^<]+","g"),'<span class="q2">$&</span>')}}else s=de(i,"notFound").replace("%s",oe($.show.type)),t=x,d=a.UNKNOWN;if($.showCharacterCompletion&&window.g_user&&(WH.isRetailTree($.show.dataEnv)&&g_user.lists||!WH.isRetailTree($.show.dataEnv)&&g_user.characterProfiles&&g_user.characterProfiles.length)){var C="";let a=!!WH.isRetailTree($.show.dataEnv)&&WH.User.Completion.getByType($.show.type),i=e.getEntity($.show.type,$.show.fullId,$.show.dataEnv,$.show.locale);a&&$.show.type===n.QUEST&&(t!==k||i.worldquesttype||i.daily||i.weekly)&&(a=!1);let o=!(a&&$.show.type in g_completion_categories&&-1===WH.inArray(g_completion_categories[$.show.type],i.completion_category)),r=/^-?\d+(?:\.\d+)?/.exec($.show.fullId);if(r=r&&r.length?r[0]:$.show.fullId,a)for(var R in g_user.lists){var M=g_user.lists[R];if(!(M.id in a))continue;let e=-1!==WH.inArray(a[M.id],r);(e||o)&&(C+='<br><span class="progress-icon '+(e?"progress-8":"progress-0")+'"></span> ',C+=M.character+" - "+M.realm+" "+M.region)}if($.show.type===n.ACHIEVEMENT&&(s=We(s,$.show)),!WH.isRetailTree($.show.dataEnv)&&$.show.type===n.QUEST){var N;for(I=0;N=g_user.characterProfiles[I];I++){let e=-1!==WH.inArray(N.quests,r);(e||o)&&(C+='<br><span class="progress-icon '+(e?"progress-8":"progress-0"),C+='"></span> '+N.name+" - "+N.realm)}}WH.isRetailTree($.show.dataEnv)&&$.show.type===n.TRANSMOG_SET&&(g_user.lists||[]).forEach((function(e){let t=WH.Wow.TransmogSet.getCompletionAmount(i.data.completionData||{},e.id);t>0&&(C+='<br><span class="progress-icon progress-'+Math.max(1,Math.floor(8*t))+'"></span> ',C+=e.character+" - "+e.realm+" "+e.region)})),""!==C&&(s+='<br><span class="q">'+WH.TERMS.completion+":</span>"+C)}if(!WH.REMOTE&&[n.TRANSMOG_SET,n.ITEM_SET].includes($.show.type)&&void 0!==WH.getPreferredTransmogRace){let e=WH.getPreferredTransmogRace(),t=e.race,a=e.gender-1,i=WH.ce("div",{innerHTML:s}),o=WH.qs("picture",i);if(o){o.dataset.requiredRace&&!$.element.dataset.tooltipIgnoreRequiredRace&&(t=o.dataset.requiredRace);let e=$.show.type===n.ITEM_SET?WH.Wow.ItemSet:WH.Wow.TransmogSet;o.parentNode.replaceChild(WH.ce("img",{src:e.getThumbUrl($.show.fullId,t,a,$.show.dataEnv),width:260,height:440,style:{display:"block",margin:"0 auto"}}),o),s=i.innerHTML}}!WH.REMOTE&&s&&($.show.params.diff||$.show.params.diffnew||$.show.params.noimage)&&(g="",m=""),s=s.replace("http://","https://"),$.show.params.map&&p&&p.getMap&&(h=p.getMap());let O={type:$.show.type,fullId:$.show.fullId,dataEnv:$.show.dataEnv,locale:$.show.locale,params:$.show.params};Re(s,u,function(e,t,a){if($.show.type===t.type&&$.show.fullId===t.fullId&&$.show.dataEnv===t.dataEnv&&$.show.locale===t.locale&&$.show.params===t.params){switch($.show.mode){case S:ze($.element,a,{dataEnv:t.dataEnv,entity:c,iconName:d,image:g,imageClass:m,showIcon:!0,status:e,finalContent2:h,type:t.type});break;case v:Ge($.element,a,void 0,{dataEnv:t.dataEnv,entity:c,image:g,imageClass:m,showIcon:!1,status:e,finalContent2:h,type:t.type});break;case E:Ge($.element,a,void 0,{dataEnv:t.dataEnv,entity:c,iconName:d,image:g,imageClass:m,showIcon:!0,status:e,finalContent2:h,type:t.type});break;case T:Ge($.element,a,void 0,{dataEnv:t.dataEnv,entity:c,iconName:d,showIcon:!0,finalContent2:h,type:t.type});break;case H:$e(a,$.cursorX,$.cursorY,{dataEnv:t.dataEnv,entity:c,fixedPosition:WH.isElementPositionFixedOrSticky($.element),image:g,imageClass:m,padX:r,padY:l,showIcon:!1,status:e,finalContent2:h,type:t.type});break;default:$e(a,$.cursorX,$.cursorY,{dataEnv:t.dataEnv,entity:c,fixedPosition:WH.isElementPositionFixedOrSticky($.element),iconName:d,image:g,imageClass:m,padX:r,padY:l,showIcon:!0,status:e,finalContent2:h,type:t.type})}WH.REMOTE&&$.elements.logo&&($.elements.logo.style.display=$.show.hasLogo?"block":"none")}}.bind(this,t,O),O)}function Ke(){let t=e.getEntity($.show.type,$.show.fullId,$.show.dataEnv,$.show.locale);if(U.includes($.show.type)&&!t.data[fe()])return void we();let a=t.data[function(e){return void 0===e?"image_NONE":"image"+e}($.show.params.image)],n=t.data["image"+$.show.params.image+"_class"],i=ce($.show.type,$.show.fullId,$.show.dataEnv);i&&(a=i[0],n=i[1]),Ye(t.status,$.show.locale,t.data[fe()],t.data,t.data[$.show.params&&$.show.params.text?"text_icon":"icon"],t.data.map,t.data[ge()],t.data[fe(2)],a,n)}function Ve(e,t){let a=WH.ce("div",{className:t});return"string"==typeof e?a.innerHTML=e:WH.ae(a,e),a}function Qe(e){$.cursorX=e.pageX,$.cursorY=e.pageY}this.attachTouchTooltips=function(e){q&&e&&1===e.nodeType&&Q(e)},this.clearTouchTooltip=function(e){$.touchElement&&(!0!==e&&$.touchElement.removeAttribute("data-showing-touch-tooltip"),$.touchElement.hasWHTouchTooltip=!1),$.touchElement=void 0,!0!==e&&WH.qsa("[data-showing-touch-tooltip]").forEach((function(e){delete e.dataset.showingTouchTooltip})),$.elements.screen&&($.elements.screenInnerWrapper.scrollTop=0,$.elements.screenInnerWrapper.scrollLeft=0,$.elements.screen.style.display="none",$.usingScreen=!1);let t=!0===e&&$.showingTooltip;me(),$.showingTooltip=t},this.evalFormulas=function(e,t=0){if("string"!=typeof e)return e;e=e.replace(/<span class="wh-tooltip-formula" style="display:none">(\[[\w\W]*?\])<\/span>(?:\d+(?:\.\d+)?)?/g,"$1");let a=0,n=0,i="",s=0;for(let o=0;o<e.length;o++){let r=e.substr(o,1);switch(r){case"[":a++,n=0,i="";break;case"]":a--,a<0&&(a=0),n=0,i="";break;case"(":if(a>0)break;i+=r,n++;break;case")":if(a>0)break;n>0&&(i+=r,n--);break;default:0==a&&n>0&&(i+=r)}if(0==a&&0==n&&i){if(s=o-i.length+1,/[^ ()0-9\+\*\/\.\-\%]/.test(i.replace(/<!--[\w\W]*?-->/g,"").replace(/\b(floor|ceil|abs)\b/gi,""))){i="";continue}if(/^\([0-9\.]*\)$/.test(i)){i="";continue}if(!/<!--[\w\W]*?-->/g.test(i)){i="";continue}e=e.substr(0,s)+(0===t?"[":"(")+e.substring(s,o+1)+(0===t?"]":")")+e.substr(o+1),o+=2,i=""}}return e=e.replace(/\[([^\]]+)\]/g,(function(e,t){let a;t=(t=(t=(t=t.replace(/<!--[\w\W]*?-->/g,"")).replace(/\b(floor|ceil|abs)\b/gi,"Math.$1")).replace(/&lt;/g,"<")).replace(/&gt;/g,">");try{a=Function('"use strict";return ('+t+")")()}catch(e){a=void 0}return void 0===a?e:'<span class="wh-tooltip-formula" style="display:none">'+e+"</span>"+Math.abs(a).toFixed(3).replace(/0+$/,"").replace(/\.$/,"")})),e},this.getEntity=function(e,t,a,n){void 0===n&&(n=Locale.getId()),a||(a=WH.getDataEnv());var i=function(e){if("object"!=typeof d[e])throw new Error("Wowhead tooltips could not find config for entity type ["+e+"].");return d[e].data}(e);return i[t]=i[t]||{},i[t][a]=i[t][a]||{},i[t][a][n]=i[t][a][n]||{status:O,callbacks:[],data:{}},i[t][a][n]},this.init=function(){K(),_e((function(){if(pe("renameLinks")||pe("colorLinks")||pe("iconizeLinks")||pe("iconSize")){let e=ie();for(let t=0;t<e.length;t++)Pe(e[t]);Ee()}else if(document.querySelectorAll){let e=['a[href*="wowhead.com/talent-calc/embed/"]','a[href*="wowhead.com/soulbind-calc/embed/"]','a[href*="wowhead.com/diablo-2/skill-calc/embed/"]'].join(","),t=document.querySelectorAll(e);for(let e=0;e<t.length;e++)Pe(t[e])}}))},this.onScalesAvailable=function(e,t,a){Je.registerCallback(e,t,a)},this.parseItemEffectTooltipForSpec=(e,t)=>e.replace(/<!--itemeffectspec(\d+):0--><span(?: hidden.*?)?>(.*?)<\/span><!--itemeffectspec-->(<br>|<br \/>|<\/span>)?/g,(function(e,a,n,i){let s=`\x3c!--itemeffectspec${a=parseInt(a)}:0--\x3e<span`;return a===t?"</span>"!==i&&(i="<br>"):(s+=" hidden","</span>"!==i&&(i="")),s+=`>${n}</span>\x3c!--itemeffectspec--\x3e${i}`,s})),this.refreshLinks=function(e){if(!0===e||pe("renameLinks")||pe("colorLinks")||pe("iconizeLinks")){let e=ie();for(let n,i=0;n=e[i];i++){for(var t=n.parentNode,a=!1;null!=t;){if((" "+(t.getAttribute&&t.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").indexOf(" wowhead-tooltip ")>-1){a=!0;break}t=t.parentNode}a||(Pe(n),q&&V(n))}}me()},this.register=function(t,a,i,s,o){let r=this.getEntity(t,a,i,s);{let a=o.additionalIds||[];delete o.additionalIds,a.forEach((a=>e.register(t,a,i,s,o)))}if(!Je.isLoaded(t,i))return r.status=B,void Je.registerCallback(t,i,e.register.bind(this,t,a,i,s,o));if("string"==typeof a&&(0===a.indexOf("lvl")||a.match(/[^i]lvl/))&&!Je.isLoaded(n.SPELL,i))return r.status=B,void Je.registerCallback(n.SPELL,i,e.register.bind(this,t,a,i,s,o));for(var l in r.timer&&(clearTimeout(r.timer),delete r.timer),!WH.REMOTE&&o.map&&(r.data.map||(r.data.map=new Mapper({parent:WH.ce("div"),zoom:3,zoomable:!1,buttons:!1})),r.data.map.update(o.map),delete o.map),o)o.hasOwnProperty(l)&&(r.data[l]=o[l]);switch(r.status){case D:case B:case P:case O:r.data[fe()]?r.status=k:r.status=x}for($.showingTooltip&&$.show.type===t&&$.show.fullId===a&&$.show.dataEnv===i&&$.show.locale===s&&Ke();r.callbacks.length;)r.callbacks.shift()()},this.replaceWithTooltip=function(a,n,i,s,o,r,l){if(r=r||{},void 0===o&&(o=Locale.getId()),s||(s=WH.getDataEnv()),"string"==typeof a&&(a=document.getElementById(a)),!a)return!1;var c=le(n,i,r),p=this.getEntity(n,c,s,o);switch(p.status){case k:if(!a.parentNode)return!0;for(;a.hasChildNodes();)a.removeChild(a.firstChild);var u=["wowhead-tooltip-inline"];!d[n].embeddedIcons&&ee(p.data)&&u.push("wowhead-tooltip-inline-icon"),z(a,u);let h=t.getByEnv(s);h!==t.get()&&WH.Fonts.load(h);let g=function(i){"function"==typeof l&&(i=l(i,p)),h===t.WOW&&(r.forg&&(i=j(i,r.forg)),i=e.evalFormulas(i)),i&&function(e,t,a,n,i){let s=X(a),o=s.tooltip;Y(o,n,i),Fe(s.icon,t,i,n),WH.ae(e,o),ae(o)}(a,p.data,i,s,n)};return Re(p.data[fe()],p.data[ge()],g,{type:n,fullId:c,dataEnv:s,locale:o,params:r}),!0;case D:case O:return p.callbacks.push(this.replaceWithTooltip.bind(this,a,n,i,s,o,r,l)),this.request(n,i,s,o,r),!0}return!1},this.request=function(e,t,a,n,i){i=i||{},void 0===n&&(n=Locale.getId()),a||(a=WH.getDataEnv());var s=le(e,t,i);this.getEntity(e,s,a,n),De(e,t,a,n,!0,i)},this.setScales=function(e,t,a){Je.setData(e,t,a)},this.triggerTooltip=function(e,t){Pe(e,t||{target:e},!0)},WH.REMOTE||(this.addText=function(e,t,a){e?e._fixTooltip=function(e,t,a,n){let i=/<\/table>\s*$/,s="function"==typeof a?a():a,o=a?' class="'+s+'"':"",r="function"==typeof t?t():t;return i.test(n)?n.replace(i,'<tr><td colspan="2"><div'+o+' style="margin-top: 10px">'+r+"</div></td></tr></table>"):n+"<div"+o+' style="margin-top: 10px">'+r+"</div>"}.bind(null,e,t,a):WH.error("Tooltip text addition element not found!",e,t,a)},this.attach=function(t,a,n,i){if(i=i||{},t instanceof jQuery){for(let s,o=0;s=t[o];o++)e.attach(s,a,n,i);return}let s={dataEnv:i.dataEnv,type:i.type,iconName:i.iconName},o=i.stopPropagation?e=>e.stopPropagation():()=>{};i.byCursor?(t.onmouseover=e=>{qe(e,Oe(a,i.noWrap,i.maxWidth,e),n,s),o(e)},t.onmousemove=e.cursorUpdate):t.onmouseover=e=>{let r=Oe(a,i.noWrap,i.maxWidth,e);Ge(t,r,n,s),o(e)},t.onmouseout=me},this.attachNonTouch=function(t,a,n,i){WH.Device.isTouch()||e.attach(t,a,n,i)},this.cursorUpdate=function(e,t,a){$.enabled&&$.elements.tooltip&&((!t||t<10)&&(t=10),(!a||a<10)&&(a=10),Se(e.pageX,e.pageY,0,0,t,a))},this.disableCompletion=function(){$.showCharacterCompletion=!1},this.getScalingData=(e,t)=>Je.getDataByKey(e,t),this.getScreenshotsEnabled=()=>$.showScreenshots,this.getTd=()=>$.elements.tooltipTd,this.isTypeSupported=e=>d.hasOwnProperty(e),this.isVisible=function(){return $.showingTooltip||$.elements.tooltip&&WH.DOM.isVisible($.elements.tooltip)},this.on=(e,t)=>{$.elements.tooltip||Me(),WH.aE($.elements.tooltip,e,t)},this.relToParams=e=>{let t={};return e.forEach((e=>e.replace(y,((e,a,n)=>Ce(t,a,n)||"")))),t},this.setEnabled=e=>$.enabled=e,this.setScreenshotsEnabled=e=>$.showScreenshots=e,this.showFadingTooltipAtCursor=function(e,t,a,n,i){qe(t,e=Oe(e,n,i,t),a),requestAnimationFrame((function(){$.elements.tooltip.classList.add("fade-out")}))},this.titlesToTooltips=function(t,a){"string"==typeof t&&(t=WH.qsa(t)),t.forEach((t=>{e.attach(t,t.title,"q",{noWrap:!0}),t.removeAttribute("title"),a||t.classList.add("tip")}))},this.finalizeSizeAndReveal=ae,this.hide=me,this.prepare=Me,this.prepareContent=Oe,this.setIcon=ke,this.show=Ge,this.showAtCursor=qe,this.showAtPoint=$e,this.showInScreen=ze),window.Locale=window.Locale||{getId:function(){return 0},getName:function(){return"enus"}};let Je=new function(){const e=this;let t={loadedData:{}};var a={},i={},s={},o={};function r(){let e=$.show.dataEnv||WH.getDataEnv(),a=s[n.ITEM][e];a&&(t.loadedData[n.ITEM]=a,WH.staminaFactor=a.staminaByIlvl,WH.convertRatingToPercent.RM=a.ratingsToPercentRM,WH.convertRatingToPercent.LT=a.ratingsToPercentLT,WH.convertScalingFactor.SV=a.itemScalingValue,WH.convertScalingFactor.SD=a.scalingFactors,WH.curvePoints=a.curvePoints,WH.applyStatModifications.ScalingData=a.scalingData,WH.contentTuningLevels=a.contentTuningLevels,WH.reforgeStats=a.reforgeStats??{},Object.values(WH.reforgeStats).forEach((e=>{e.s1=WH.statToJson[e.i1],e.s2=WH.statToJson[e.i2]})));let i=s[n.SPELL][e];i&&(t.loadedData[n.SPELL]=i,WH.convertScalingSpell.SV=i.scalingValue,WH.convertScalingSpell.SpellInformation=i.spellInformation,WH.convertScalingSpell.RandPropPoints=i.randPropPoints)}this.fetch=function(e,t){if(!o.hasOwnProperty(e)||o[e].hasOwnProperty(t))return;let n;o[e][t]=D,a[e][t]=[],n=WH.REMOTE?function(e){if(e=e||"www",!WH.isDev())return"https://"+e+".wowhead.com";var t=document.location.hostname.split(".");t=t[t.length-3];var a="https://"+(e="www"===e?t:e+"."+t)+".wowhead.com";return""!==document.location.port&&(a+=(document.location.port.indexOf(":")<0?":":"")+document.location.port),"https:"!==document.location.protocol&&(a=a.replace(/^https:/,"http:")),a}("nether")+i[e]+`&dataEnv=${t}`:WH.Url.getDataPageUrl(i[e].replace("/data/",""),t),n+="&json",WH.xhrJsonRequest(n,function(e,t,a){a?Je.setData(e,t,a):WH.error("Wowhead tooltips failed to load entity scaling data.",oe(e))}.bind(null,e,t))},this.getDataByKey=(e,a)=>(t.loadedData[e]||{})[a],this.getSpellsBySpec=function(e,t){let a=$.show.dataEnv||WH.getDataEnv();this.registerCallback(n.PLAYER_CLASS,a,(function(){var i=s[n.PLAYER_CLASS][a],o=[];i.specMap.hasOwnProperty(e)&&(o=i.class[i.specMap[e]].concat(i.spec[e]||[])),t(o)}))},this.isLoaded=function(e,t){return!o.hasOwnProperty(e)||o[e][t]===k&&(r(),!0)},this.registerCallback=function(t,n,i){e.isLoaded(t,n)?window.requestAnimationFrame(i):(a[t].hasOwnProperty(n)||e.fetch(t,n),a[t][n].push(i))},this.setData=function(e,t,n){o[e][t]=k,a[e][t]=a[e][t]||[],s[e][t]=n,r();let i=a[e][t];for(;i.length;)i.shift()()},function(){for(var e in i[n.ITEM]="/data/item-scaling",i[n.SPELL]="/data/spell-scaling",i[n.PLAYER_CLASS]="/data/spec-spells",i)i.hasOwnProperty(e)&&(o[e]={},a[e]={},s[e]={})}()};WH.REMOTE?(WH.ae(document.head,WH.ce("link",{type:"text/css",href:"../universal.css",rel:"stylesheet"})),e.init()):(K(),_e((function(){Je.fetch(n.ITEM,WH.getDataEnv()),Je.fetch(n.SPELL,WH.getDataEnv())})))},window.$WowheadPower=new function(){WH.REMOTE||(this.attachTouchTooltips=WH.Tooltips.attachTouchTooltips,this.disableCompletion=WH.Tooltips.disableCompletion,this.onScalesAvailable=WH.Tooltips.onScalesAvailable,this.replaceWithTooltip=WH.Tooltips.replaceWithTooltip,this.request=WH.Tooltips.request,this.triggerTooltip=WH.Tooltips.triggerTooltip,this.getEntity=WH.Tooltips.getEntity,this.register=WH.Tooltips.register),this.refreshLinks=WH.Tooltips.refreshLinks,this.setScales=WH.Tooltips.setScales},WH.Tooltip=new function(){WH.REMOTE||(this.addTooltipText=WH.Tooltips.addText,this.cursorUpdate=WH.Tooltips.cursorUpdate,this.isVisible=WH.Tooltips.isVisible,this.showFadingTooltipAtCursor=WH.Tooltips.showFadingTooltipAtCursor,this.simple=WH.Tooltips.attach,this.simpleNonTouch=WH.Tooltips.attachNonTouch,this.finalizeSizeAndReveal=WH.Tooltips.finalizeSizeAndReveal,this.hide=WH.Tooltips.hide,this.prepare=WH.Tooltips.prepare,this.setIcon=WH.Tooltips.setIcon,this.show=WH.Tooltips.show,this.showAtCursor=WH.Tooltips.showAtCursor,this.showAtPoint=WH.Tooltips.showAtPoint,this.showInScreen=WH.Tooltips.showInScreen)},WH.WebP=new function(){const e=this;var t=10,a={lossy:"UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",lossless:"UklGRhoAAABXRUJQVlA4TA0AAAAvAAAAEAcQERGIiP4HAA==",alpha:"UklGRkoAAABXRUJQVlA4WAoAAAAQAAAAAAAAAAAAQUxQSAwAAAARBxAR/Q9ERP8DAABWUDggGAAAABQBAJ0BKgEAAQAAAP4AAA3AAP7mtQAAAA==",animation:"UklGRlIAAABXRUJQVlA4WAoAAAASAAAAAAAAAAAAQU5JTQYAAAD/////AABBTk1GJgAAAAAAAAAAAAAAAAAAAGQAAABWUDhMDQAAAC8AAAAQBxAREYiI/gcA"};this.feature=Object.freeze({lossy:"lossy",lossless:"lossless",alpha:"alpha",animation:"animation"});const n={bodyFrameWaitCount:0,supports:{lossy:void 0,lossless:void 0,alpha:void 0,animation:void 0}};function i(e){if(!document.body)return n.bodyFrameWaitCount>t?void window.addEventListener("DOMContentLoaded",i.bind(this,e)):(n.bodyFrameWaitCount++,void requestAnimationFrame(i.bind(this,e)));document.body.classList.add(e?"webp":"no-webp"),document.body.dataset.whWebp=JSON.stringify(e)}this.getImageExtension=function(){return n.supports.alpha?".webp":".png"},this.supportsFeature=function(e,t){if("boolean"!=typeof n.supports[e]){var i=new Image;i.onload=function(){var a=i.width>0&&i.height>0;n.supports[e]=a,t(e,a)},i.onerror=function(){n.supports[e]=!1,t(e,!1)},i.src="data:image/webp;base64,"+a[e]}else requestAnimationFrame((function(){t(e,n.supports[e])}))},e.supportsFeature(e.feature.alpha,(function(e,t){i(t)}))},WH.DI.GeneralItem=new function(){this.GRID_TYPE_1x1=1,this.GRID_TYPE_2x1=2},WH.DI.UiImage=function(e){const t=this,a=WH.WebP,n="/di/ui/",i={baseName:""};this.getBaseName=function(){return i.baseName},this.getSubDirectory=function(){let e="",t=i.baseName.split("_");for(;t.length>1;){let a=t.shift();if(/\d/.test(a))break;e+=a+"/"}return e},this.getUrl=e=>{let i=[n,t.getSubDirectory(),t.getBaseName(),a.getImageExtension()].join("");return e?WH.Url.generatePrivate(i):`${WH.STATIC_URL}${i}`},function(e){i.baseName=e}.apply(this,arguments)};
